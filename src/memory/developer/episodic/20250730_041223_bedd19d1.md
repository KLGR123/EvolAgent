### Development Step 4: Systematic Wikipedia Search for ASEAN Capitals and Coordinates for Distance Calculations

**Description**: Search for comprehensive information about ASEAN member countries and their capital cities on Wikipedia. Focus on identifying all 10 ASEAN member nations, their respective capital cities, and gather geographical coordinate data (latitude and longitude) for each capital. Use systematic search approaches: (1) Look up the main ASEAN Wikipedia page to get the complete list of member countries, (2) Access individual country pages to confirm capital cities and their coordinates, (3) Cross-reference with dedicated Wikipedia pages about ASEAN capitals if available. Extract precise geographical data needed for distance calculations between all possible capital city pairs.

**Use Cases**:
- Route optimization for a Southeast Asian tour operator planning multi-city cultural itineraries between ASEAN capitals
- Logistics scheduling and freight cost estimation for a shipping company calculating distances between major ASEAN hubs
- Geospatial mapping and network planning for a telecom provider deploying cross-border microwave links among capitals
- Environmental impact assessment for climate researchers analyzing regional air quality gradients across ASEAN capital cities
- Cross-border emergency response coordination for disaster management agencies mapping quickest relief routes between capitals
- Urban development studies for academic geographers comparing spatial growth patterns by inter-capital distance metrics
- Mobile app location services tuning dynamic pricing algorithms for ride-hail drivers traveling between key ASEAN capitals
- Investment due diligence for real estate firms evaluating infrastructure connectivity scores based on capital city proximities

```
import os
import json
from bs4 import BeautifulSoup
import time

print("=== ASEAN MEMBER COUNTRIES RESEARCH - STEP 3 ===\n")
print("Objective: Clean country data and extract precise coordinates for all 10 ASEAN capitals")
print("Focus: Remove duplicates and ensure complete list with coordinates\n")

# First, let's inspect the workspace files to understand what we have
workspace_files = os.listdir('workspace')
print(f"Available workspace files: {workspace_files}\n")

# Look for the countries data file
countries_file = None
for file in workspace_files:
    if 'asean_countries_with_known_capitals.json' in file:
        countries_file = f'workspace/{file}'
        break

if not countries_file:
    print("❌ Countries data file not found")
    exit()

print(f"Loading countries data from: {countries_file}")

# Inspect the JSON structure first
with open(countries_file, 'r') as f:
    countries_data = json.load(f)

print("\n=== INSPECTING COUNTRIES DATA STRUCTURE ===\n")
print("Top-level keys in countries data:")
for key, value in countries_data.items():
    if isinstance(value, list):
        print(f"  {key}: List with {len(value)} items")
    elif isinstance(value, dict):
        print(f"  {key}: Dictionary with {len(value)} keys")
    else:
        print(f"  {key}: {value}")

# Examine the countries_found structure
if 'countries_found' in countries_data:
    countries_found = countries_data['countries_found']
    print(f"\nSample country entry structure:")
    if countries_found:
        sample = countries_found[0]
        for key, value in sample.items():
            print(f"  {key}: {value}")
    
    print(f"\nAll country entries:")
    for i, country in enumerate(countries_found):
        print(f"  {i+1}. {country.get('country', 'Unknown')}: {country.get('capital', 'Unknown')}")

# Create clean list of all 10 ASEAN countries with capitals
print("\n=== CREATING COMPLETE ASEAN COUNTRIES LIST ===\n")

# Define the complete list of ASEAN countries with their capitals
complete_asean_data = {
    'Brunei': {
        'official_name': 'Brunei Darussalam',
        'capital': 'Bandar Seri Begawan',
        'wikipedia_url': 'https://en.wikipedia.org/wiki/Brunei',
        'capital_wikipedia_url': 'https://en.wikipedia.org/wiki/Bandar_Seri_Begawan'
    },
    'Cambodia': {
        'official_name': 'Kingdom of Cambodia', 
        'capital': 'Phnom Penh',
        'wikipedia_url': 'https://en.wikipedia.org/wiki/Cambodia',
        'capital_wikipedia_url': 'https://en.wikipedia.org/wiki/Phnom_Penh'
    },
    'Indonesia': {
        'official_name': 'Republic of Indonesia',
        'capital': 'Jakarta', 
        'wikipedia_url': 'https://en.wikipedia.org/wiki/Indonesia',
        'capital_wikipedia_url': 'https://en.wikipedia.org/wiki/Jakarta'
    },
    'Laos': {
        'official_name': 'Lao People\'s Democratic Republic',
        'capital': 'Vientiane',
        'wikipedia_url': 'https://en.wikipedia.org/wiki/Laos', 
        'capital_wikipedia_url': 'https://en.wikipedia.org/wiki/Vientiane'
    },
    'Malaysia': {
        'official_name': 'Malaysia',
        'capital': 'Kuala Lumpur',
        'wikipedia_url': 'https://en.wikipedia.org/wiki/Malaysia',
        'capital_wikipedia_url': 'https://en.wikipedia.org/wiki/Kuala_Lumpur'
    },
    'Myanmar': {
        'official_name': 'Republic of the Union of Myanmar',
        'capital': 'Naypyidaw', 
        'wikipedia_url': 'https://en.wikipedia.org/wiki/Myanmar',
        'capital_wikipedia_url': 'https://en.wikipedia.org/wiki/Naypyidaw'
    },
    'Philippines': {
        'official_name': 'Republic of the Philippines',
        'capital': 'Manila',
        'wikipedia_url': 'https://en.wikipedia.org/wiki/Philippines',
        'capital_wikipedia_url': 'https://en.wikipedia.org/wiki/Manila'
    },
    'Singapore': {
        'official_name': 'Republic of Singapore',
        'capital': 'Singapore',
        'wikipedia_url': 'https://en.wikipedia.org/wiki/Singapore',
        'capital_wikipedia_url': 'https://en.wikipedia.org/wiki/Singapore'
    },
    'Thailand': {
        'official_name': 'Kingdom of Thailand',
        'capital': 'Bangkok',
        'wikipedia_url': 'https://en.wikipedia.org/wiki/Thailand',
        'capital_wikipedia_url': 'https://en.wikipedia.org/wiki/Bangkok'
    },
    'Vietnam': {
        'official_name': 'Socialist Republic of Vietnam',
        'capital': 'Hanoi',
        'wikipedia_url': 'https://en.wikipedia.org/wiki/Vietnam',
        'capital_wikipedia_url': 'https://en.wikipedia.org/wiki/Hanoi'
    }
}

print("Complete ASEAN countries and capitals:")
for country, info in complete_asean_data.items():
    print(f"  {country}: {info['capital']}")

# Now let's fetch coordinates for each capital city from their Wikipedia pages
print("\n=== EXTRACTING COORDINATES FROM CAPITAL WIKIPEDIA PAGES ===\n")

import requests
from bs4 import BeautifulSoup
import re

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
}

coordinates_data = []

for country, info in complete_asean_data.items():
    capital = info['capital']
    capital_url = info['capital_wikipedia_url']
    
    print(f"Fetching coordinates for {capital} ({country})...")
    
    try:
        response = requests.get(capital_url, headers=headers, timeout=30)
        response.raise_for_status()
        
        soup = BeautifulSoup(response.content, 'html.parser')
        
        # Look for coordinates in the infobox
        coordinates_found = None
        
        # Method 1: Look for coordinate span with specific class
        coord_span = soup.find('span', class_='geo')
        if coord_span:
            coordinates_found = coord_span.get_text().strip()
            print(f"  Found coordinates (method 1): {coordinates_found}")
        
        # Method 2: Look for coordinates in the URL or data attributes
        if not coordinates_found:
            coord_links = soup.find_all('a', href=re.compile(r'geohack'))
            for link in coord_links:
                href = link.get('href')
                # Extract coordinates from geohack URL
                coord_match = re.search(r'params=([0-9._-]+)_([NS])_([0-9._-]+)_([EW])', href)
                if coord_match:
                    lat = float(coord_match.group(1))
                    lat_dir = coord_match.group(2)
                    lon = float(coord_match.group(3))
                    lon_dir = coord_match.group(4)
                    
                    if lat_dir == 'S':
                        lat = -lat
                    if lon_dir == 'W':
                        lon = -lon
                    
                    coordinates_found = f"{lat}, {lon}"
                    print(f"  Found coordinates (method 2): {coordinates_found}")
                    break
        
        # Method 3: Look for decimal coordinates in text
        if not coordinates_found:
            text_content = soup.get_text()
            decimal_coord_pattern = r'([0-9]{1,2}\.[0-9]+)°?[NS],?\s*([0-9]{1,3}\.[0-9]+)°?[EW]'
            coord_match = re.search(decimal_coord_pattern, text_content)
            if coord_match:
                coordinates_found = f"{coord_match.group(1)}, {coord_match.group(2)}"
                print(f"  Found coordinates (method 3): {coordinates_found}")
        
        # Parse the coordinates into latitude and longitude
        if coordinates_found:
            # Handle different coordinate formats
            coord_parts = coordinates_found.replace(';', ',').split(',')
            if len(coord_parts) >= 2:
                try:
                    latitude = float(coord_parts[0].strip())
                    longitude = float(coord_parts[1].strip())
                    
                    coordinates_data.append({
                        'country': country,
                        'capital': capital,
                        'latitude': latitude,
                        'longitude': longitude,
                        'coordinates_raw': coordinates_found,
                        'wikipedia_url': capital_url,
                        'extraction_method': 'Wikipedia parsing'
                    })
                    
                    print(f"  ✓ Successfully extracted: Lat {latitude}, Lon {longitude}")
                    
                except ValueError as e:
                    print(f"  ✗ Error parsing coordinates: {e}")
                    coordinates_data.append({
                        'country': country,
                        'capital': capital,
                        'latitude': None,
                        'longitude': None,
                        'coordinates_raw': coordinates_found,
                        'wikipedia_url': capital_url,
                        'extraction_error': str(e)
                    })
            else:
                print(f"  ✗ Could not parse coordinate format: {coordinates_found}")
        else:
            print(f"  ✗ No coordinates found for {capital}")
            coordinates_data.append({
                'country': country,
                'capital': capital,
                'latitude': None,
                'longitude': None,
                'coordinates_raw': None,
                'wikipedia_url': capital_url,
                'extraction_error': 'No coordinates found'
            })
    
    except Exception as e:
        print(f"  ✗ Error fetching {capital}: {str(e)}")
        coordinates_data.append({
            'country': country,
            'capital': capital,
            'latitude': None,
            'longitude': None,
            'coordinates_raw': None,
            'wikipedia_url': capital_url,
            'extraction_error': str(e)
        })
    
    time.sleep(1)  # Be respectful to Wikipedia servers

# Save the complete coordinates data
final_data = {
    'research_objective': 'ASEAN member countries capitals with coordinates',
    'total_countries': len(complete_asean_data),
    'coordinates_extracted': len([c for c in coordinates_data if c.get('latitude') is not None]),
    'extraction_timestamp': time.strftime('%Y-%m-%d %H:%M:%S'),
    'countries_data': coordinates_data,
    'summary_table': [
        {
            'country': c['country'],
            'capital': c['capital'], 
            'latitude': c.get('latitude'),
            'longitude': c.get('longitude'),
            'has_coordinates': c.get('latitude') is not None
        } for c in coordinates_data
    ]
}

with open('workspace/asean_complete_coordinates.json', 'w') as f:
    json.dump(final_data, f, indent=2)

print(f"\n=== EXTRACTION RESULTS ===\n")
print(f"Total ASEAN countries: {final_data['total_countries']}")
print(f"Coordinates successfully extracted: {final_data['coordinates_extracted']}")
print(f"\nComplete results:")

for entry in coordinates_data:
    country = entry['country']
    capital = entry['capital']
    lat = entry.get('latitude')
    lon = entry.get('longitude')
    
    if lat is not None and lon is not None:
        print(f"  ✓ {country} - {capital}: {lat}°N, {lon}°E")
    else:
        error = entry.get('extraction_error', 'Unknown error')
        print(f"  ✗ {country} - {capital}: {error}")

print(f"\n✓ Complete ASEAN coordinates data saved to: workspace/asean_complete_coordinates.json")
print(f"\nData is now ready for distance calculations between all capital city pairs!")
```