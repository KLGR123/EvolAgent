### Development Step 10: Locate Harriet Martineau’s work on post-1840 European peace ending 1846 and its 1877–78 four-volume publisher

**Description**: Search for books authored by Harriet Martineau that analyze a period of European peace ending in 1846 and include the Convention of London 1840 which resolved the Egyptian-Ottoman crisis. Focus on identifying her historical work that covers this specific timeframe and diplomatic event, then determine which publisher issued a four-volume edition of this work in 1877-1878. Search using keywords including 'Harriet Martineau European peace 1846', 'Convention of London 1840 Egyptian-Ottoman crisis', 'Martineau four-volume edition 1877-1878', and 'Harriet Martineau historical works publisher'.

**Use Cases**:
- Academic historians automating the identification and retrieval of primary-source texts on 19th-century European peace treaties for doctoral dissertations
- University librarians enriching catalog records with detailed publication and publisher metadata for multi-volume Victorian works
- Publishing rights teams verifying edition dates and imprint information of public-domain literature to clear reprint permissions
- Digital humanities projects mining archival search results and Google Books metadata to build interactive timelines of European diplomatic events
- Curriculum designers compiling authoritative reading lists on the Egyptian-Ottoman crisis for online history courses using targeted web scraping
- Legal history researchers extracting treaty texts and publisher details of the Convention of London 1840 for comparative treaty analysis
- Genealogy societies sourcing period publications and multi-volume edition data to contextualize ancestors’ lives during the Thirty Years’ Peace
- Educational technology firms integrating automated historical work discovery into adaptive learning platforms for world history modules

```
import os
import requests
from bs4 import BeautifulSoup
import json
import time
from urllib.parse import quote_plus

print('=== SEARCHING FOR HARRIET MARTINEAU\'S HISTORICAL WORK ON EUROPEAN PEACE (1846) ===') 
print('Objective: Find Martineau\'s book analyzing European peace ending in 1846')
print('Key elements: Convention of London 1840, Egyptian-Ottoman crisis')
print('Target: Four-volume edition published 1877-1878')
print('\n' + '='*100 + '\n')

# Ensure workspace directory exists
os.makedirs('workspace', exist_ok=True)

# Define comprehensive search queries for Martineau's historical work
search_queries = [
    'Harriet Martineau European peace 1846 historical work',
    'Martineau Convention of London 1840 Egyptian Ottoman crisis',
    'Harriet Martineau four volume edition 1877 1878',
    'Martineau History of England during Thirty Years Peace',
    'Harriet Martineau 1816-1846 peace period analysis',
    'Martineau Egyptian crisis Convention London 1840',
    'Harriet Martineau historical works publisher 1877',
    'Martineau Thirty Years Peace four volumes',
    'Harriet Martineau 1846 European diplomatic history',
    'Martineau Ottoman Egyptian crisis historical analysis'
]

print('=== STEP 1: CONDUCTING TARGETED SEARCHES FOR MARTINEAU\'S HISTORICAL WORK ===')
print(f'Total search queries: {len(search_queries)}')
print('\nSearch queries:')
for i, query in enumerate(search_queries, 1):
    print(f'  {i:2d}. {query}')

search_results = {}

# Headers for web requests
headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
    'Accept-Language': 'en-US,en;q=0.5',
    'Accept-Encoding': 'gzip, deflate, br',
    'Connection': 'keep-alive',
    'Upgrade-Insecure-Requests': '1',
    'Cache-Control': 'no-cache',
    'Pragma': 'no-cache'
}

# Function to perform search and analyze results
def perform_search(query, search_index):
    search_base_url = 'https://html.duckduckgo.com/html/'
    
    print(f'\n--- SEARCH {search_index}: {query} ---')
    try:
        params = {'q': query}
        response = requests.get(search_base_url, params=params, headers=headers, timeout=30)
        print(f'Status: {response.status_code}')
        
        if response.status_code == 200:
            # Save raw HTML for analysis
            filename = f'martineau_search_{search_index:02d}_{query.replace(" ", "_").replace("\'", "").replace('"', "")[:40]}.html'
            filepath = os.path.join('workspace', filename)
            
            with open(filepath, 'w', encoding='utf-8') as f:
                f.write(response.text)
            
            print(f'Saved: {filepath}')
            
            # Parse for relevant results
            soup = BeautifulSoup(response.text, 'html.parser')
            
            # Look for result links with historical work information
            result_links = []
            for link in soup.find_all('a', href=True):
                href = link.get('href')
                text = link.get_text().strip()
                
                # Filter for highly relevant results
                if href and text and len(text) > 15:
                    text_lower = text.lower()
                    relevance_score = 0
                    
                    # High-value terms for Martineau's historical work identification
                    high_value_terms = [
                        ('martineau', 3),
                        ('harriet', 2),
                        ('1846', 3),
                        ('1840', 2),
                        ('convention', 2),
                        ('london', 1),
                        ('egyptian', 2),
                        ('ottoman', 2),
                        ('crisis', 2),
                        ('peace', 2),
                        ('thirty years', 3),
                        ('four volume', 3),
                        ('1877', 2),
                        ('1878', 2),
                        ('history', 2),
                        ('england', 2),
                        ('european', 2),
                        ('diplomatic', 2)
                    ]
                    
                    # Publisher-specific terms
                    publisher_terms = [
                        ('george bell', 3),
                        ('bell and sons', 3),
                        ('macmillan', 2),
                        ('longman', 2),
                        ('chapman', 2),
                        ('hall', 2),
                        ('smith elder', 2),
                        ('john murray', 2),
                        ('blackwood', 2),
                        ('routledge', 2)
                    ]
                    
                    # Calculate relevance score
                    for term, score in high_value_terms + publisher_terms:
                        if term in text_lower:
                            relevance_score += score
                    
                    # Additional scoring for URL domains
                    if href:
                        href_lower = href.lower()
                        if any(domain in href_lower for domain in ['archive.org', 'gutenberg.org', 'hathitrust.org']):
                            relevance_score += 3
                        elif any(domain in href_lower for domain in ['wikipedia.org', 'britannica.com', 'jstor.org']):
                            relevance_score += 2
                    
                    if relevance_score >= 3:  # Only include highly relevant results
                        result_links.append({
                            'url': href,
                            'text': text[:400],  # Longer text for better analysis
                            'relevance_score': relevance_score
                        })
            
            # Sort by relevance score
            result_links.sort(key=lambda x: x['relevance_score'], reverse=True)
            
            search_results[query] = {
                'html_file': filepath,
                'status_code': response.status_code,
                'relevant_links': result_links[:15],  # Top 15 most relevant
                'total_links_found': len(result_links)
            }
            
            print(f'Found {len(result_links)} highly relevant links')
            if result_links:
                print('Top results:')
                for i, link in enumerate(result_links[:5], 1):
                    print(f'  {i}. Score {link["relevance_score"]}: {link["text"][:120]}...')
                    print(f'     URL: {link["url"]}')
            
            time.sleep(2)  # Rate limiting
            return True
        else:
            print(f'Failed: HTTP {response.status_code}')
            return False
            
    except Exception as e:
        print(f'Error: {str(e)}')
        return False

# Perform all searches
print('\n=== EXECUTING SEARCHES ===')
successful_searches = 0

for i, query in enumerate(search_queries, 1):
    if perform_search(query, i):
        successful_searches += 1
    
    # Brief pause between searches
    if i < len(search_queries):
        time.sleep(1)

print(f'\n=== STEP 2: ANALYZING SEARCH RESULTS FOR HISTORICAL WORK IDENTIFICATION ===')
print(f'Successful searches: {successful_searches}/{len(search_queries)}')

# Compile and analyze all findings
high_priority_findings = []
book_title_candidates = set()
publisher_mentions = {}

# Known Victorian publishers to watch for
known_publishers = [
    'George Bell', 'Bell and Sons', 'George Bell and Sons',
    'Macmillan', 'Macmillan and Co', 'Longman', 'Longmans',
    'Chapman and Hall', 'Smith Elder', 'Smith, Elder and Co',
    'John Murray', 'William Blackwood', 'Blackwood and Sons',
    'Routledge', 'Kegan Paul', 'Cassell', 'Methuen'
]

print('\n--- ANALYZING ALL SEARCH RESULTS FOR BOOK AND PUBLISHER PATTERNS ---')

for query, results in search_results.items():
    print(f'\nQuery: "{query}"')
    print(f'  Relevant links: {results["total_links_found"]}')
    
    for link in results['relevant_links']:
        text_lower = link['text'].lower()
        
        # Check for key historical work indicators
        has_1846 = '1846' in text_lower
        has_1840 = '1840' in text_lower
        has_convention = 'convention' in text_lower
        has_egyptian = 'egyptian' in text_lower or 'egypt' in text_lower
        has_ottoman = 'ottoman' in text_lower
        has_peace = 'peace' in text_lower
        has_thirty_years = 'thirty years' in text_lower
        has_four_volume = 'four volume' in text_lower or '4 volume' in text_lower
        has_1877_1878 = '1877' in text_lower or '1878' in text_lower
        
        # Calculate historical relevance score
        hist_score = sum([has_1846*3, has_1840*2, has_convention*2, has_egyptian*2, 
                         has_ottoman*2, has_peace*2, has_thirty_years*3, 
                         has_four_volume*3, has_1877_1878*2])
        
        if hist_score >= 5:  # High historical relevance
            print(f'  🎯 HIGH HISTORICAL RELEVANCE: Score {hist_score}')
            print(f'     1846: {has_1846}, 1840: {has_1840}, Convention: {has_convention}')
            print(f'     Egyptian: {has_egyptian}, Ottoman: {has_ottoman}, Peace: {has_peace}')
            print(f'     Thirty Years: {has_thirty_years}, Four Volume: {has_four_volume}')
            print(f'     1877-1878: {has_1877_1878}')
            
            high_priority_findings.append({
                'query': query,
                'text': link['text'],
                'url': link['url'],
                'score': link['relevance_score'],
                'historical_score': hist_score,
                'priority': 'HIGH - Historical Match'
            })
            
            # Extract potential book titles
            text_lines = link['text'].split('\n')
            for line in text_lines:
                line_clean = line.strip()
                if ('history' in line_clean.lower() and 'martineau' in line_clean.lower() and
                    len(line_clean) > 20 and len(line_clean) < 200):
                    book_title_candidates.add(line_clean)
            
            # Check for publisher mentions
            for publisher in known_publishers:
                if publisher.lower() in text_lower:
                    publisher_mentions[publisher] = publisher_mentions.get(publisher, 0) + 1
                    print(f'     📚 PUBLISHER: {publisher}')
        
        elif hist_score >= 2:  # Medium historical relevance
            print(f'  📍 MEDIUM: Historical score {hist_score}')
            
            high_priority_findings.append({
                'query': query,
                'text': link['text'],
                'url': link['url'],
                'score': link['relevance_score'],
                'historical_score': hist_score,
                'priority': 'MEDIUM - Partial Match'
            })

print(f'\n=== STEP 3: BOOK TITLE AND PUBLISHER ANALYSIS ===')
print(f'High-priority findings: {len(high_priority_findings)}')
print(f'Book title candidates: {len(book_title_candidates)}')
print(f'Publisher mentions: {len(publisher_mentions)}')

if book_title_candidates:
    print('\n📖 POTENTIAL BOOK TITLES:')
    for i, title in enumerate(sorted(book_title_candidates), 1):
        print(f'  {i}. {title}')

if publisher_mentions:
    print('\n📚 PUBLISHER FREQUENCY:')
    sorted_publishers = sorted(publisher_mentions.items(), key=lambda x: x[1], reverse=True)
    for publisher, count in sorted_publishers:
        print(f'  {publisher}: {count} mentions')

print(f'\n=== STEP 4: DETAILED ANALYSIS OF HIGH-PRIORITY FINDINGS ===')

if high_priority_findings:
    # Sort by historical score and relevance score
    high_priority_findings.sort(key=lambda x: (x['historical_score'], x['score']), reverse=True)
    
    print(f'\nAnalyzing {len(high_priority_findings)} high-priority findings:')
    
    for i, finding in enumerate(high_priority_findings[:10], 1):  # Top 10 findings
        print(f'\n🔍 FINDING {i} - {finding["priority"]} (Hist: {finding["historical_score"]}, Rel: {finding["score"]})')
        print(f'Query: {finding["query"]}')
        print(f'URL: {finding["url"]}')
        print(f'Text: {finding["text"][:500]}...')
        print('-' * 120)
        
        # If this is a high-priority finding, recommend investigation
        if finding['historical_score'] >= 7:
            print(f'  ⭐ HIGHLY RECOMMENDED FOR INVESTIGATION: {finding["url"]}')
else:
    print('\n⚠ No high-priority findings identified')
    print('May need to search with different terms or check specific databases')

# Try Google Books API for more specific search
print(f'\n=== STEP 5: GOOGLE BOOKS API SEARCH ===')

google_books_queries = [
    'Harriet Martineau History England Thirty Years Peace',
    'Martineau 1816-1846 European peace four volumes',
    'Harriet Martineau Convention London 1840 Egyptian'
]

books_api_results = []

for i, query in enumerate(google_books_queries, 1):
    print(f'\n--- Google Books API Query {i}: {query} ---')
    
    try:
        api_url = 'https://www.googleapis.com/books/v1/volumes'
        params = {
            'q': query,
            'maxResults': 20,
            'printType': 'books'
        }
        
        response = requests.get(api_url, params=params, timeout=30)
        print(f'Status: {response.status_code}')
        
        if response.status_code == 200:
            data = response.json()
            
            if 'items' in data:
                print(f'Found {len(data["items"])} books')
                
                for book in data['items']:
                    volume_info = book.get('volumeInfo', {})
                    title = volume_info.get('title', '')
                    authors = volume_info.get('authors', [])
                    published_date = volume_info.get('publishedDate', '')
                    publisher = volume_info.get('publisher', '')
                    description = volume_info.get('description', '')
                    
                    # Check if this matches our criteria
                    title_lower = title.lower()
                    authors_str = ' '.join(authors).lower()
                    desc_lower = description.lower()
                    
                    # Look for Martineau's historical work
                    if ('martineau' in authors_str and
                        ('history' in title_lower or 'peace' in title_lower or
                         '1846' in title_lower or '1840' in desc_lower or
                         'thirty years' in title_lower or 'thirty years' in desc_lower)):
                        
                        print(f'\n🎯 POTENTIAL MARTINEAU HISTORICAL WORK!')
                        print(f'Title: {title}')
                        print(f'Authors: {authors}')
                        print(f'Publisher: {publisher}')
                        print(f'Published: {published_date}')
                        if description:
                            print(f'Description: {description[:300]}...')
                        
                        books_api_results.append({
                            'title': title,
                            'authors': authors,
                            'publisher': publisher,
                            'published_date': published_date,
                            'description': description,
                            'query': query,
                            'source': 'Google Books API'
                        })
                        
                        # Check for four-volume edition indicators
                        if ('four' in title_lower or '4' in title or
                            'volume' in title_lower or 'vol' in title_lower or
                            '1877' in published_date or '1878' in published_date):
                            print(f'  📚 POTENTIAL FOUR-VOLUME EDITION MATCH!')
            else:
                print('No books found in API response')
        else:
            print(f'API request failed: {response.status_code}')
            
        time.sleep(1)  # Rate limiting
        
    except Exception as e:
        print(f'Error with Google Books API: {str(e)}')

# Save comprehensive analysis
analysis_results = {
    'search_objective': 'Find Harriet Martineau\'s historical work on European peace ending 1846',
    'key_elements': {
        'time_period': '1816-1846',
        'key_event': 'Convention of London 1840',
        'crisis': 'Egyptian-Ottoman crisis',
        'target_edition': 'Four-volume edition 1877-1878'
    },
    'search_summary': {
        'total_queries': len(search_queries),
        'successful_searches': successful_searches,
        'total_relevant_links': sum(len(r['relevant_links']) for r in search_results.values())
    },
    'analysis_results': {
        'high_priority_findings_count': len(high_priority_findings),
        'book_title_candidates': list(book_title_candidates),
        'publisher_mentions': publisher_mentions,
        'google_books_results': len(books_api_results)
    },
    'high_priority_findings': high_priority_findings[:10],  # Top 10 findings
    'google_books_results': books_api_results,
    'search_queries_used': search_queries,
    'analysis_timestamp': time.strftime('%Y-%m-%d %H:%M:%S')
}

analysis_file = 'workspace/martineau_historical_work_analysis.json'
with open(analysis_file, 'w', encoding='utf-8') as f:
    json.dump(analysis_results, f, indent=2, ensure_ascii=False)

print(f'\n*** MARTINEAU HISTORICAL WORK SEARCH COMPLETE ***')
print(f'✓ Conducted {successful_searches} successful searches')
print(f'✓ Analyzed {sum(len(r["relevant_links"]) for r in search_results.values())} relevant results')
print(f'✓ Found {len(high_priority_findings)} high-priority findings')
print(f'✓ Identified {len(book_title_candidates)} potential book titles')
print(f'✓ Found {len(publisher_mentions)} publisher mentions')
print(f'✓ Google Books API returned {len(books_api_results)} relevant results')
print(f'✓ Comprehensive analysis saved to: {analysis_file}')

# Summary of most promising leads
if high_priority_findings:
    top_finding = high_priority_findings[0]
    print(f'\n🎯 MOST PROMISING LEAD:')
    print(f'Priority: {top_finding["priority"]}')
    print(f'Historical Score: {top_finding["historical_score"]}')
    print(f'Relevance Score: {top_finding["score"]}')
    print(f'URL: {top_finding["url"]}')

if sorted_publishers:
    top_publisher = sorted_publishers[0][0]
    print(f'\n📚 MOST MENTIONED PUBLISHER: {top_publisher} ({sorted_publishers[0][1]} mentions)')

if books_api_results:
    print(f'\n📖 GOOGLE BOOKS TOP RESULT:')
    top_book = books_api_results[0]
    print(f'Title: {top_book["title"]}')
    print(f'Publisher: {top_book["publisher"]}')
    print(f'Date: {top_book["published_date"]}')

print('\n=== NEXT STEPS ===')
print('1. Review high-priority findings for book title identification')
print('2. Investigate URLs from top-scoring results')
print('3. Cross-reference with library catalogs for four-volume editions')
print('4. Check publisher records for 1877-1878 editions')
print('5. Look for "History of England during the Thirty Years\' Peace" specifically')
```