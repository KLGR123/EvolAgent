### Development Step 2: Parse Railroad Museum Locomotive Inventory; Identify 'Murder Mystery Express' Locomotive Type and American Name

**Description**: Parse and analyze the attached Excel file data/gaia/2023/validation/edd4d4f2-1a58-45c4-b038-67337af4e029.xlsx to extract the complete locomotive inventory data from the local railroad museum. Identify all locomotives and their assigned excursions or services, specifically locate the locomotive(s) used for the 'Murder Mystery Express' service, then determine the locomotive type and provide the typical American name for that type of locomotive.

**Use Cases**:
- Heritage railway museum curators using automated Excel parsing to maintain an up-to-date digital inventory of steam and diesel locomotives for exhibit planning
- Tourist excursion coordinators verifying locomotive assignments for themed events like the “Murder Mystery Express” and ensuring correct equipment is scheduled
- Maintenance teams forecasting service intervals by extracting wheel configurations and operating statuses to prioritize repairs on high-usage locomotives
- Educational outreach developers generating interactive displays and guided tours by querying locomotive types and historical details from the museum database
- Railway historians conducting comparative research on wheel arrangements and American locomotive classifications using structured JSON outputs for academic publications
- Transportation regulators compiling compliance reports and asset registers by automating the extraction of locomotive inventories and operational statuses
- Marketing departments creating targeted promotional materials for special train services by identifying unique locomotive types and their themed assignments
- IT teams integrating the locomotive inventory JSON into web portals and mobile apps to provide visitors with real-time search and filter capabilities

```
import os
import pandas as pd
import json

print("=== MURDER MYSTERY EXPRESS LOCOMOTIVE TYPE IDENTIFICATION ===\n")

# Load the Excel file and extract locomotive data for Murder Mystery Express
xlsx_path = "data/gaia/2023/validation/edd4d4f2-1a58-45c4-b038-67337af4e029.xlsx"

print(f"Loading Excel file: {xlsx_path}")
df = pd.read_excel(xlsx_path)

print(f"\nDataFrame shape: {df.shape}")
print(f"Column names: {list(df.columns)}")

print("\n=== COMPLETE LOCOMOTIVE DATABASE ===\n") 
print(df.to_string())

# Clean the data by removing category header rows (Steam, Diesel) and empty rows
print("\n=== CLEANING DATA ===\n")
print("Removing category header rows and empty rows...")

# Remove rows where Number column contains 'Steam' or 'Diesel' (these are category headers)
clean_df = df[~df['Number'].isin(['Steam', 'Diesel'])].copy()

# Remove rows with missing locomotive numbers
clean_df = clean_df.dropna(subset=['Number'])

print(f"\nCleaned DataFrame shape: {clean_df.shape}")
print("\nCleaned locomotive data:")
print(clean_df.to_string())

# Find the locomotive assigned to Murder Mystery Express
print("\n=== IDENTIFYING MURDER MYSTERY EXPRESS LOCOMOTIVE ===\n")
murder_mystery_locomotive = clean_df[clean_df['Excursion/Location'] == 'Murder Mystery Express'].copy()

print(f"Locomotives assigned to Murder Mystery Express: {len(murder_mystery_locomotive)}")
print("\nMurder Mystery Express locomotive details:")
print(murder_mystery_locomotive.to_string())

if len(murder_mystery_locomotive) > 0:
    locomotive_row = murder_mystery_locomotive.iloc[0]
    locomotive_number = locomotive_row['Number']
    wheel_configuration = locomotive_row['Type/Wheel Configuration']
    operating_status = locomotive_row['Operating Status']
    
    print(f"\n=== LOCOMOTIVE DETAILS ===\n")
    print(f"Locomotive Number: {locomotive_number}")
    print(f"Wheel Configuration: {wheel_configuration}")
    print(f"Operating Status: {operating_status}")
    print(f"Service Assignment: Murder Mystery Express")
    
    # Determine the American locomotive type name based on wheel configuration
    print(f"\n=== AMERICAN LOCOMOTIVE TYPE CLASSIFICATION ===\n")
    
    # Dictionary of common American locomotive type names based on wheel arrangements
    american_locomotive_types = {
        '0-4-0': 'Four-wheeler or Switcher',
        '0-6-0': 'Six-wheeler or Switcher', 
        '2-4-0': 'Porter',
        '4-4-0': 'American',
        '2-6-0': 'Mogul',
        '4-6-0': 'Ten-wheeler',
        '2-8-0': 'Consolidation',
        '4-8-0': 'Twelve-wheeler or Mastodon',
        '2-6-2': 'Prairie',
        '4-6-2': 'Pacific',
        '2-8-2': 'Mikado',
        '4-8-2': 'Mountain',
        '2-6-4': 'Adriatic',
        '4-6-4': 'Hudson',
        '2-8-4': 'Berkshire',
        '4-8-4': 'Northern',
        '2-10-0': 'Decapod',
        '2-10-2': 'Santa Fe',
        '2-10-4': 'Texas',
        '4-12-2': 'Union Pacific'
    }
    
    # Look up the American type name
    if wheel_configuration in american_locomotive_types:
        american_type_name = american_locomotive_types[wheel_configuration]
        print(f"Wheel Configuration: {wheel_configuration}")
        print(f"American Type Name: {american_type_name}")
        
        print(f"\n=== DETAILED TYPE INFORMATION ===\n")
        if wheel_configuration == '2-8-4':
            print("The 2-8-4 'Berkshire' type locomotive:")
            print("- Named after the Berkshire Hills region in Massachusetts")
            print("- First developed by the Boston & Albany Railroad in 1925")
            print("- Features: 2 leading wheels, 8 driving wheels, 4 trailing wheels")
            print("- Known for excellent performance on heavy freight and passenger service")
            print("- The trailing truck helps support a larger firebox for better steam generation")
            print("- Popular with many American railroads from the 1920s through 1950s")
    else:
        american_type_name = f"Unknown type for {wheel_configuration}"
        print(f"Wheel Configuration: {wheel_configuration}")
        print(f"American Type Name: {american_type_name}")
    
    # Save detailed results
    results = {
        'murder_mystery_express_locomotive': {
            'locomotive_number': locomotive_number,
            'wheel_configuration': wheel_configuration,
            'american_type_name': american_type_name,
            'operating_status': operating_status,
            'service_assignment': 'Murder Mystery Express'
        },
        'locomotive_type_details': {
            'wheel_arrangement': wheel_configuration,
            'common_american_name': american_type_name,
            'locomotive_class': 'Steam locomotive' if '-' in str(wheel_configuration) else 'Diesel locomotive'
        },
        'complete_inventory_summary': {
            'total_locomotives': len(clean_df),
            'steam_locomotives': len(clean_df[clean_df['Type/Wheel Configuration'].str.contains('-', na=False)]),
            'diesel_locomotives': len(clean_df[~clean_df['Type/Wheel Configuration'].str.contains('-', na=False)])
        }
    }
    
    # Save results to JSON
    with open('workspace/murder_mystery_express_locomotive_analysis.json', 'w') as f:
        json.dump(results, f, indent=2)
    
    print(f"\n=== FINAL ANSWER ===\n")
    print(f"Locomotive used for Murder Mystery Express: #{locomotive_number}")
    print(f"Locomotive Type: {wheel_configuration} wheel arrangement")
    print(f"Typical American Name: {american_type_name}")
    print(f"Operating Status: {operating_status}")
    
    print(f"\nDetailed analysis saved to: workspace/murder_mystery_express_locomotive_analysis.json")
    
else:
    print("No locomotive found assigned to Murder Mystery Express service!")

# Display all locomotive types in the museum for reference
print(f"\n=== COMPLETE MUSEUM LOCOMOTIVE INVENTORY ===\n")
steam_locomotives = clean_df[clean_df['Type/Wheel Configuration'].str.contains('-', na=False)]
diesel_locomotives = clean_df[~clean_df['Type/Wheel Configuration'].str.contains('-', na=False)]

print(f"Steam Locomotives ({len(steam_locomotives)}):")
for idx, row in steam_locomotives.iterrows():
    config = row['Type/Wheel Configuration']
    american_name = american_locomotive_types.get(config, 'Unknown type')
    print(f"  - #{row['Number']}: {config} ({american_name}) - {row['Excursion/Location']}")

print(f"\nDiesel Locomotives ({len(diesel_locomotives)}):")
for idx, row in diesel_locomotives.iterrows():
    print(f"  - #{row['Number']}: {row['Type/Wheel Configuration']} - {row['Excursion/Location']}")
```