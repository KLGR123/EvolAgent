### Development Step 1: Title:  
Extract and Identify Unique and Duplicate Food Items from Excel Inventory, Highlighting Singly-Listed Foods

**Description**: Parse and analyze the attached Excel file data/gaia/2023/validation/9b54f9d9-35ee-4a14-b62f-d130ea00317f/food_duplicates.xls to extract all food items listed in the spreadsheet. Identify the complete inventory of food names and examine for any duplicates or variations of the same food item appearing under different names. Create a comprehensive list of all unique food items and identify which single food item appears only once without any duplicate entries or alternative naming variations.

**Use Cases**:
- Restaurant chain menu standardization by identifying duplicate or variant food items across multiple branches to streamline procurement and reduce inventory confusion
- Food safety audit for catering companies to ensure allergen tracking by detecting duplicate or mislabeled food items in supply spreadsheets
- Grocery store inventory reconciliation to eliminate redundant product listings and optimize shelf space allocation
- Nutrition research data cleaning for clinical studies, ensuring unique food item entries for accurate dietary analysis
- School cafeteria menu planning by analyzing supplier spreadsheets to prevent ordering duplicate food products under different names
- Automated quality control for food delivery platforms, flagging duplicate or inconsistent food item names in vendor-uploaded menus
- Food manufacturer product line review to consolidate similar products and improve catalog clarity for distributors
- Hospitality group procurement analysis to identify single-occurrence specialty items and avoid accidental reordering of duplicate foods

```
import os
import pandas as pd
from openpyxl import load_workbook
import json
from collections import Counter

# The path to the Excel file to be analyzed
xls_path = "data/gaia/2023/validation/9b54f9d9-35ee-4a14-b62f-d130ea00317f/food_duplicates.xls"

print("=== FOOD DUPLICATES ANALYSIS - INITIAL EXPLORATION ===")
print(f"Analyzing file: {xls_path}")

# Check if file exists
if not os.path.exists(xls_path):
    print(f"Error: Excel file '{xls_path}' does not exist.")
    exit()

print(f"File exists: {xls_path}")
file_size = os.path.getsize(xls_path)
print(f"File size: {file_size} bytes")

# Load the Excel file with pandas for complete data extraction
print("\nLoading complete dataset with pandas...")
try:
    # Read the .xls file
    df = pd.read_excel(xls_path)
    print(f"Dataset shape: {df.shape}")
    print(f"Column names: {list(df.columns)}")
except Exception as e:
    print(f"Error reading with pandas: {e}")
    exit()

# Display the complete dataset structure
print("\n=== COMPLETE DATASET PREVIEW ===")
print(df.head(10).to_string(index=False))

print("\n=== COMPLETE DATASET ===")
print(df.to_string(index=False))

# Save complete data to workspace for reference
os.makedirs('workspace', exist_ok=True)
with open('workspace/complete_food_data.txt', 'w') as f:
    f.write("=== FOOD DUPLICATES COMPLETE DATASET ===\n")
    f.write(f"Dataset shape: {df.shape}\n")
    f.write(f"Column names: {list(df.columns)}\n\n")
    f.write("Complete dataset:\n")
    f.write(df.to_string(index=False))
    f.write("\n\n")

print(f"\nComplete dataset saved to: workspace/complete_food_data.txt")

# Analyze the data structure to identify food item columns
print("\n=== DATA STRUCTURE ANALYSIS ===")
columns = list(df.columns)
print(f"All columns: {columns}")

# Look for columns that might contain food names
food_columns = []
for col in columns:
    col_str = str(col).lower()
    if any(keyword in col_str for keyword in ['food', 'item', 'name', 'product']):
        food_columns.append(col)
        print(f"Potential food column identified: {col}")

# If no obvious food columns, examine all columns for text data
if not food_columns:
    print("No obvious food columns found. Examining all columns for text data...")
    for col in columns:
        sample_values = df[col].dropna().head(5).tolist()
        print(f"Column '{col}' sample values: {sample_values}")
        # Check if this column contains text that could be food names
        if df[col].dtype == 'object':
            food_columns.append(col)

print(f"\nIdentified food columns: {food_columns}")

# Extract all food items from identified columns
print("\n=== EXTRACTING ALL FOOD ITEMS ===")
all_food_items = []

for col in food_columns:
    print(f"\nExtracting from column: {col}")
    # Get all non-null values from this column
    food_values = df[col].dropna().tolist()
    print(f"Found {len(food_values)} items in column '{col}'")
    
    for item in food_values:
        item_str = str(item).strip()
        if item_str:  # Only add non-empty items
            all_food_items.append(item_str)
            print(f"  - {item_str}")

print(f"\nTotal food items extracted: {len(all_food_items)}")

# Count occurrences of each food item
print("\n=== FOOD ITEM FREQUENCY ANALYSIS ===")
food_counter = Counter(all_food_items)
print(f"Unique food items: {len(food_counter)}")

# Sort by frequency (most common first)
sorted_foods = food_counter.most_common()
print("\nFood items sorted by frequency:")
for food, count in sorted_foods:
    print(f"  {food}: {count} occurrence(s)")

# Identify items that appear only once
print("\n=== ITEMS APPEARING ONLY ONCE ===")
unique_items = [food for food, count in food_counter.items() if count == 1]
print(f"Number of items appearing only once: {len(unique_items)}")

for item in unique_items:
    print(f"  - {item}")

# Identify duplicates (items appearing more than once)
print("\n=== DUPLICATE ITEMS ===")
duplicate_items = [food for food, count in food_counter.items() if count > 1]
print(f"Number of items with duplicates: {len(duplicate_items)}")

for item in duplicate_items:
    count = food_counter[item]
    print(f"  - {item}: {count} occurrences")

# Create comprehensive analysis report
analysis_report = {
    'dataset_info': {
        'file_path': xls_path,
        'shape': df.shape,
        'columns': list(df.columns)
    },
    'food_columns': food_columns,
    'total_food_items': len(all_food_items),
    'unique_food_items': len(food_counter),
    'frequency_analysis': dict(sorted_foods),
    'items_appearing_once': unique_items,
    'duplicate_items': {
        item: count for item, count in food_counter.items() if count > 1
    }
}

# Save comprehensive analysis
with open('workspace/food_duplicates_analysis.json', 'w') as f:
    json.dump(analysis_report, f, indent=2)

print(f"\nComprehensive analysis saved to: workspace/food_duplicates_analysis.json")

# Save summary report
with open('workspace/food_analysis_summary.txt', 'w') as f:
    f.write("FOOD DUPLICATES ANALYSIS SUMMARY\n")
    f.write("="*50 + "\n\n")
    f.write(f"Dataset: {os.path.basename(xls_path)}\n")
    f.write(f"Total food items found: {len(all_food_items)}\n")
    f.write(f"Unique food items: {len(food_counter)}\n\n")
    
    f.write("ITEMS APPEARING ONLY ONCE:\n")
    for item in unique_items:
        f.write(f"  - {item}\n")
    
    f.write(f"\nDUPLICATE ITEMS:\n")
    for item in duplicate_items:
        count = food_counter[item]
        f.write(f"  - {item}: {count} occurrences\n")
    
    f.write(f"\nALL FOOD ITEMS WITH FREQUENCIES:\n")
    for food, count in sorted_foods:
        f.write(f"  {food}: {count}\n")

print(f"Food analysis summary saved to: workspace/food_analysis_summary.txt")

print("\n*** INITIAL ANALYSIS COMPLETE ***")
print(f"Found {len(all_food_items)} total food items")
print(f"Found {len(food_counter)} unique food items")
print(f"Found {len(unique_items)} items appearing only once")
print(f"Found {len(duplicate_items)} items with duplicates")
```