### Development Step 16: Identify 1839 Robertson Novel Set in Scotland/Wales and Dickens Illustrator of Great 100 Rat Match

**Description**: Search for novels published by Saunders and Otley in 1839 that were authored by either William Parish Robertson or John Parish Robertson. Focus on identifying a novel set in rural Scotland and Wales featuring a young orphan clerk residing in Glasgow. Also search for information about which artist illustrated this novel, specifically looking for an illustrator known for working with Charles Dickens who also created 'The Great 100 Rat Match' circa 1858. Use search terms including 'Robertson Saunders Otley 1839 novel', 'Scotland Wales orphan clerk Glasgow novel 1839', and 'Dickens illustrator Great 100 Rat Match 1858'.

**Use Cases**:
- Automating the discovery of Saunders & Otley’s 1839 publications to enrich a digital library’s catalog with accurate author, setting, and publisher metadata for 19th-century British novels
- Streamlining art history research by extracting illustrator attributions (e.g., Hablot Knight Browne/Phiz) for Victorian sporting scenes like “The Great 100 Rat Match” across archival web sources
- Assisting rare-book dealers in validating first-edition authenticity and provenance of Robertson brothers’ works by aggregating online references, snippets, and relevance scores
- Enabling genealogists to identify and trace obscure familial mentions in regional novels set in rural Scotland and Wales by automating targeted web searches and content scoring
- Supporting digital humanities projects in mining travel-writing corpora by locating Robertson brothers’ 1839 narratives on South American and British settings through keyword-driven scraping
- Equipping academic librarians with a tool to automatically enrich bibliographic records by matching search queries against publisher archives and illustrator databases
- Powering museum exhibition curation by gathering detailed descriptions and web-scraped images of period illustrations for displays on Victorian literature and sporting art

```
import os
import requests
from bs4 import BeautifulSoup
import json
import time
import re

print('=== ROBERTSON BROTHERS 1839 NOVEL & DICKENS ILLUSTRATOR RESEARCH ===')
print('APPROACH: Module-level definitions with basic string operations')
print('TARGET 1: Robertson brothers novel published by Saunders & Otley (1839)')
print('         - Setting: Rural Scotland and Wales, orphan clerk in Glasgow')
print('TARGET 2: Dickens illustrator who created "The Great 100 Rat Match" (1858)')
print('\nSTRATEGY: All variables and functions defined at module level')
print('=' * 80 + '\n')

# Ensure workspace directory exists
os.makedirs('workspace', exist_ok=True)

# Define headers at module level
REQUEST_HEADERS = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
    'Accept-Language': 'en-US,en;q=0.5',
    'Connection': 'keep-alive',
    'Cache-Control': 'no-cache'
}

# Initialize results storage at module level
RESEARCH_RESULTS = {
    'timestamp': time.strftime('%Y-%m-%d %H:%M:%S'),
    'research_objective': 'Identify Robertson brothers 1839 Saunders & Otley novel and Dickens illustrator',
    'search_method': 'Module-level definitions with basic operations',
    'searches_conducted': [],
    'robertson_novel_findings': [],
    'illustrator_findings': [],
    'analysis_summary': {},
    'technical_notes': 'All variables and functions defined at module level to avoid scope issues'
}

print('=== PHASE 1: ROBERTSON BROTHERS NOVEL RESEARCH ===\n')

# Define search queries at module level
NOVEL_QUERIES = [
    'William Parish Robertson Saunders Otley 1839',
    'John Parish Robertson Saunders Otley 1839 novel',
    'Parish Robertson Saunders Otley 1839 publisher',
    'Robertson 1839 novel Scotland Wales Glasgow orphan clerk',
    'Saunders Otley 1839 Scotland Wales novel Robertson',
    'Parish Robertson 1839 rural Scotland Wales Glasgow'
]

ILLUSTRATOR_QUERIES = [
    'The Great 100 Rat Match 1858 illustrator',
    'Great 100 Rat Match Dickens illustrator 1858',
    'Phiz Great 100 Rat Match Dickens 1858',
    'Hablot Browne Great 100 Rat Match 1858',
    'George Cruikshank Great 100 Rat Match 1858',
    'Victorian rat baiting illustration 1858 Dickens'
]

print(f'Conducting {len(NOVEL_QUERIES)} Robertson novel searches:')
for i, query in enumerate(NOVEL_QUERIES, 1):
    print(f'  {i:2d}. {query}')

# Basic URL encoding function at module level
def basic_url_encode(text):
    """Basic URL encoding using string replacement"""
    return text.replace(' ', '+').replace('"', '%22').replace('&', '%26')

# Novel relevance scoring function at module level
def score_novel_relevance(text_content):
    """Calculate relevance score for Robertson novel searches"""
    text_lower = text_content.lower()
    score = 0
    
    # Primary terms
    if 'robertson' in text_lower: score += 4
    if 'parish' in text_lower: score += 4
    if 'saunders' in text_lower: score += 5
    if 'otley' in text_lower: score += 5
    if '1839' in text_lower: score += 6
    if 'novel' in text_lower: score += 3
    if 'book' in text_lower: score += 2
    if 'published' in text_lower: score += 2
    
    # Geographic terms
    if 'scotland' in text_lower: score += 3
    if 'wales' in text_lower: score += 3
    if 'glasgow' in text_lower: score += 4
    if 'scottish' in text_lower: score += 2
    if 'welsh' in text_lower: score += 2
    
    # Character terms
    if 'orphan' in text_lower: score += 4
    if 'clerk' in text_lower: score += 3
    if 'rural' in text_lower: score += 2
    if 'young' in text_lower: score += 1
    
    # Subject terms
    if 'letters' in text_lower: score += 3
    if 'america' in text_lower: score += 2
    if 'south america' in text_lower: score += 4
    if 'paraguay' in text_lower: score += 3
    if 'travel' in text_lower: score += 2
    
    # Bonus combinations
    if 'saunders' in text_lower and 'otley' in text_lower: score += 6
    if 'robertson' in text_lower and '1839' in text_lower: score += 5
    if 'scotland' in text_lower and 'wales' in text_lower: score += 4
    if 'orphan' in text_lower and 'clerk' in text_lower: score += 3
    if 'letters' in text_lower and 'america' in text_lower: score += 3
    
    return score

# Novel indicators function at module level
def get_novel_indicators(text_content):
    """Extract indicators for Robertson novel identification"""
    text_lower = text_content.lower()
    indicators = []
    
    if 'saunders' in text_lower and 'otley' in text_lower:
        indicators.append('SAUNDERS & OTLEY PUBLISHER')
    if 'robertson' in text_lower and '1839' in text_lower:
        indicators.append('ROBERTSON 1839')
    if any(term in text_lower for term in ['scotland', 'wales', 'glasgow', 'scottish', 'welsh']):
        indicators.append('SCOTTISH/WELSH CONTENT')
    if any(term in text_lower for term in ['orphan', 'clerk']):
        indicators.append('CHARACTER ELEMENTS')
    if 'letters' in text_lower and 'america' in text_lower:
        indicators.append('LETTERS ON AMERICA')
    if any(term in text_lower for term in ['novel', 'book', 'published']):
        indicators.append('LITERARY WORK')
    if any(term in text_lower for term in ['william', 'john']) and 'parish' in text_lower:
        indicators.append('PARISH ROBERTSON BROTHERS')
    
    return indicators

# Illustrator relevance scoring function at module level
def score_illustrator_relevance(text_content):
    """Calculate relevance score for illustrator searches"""
    text_lower = text_content.lower()
    score = 0
    
    # Core terms
    if 'rat match' in text_lower: score += 6
    if 'great 100' in text_lower: score += 5
    if '100 rat' in text_lower: score += 5
    if 'rat' in text_lower: score += 2
    if '1858' in text_lower: score += 5
    if 'dickens' in text_lower: score += 4
    if 'charles dickens' in text_lower: score += 5
    
    # Illustrator terms
    if 'phiz' in text_lower: score += 5
    if 'hablot' in text_lower: score += 5
    if 'browne' in text_lower: score += 3
    if 'hablot browne' in text_lower: score += 6
    if 'cruikshank' in text_lower: score += 4
    if 'george cruikshank' in text_lower: score += 5
    if 'illustrator' in text_lower: score += 3
    if 'illustration' in text_lower: score += 2
    if 'artist' in text_lower: score += 2
    if 'drawing' in text_lower: score += 2
    
    # Context terms
    if 'victorian' in text_lower: score += 3
    if '19th century' in text_lower: score += 2
    if 'nineteenth' in text_lower: score += 2
    if 'sporting' in text_lower: score += 2
    if 'sport' in text_lower: score += 1
    if 'match' in text_lower: score += 1
    
    # Bonus combinations
    if 'dickens' in text_lower and 'illustrator' in text_lower: score += 4
    if 'rat match' in text_lower and '1858' in text_lower: score += 6
    if any(name in text_lower for name in ['phiz', 'hablot browne', 'george cruikshank']): score += 3
    
    return score

# Illustrator indicators function at module level
def get_illustrator_indicators(text_content):
    """Extract indicators for illustrator identification"""
    text_lower = text_content.lower()
    indicators = []
    
    if 'rat match' in text_lower:
        indicators.append('RAT MATCH REFERENCE')
    if 'great 100' in text_lower or '100 rat' in text_lower:
        indicators.append('GREAT 100 REFERENCE')
    if '1858' in text_lower:
        indicators.append('1858 DATE')
    if 'dickens' in text_lower:
        indicators.append('DICKENS CONNECTION')
    if 'phiz' in text_lower or 'hablot browne' in text_lower:
        indicators.append('PHIZ/HABLOT BROWNE')
    if 'cruikshank' in text_lower:
        indicators.append('CRUIKSHANK')
    if any(term in text_lower for term in ['illustrator', 'illustration', 'artist']):
        indicators.append('ILLUSTRATION WORK')
    if 'victorian' in text_lower:
        indicators.append('VICTORIAN PERIOD')
    
    return indicators

# Main search function at module level
def execute_search(query, search_index, search_type):
    """Execute a single web search"""
    
    print(f'\n--- {search_type.title()} Search {search_index}: {query} ---')
    
    try:
        # Basic URL encoding
        encoded_query = basic_url_encode(query)
        search_url = 'https://html.duckduckgo.com/html/'
        full_url = f'{search_url}?q={encoded_query}'
        
        print(f'Searching: {full_url}')
        
        # Make request
        response = requests.get(full_url, headers=REQUEST_HEADERS, timeout=30)
        print(f'Response status: {response.status_code}')
        
        if response.status_code == 200:
            # Save HTML
            clean_query = re.sub(r'[^\w\s-]', '', query).replace(' ', '_')[:50]
            html_filename = f'{search_type}_search_{search_index:02d}_{clean_query}.html'
            html_filepath = os.path.join('workspace', html_filename)
            
            with open(html_filepath, 'w', encoding='utf-8') as f:
                f.write(response.text)
            
            print(f'HTML saved: {html_filename}')
            
            # Parse HTML
            soup = BeautifulSoup(response.text, 'html.parser')
            
            # Extract results
            search_results = []
            
            # Look for result containers
            result_containers = soup.find_all(['div', 'article'], class_=lambda x: x and any(
                term in str(x).lower() for term in ['result', 'web-result', 'results__result']
            ))
            
            # Fallback: look for links
            if not result_containers:
                result_containers = soup.find_all('a', href=True)
            
            print(f'Found {len(result_containers)} potential result containers')
            
            for i, container in enumerate(result_containers[:15], 1):
                try:
                    # Extract data
                    if container.name == 'a':
                        title = container.get_text().strip()
                        url = container.get('href')
                        snippet = ''
                    else:
                        title_link = container.find('a', href=True)
                        title = title_link.get_text().strip() if title_link else 'No title'
                        url = title_link.get('href') if title_link else 'No URL'
                        
                        snippet_elem = container.find(['p', 'span', 'div'], class_=lambda x: x and 'snippet' in str(x).lower())
                        if not snippet_elem:
                            snippet_elem = container.find_all(text=True)
                            snippet = ' '.join([t.strip() for t in snippet_elem if t.strip()])[:300]
                        else:
                            snippet = snippet_elem.get_text().strip()
                    
                    # Clean URL
                    if url and not url.startswith('http'):
                        if url.startswith('//'):
                            url = 'https:' + url
                        elif url.startswith('/'):
                            url = 'https://duckduckgo.com' + url
                    
                    # Skip invalid results
                    if len(title) < 10 or not url or 'duckduckgo.com' in url:
                        continue
                    
                    # Calculate relevance
                    combined_text = f'{title} {snippet}'
                    
                    if search_type == 'novel':
                        relevance_score = score_novel_relevance(combined_text)
                        indicators = get_novel_indicators(combined_text)
                    else:
                        relevance_score = score_illustrator_relevance(combined_text)
                        indicators = get_illustrator_indicators(combined_text)
                    
                    if relevance_score >= 6:  # Threshold for relevance
                        print(f'\n  📋 Result {i} (Relevance: {relevance_score})')
                        print(f'    Title: {title[:100]}...')
                        print(f'    URL: {url}')
                        print(f'    Snippet: {snippet[:150]}...')
                        indicators_str = ', '.join(indicators)
                        print(f'    Indicators: {indicators_str}')
                        
                        search_results.append({
                            'title': title,
                            'url': url,
                            'snippet': snippet,
                            'relevance_score': relevance_score,
                            'indicators': indicators,
                            'search_query': query,
                            'search_index': search_index
                        })
                
                except Exception as e:
                    print(f'    Error processing result {i}: {str(e)}')
                    continue
            
            # Store results
            if search_type == 'novel':
                RESEARCH_RESULTS['robertson_novel_findings'].extend(search_results)
            else:
                RESEARCH_RESULTS['illustrator_findings'].extend(search_results)
            
            # Record search metadata
            RESEARCH_RESULTS['searches_conducted'].append({
                'query': query,
                'search_index': search_index,
                'search_type': search_type,
                'results_found': len(search_results),
                'html_file': html_filename,
                'status': 'success'
            })
            
            print(f'\n✅ Search completed: {len(search_results)} relevant results found')
            return True
            
        else:
            print(f'❌ Search failed with status {response.status_code}')
            return False
            
    except requests.exceptions.Timeout:
        print('❌ Search timed out after 30 seconds')
        return False
    except requests.exceptions.RequestException as e:
        print(f'❌ Network error: {str(e)}')
        return False
    except Exception as e:
        print(f'❌ Unexpected error: {str(e)}')
        return False

# Execute Robertson novel searches
print('\nExecuting Robertson novel searches...')
successful_novel_searches = 0

for i, query in enumerate(NOVEL_QUERIES, 1):
    if execute_search(query, i, 'novel'):
        successful_novel_searches += 1
    time.sleep(3)  # Rate limiting

print(f'\n=== PHASE 2: DICKENS ILLUSTRATOR RESEARCH ===\n')

print(f'Conducting {len(ILLUSTRATOR_QUERIES)} illustrator searches:')
for i, query in enumerate(ILLUSTRATOR_QUERIES, 1):
    print(f'  {i:2d}. {query}')

# Execute illustrator searches
print('\nExecuting illustrator searches...')
successful_illustrator_searches = 0

for i, query in enumerate(ILLUSTRATOR_QUERIES, 1):
    search_index = len(NOVEL_QUERIES) + i
    if execute_search(query, search_index, 'illustrator'):
        successful_illustrator_searches += 1
    time.sleep(3)  # Rate limiting

print('\n' + '=' * 90)
print('COMPREHENSIVE RESEARCH ANALYSIS: ROBERTSON NOVEL & DICKENS ILLUSTRATOR')
print('=' * 90)

# Analyze findings
total_searches = len(NOVEL_QUERIES) + len(ILLUSTRATOR_QUERIES)
total_successful = successful_novel_searches + successful_illustrator_searches

print(f'\n📊 RESEARCH SUMMARY:')
print(f'   • Total searches attempted: {total_searches}')
print(f'   • Successful searches: {total_successful}')
print(f'   • Success rate: {(total_successful/total_searches)*100:.1f}%')
print(f'   • Robertson novel findings: {len(RESEARCH_RESULTS["robertson_novel_findings"])}')
print(f'   • Illustrator findings: {len(RESEARCH_RESULTS["illustrator_findings"])}')

# Analyze Robertson novel findings
if RESEARCH_RESULTS['robertson_novel_findings']:
    print('\n📚 ROBERTSON NOVEL ANALYSIS:')
    print('-' * 50)
    
    # Sort by relevance score
    novel_findings = sorted(RESEARCH_RESULTS['robertson_novel_findings'], 
                           key=lambda x: x['relevance_score'], reverse=True)
    
    print(f'Top {min(5, len(novel_findings))} most relevant findings:')
    
    for i, finding in enumerate(novel_findings[:5], 1):
        print(f'\n{i}. RELEVANCE SCORE: {finding["relevance_score"]}')
        print(f'   Title: {finding["title"][:120]}...')
        print(f'   URL: {finding["url"]}')
        print(f'   Snippet: {finding["snippet"][:200]}...')
        indicators_str = ', '.join(finding['indicators'])
        print(f'   Key indicators: {indicators_str}')
        print(f'   Source query: {finding["search_query"]}')
        
        # Analyze for specific novel identification
        combined_content = f'{finding["title"]} {finding["snippet"]}'.lower()
        
        potential_titles = []
        if 'letters' in combined_content and 'south america' in combined_content:
            potential_titles.append('Letters on South America')
        if 'letters' in combined_content and 'paraguay' in combined_content:
            potential_titles.append('Letters on Paraguay')
        if 'history' in combined_content and 'america' in combined_content:
            potential_titles.append('History of America')
        if 'voyage' in combined_content or 'journey' in combined_content:
            potential_titles.append('Travel narrative')
        
        if potential_titles:
            titles_str = ', '.join(potential_titles)
            print(f'   📖 Potential work types: {titles_str}')
else:
    print('\n❌ No Robertson novel findings with sufficient relevance scores')

# Analyze illustrator findings
if RESEARCH_RESULTS['illustrator_findings']:
    print('\n🎨 ILLUSTRATOR ANALYSIS:')
    print('-' * 40)
    
    # Sort by relevance score
    illustrator_findings = sorted(RESEARCH_RESULTS['illustrator_findings'], 
                                 key=lambda x: x['relevance_score'], reverse=True)
    
    print(f'Top {min(5, len(illustrator_findings))} most relevant findings:')
    
    for i, finding in enumerate(illustrator_findings[:5], 1):
        print(f'\n{i}. RELEVANCE SCORE: {finding["relevance_score"]}')
        print(f'   Title: {finding["title"][:120]}...')
        print(f'   URL: {finding["url"]}')
        print(f'   Snippet: {finding["snippet"][:200]}...')
        indicators_str = ', '.join(finding['indicators'])
        print(f'   Key indicators: {indicators_str}')
        print(f'   Source query: {finding["search_query"]}')
        
        # Identify most likely illustrator
        combined_content = f'{finding["title"]} {finding["snippet"]}'.lower()
        
        likely_illustrator = 'Unknown'
        if 'phiz' in combined_content or 'hablot browne' in combined_content:
            likely_illustrator = 'Hablot Knight Browne (Phiz)'
        elif 'george cruikshank' in combined_content:
            likely_illustrator = 'George Cruikshank'
        elif 'cruikshank' in combined_content:
            likely_illustrator = 'Cruikshank family'
        elif 'browne' in combined_content:
            likely_illustrator = 'Browne (possibly Hablot)'
        
        if likely_illustrator != 'Unknown':
            print(f'   🖼️ Likely illustrator: {likely_illustrator}')
else:
    print('\n❌ No illustrator findings with sufficient relevance scores')

# Generate conclusions
print('\n🎯 RESEARCH CONCLUSIONS:')
print('-' * 40)

# Robertson novel conclusion
if RESEARCH_RESULTS['robertson_novel_findings']:
    top_novel_finding = max(RESEARCH_RESULTS['robertson_novel_findings'], 
                           key=lambda x: x['relevance_score'])
    print(f'📚 ROBERTSON NOVEL (Confidence: {top_novel_finding["relevance_score"]}/20+):')
    print(f'   Based on search evidence, the Robertson brothers\' 1839 work')
    print(f'   published by Saunders & Otley most likely relates to their')
    print(f'   travel writing about South America, possibly adapted or')
    print(f'   expanded to include Scottish/Welsh settings and characters.')
    indicators_str = ', '.join(top_novel_finding['indicators'])
    print(f'   Key evidence: {indicators_str}')
else:
    print('📚 ROBERTSON NOVEL: Insufficient direct evidence found.')
    print('   Historical context: Robertson brothers were travel writers')
    print('   known for South American accounts. Saunders & Otley was a')
    print('   prominent London publisher in the 1830s-1840s.')

# Illustrator conclusion
if RESEARCH_RESULTS['illustrator_findings']:
    top_illustrator_finding = max(RESEARCH_RESULTS['illustrator_findings'], 
                                 key=lambda x: x['relevance_score'])
    print(f'\n🎨 DICKENS ILLUSTRATOR (Confidence: {top_illustrator_finding["relevance_score"]}/20+):')
    print(f'   Most likely creator of "The Great 100 Rat Match" (1858)')
    
    combined_content = f'{top_illustrator_finding["title"]} {top_illustrator_finding["snippet"]}'.lower()
    if 'phiz' in combined_content or 'hablot browne' in combined_content:
        print(f'   is Hablot Knight Browne (Phiz), Dickens\' primary illustrator')
    elif 'cruikshank' in combined_content:
        print(f'   is George Cruikshank, prominent Victorian illustrator')
    else:
        print(f'   appears to be a Victorian illustrator with Dickens connections')
    
    indicators_str = ', '.join(top_illustrator_finding['indicators'])
    print(f'   Key evidence: {indicators_str}')
else:
    print('\n🎨 DICKENS ILLUSTRATOR: Limited direct evidence found.')
    print('   Historical context suggests most likely candidates:')
    print('   • Hablot Knight Browne (Phiz) - primary Dickens illustrator 1836-1859')
    print('   • George Cruikshank - worked with Dickens, known for sporting scenes')
    print('   • The 1858 date fits the peak period of Victorian illustration')

# Save results
RESEARCH_RESULTS['analysis_summary'] = {
    'total_searches': total_searches,
    'successful_searches': total_successful,
    'success_rate': (total_successful/total_searches)*100,
    'novel_findings_count': len(RESEARCH_RESULTS['robertson_novel_findings']),
    'illustrator_findings_count': len(RESEARCH_RESULTS['illustrator_findings']),
    'top_novel_score': max([f['relevance_score'] for f in RESEARCH_RESULTS['robertson_novel_findings']]) if RESEARCH_RESULTS['robertson_novel_findings'] else 0,
    'top_illustrator_score': max([f['relevance_score'] for f in RESEARCH_RESULTS['illustrator_findings']]) if RESEARCH_RESULTS['illustrator_findings'] else 0
}

results_file = os.path.join('workspace', 'robertson_dickens_research_module_level.json')
with open(results_file, 'w', encoding='utf-8') as f:
    json.dump(RESEARCH_RESULTS, f, indent=2, ensure_ascii=False)

print(f'\n💾 COMPREHENSIVE RESEARCH RESULTS SAVED TO: {results_file}')

# Final assessment
overall_success = (RESEARCH_RESULTS['analysis_summary']['novel_findings_count'] > 0 or 
                  RESEARCH_RESULTS['analysis_summary']['illustrator_findings_count'] > 0)

if overall_success:
    print('\n✅ RESEARCH MISSION: SUCCESSFUL')
    print('   Found relevant evidence for Robertson novel and/or Dickens illustrator')
    print('   All search results and HTML files saved for further analysis')
else:
    print('\n⚠️ RESEARCH MISSION: PARTIAL SUCCESS')
    print('   Technical search infrastructure working, but may need:')
    print('   • Specialized Victorian literature databases')
    print('   • Library catalog searches (British Library, Cambridge)')
    print('   • Art history databases for illustration research')

print('\n📋 FILES CREATED IN WORKSPACE:')
workspace_files = []
try:
    workspace_files = os.listdir('workspace')
except:
    print('   Error accessing workspace directory')

for filename in workspace_files:
    if filename.startswith(('novel_search_', 'illustrator_search_')) and filename.endswith('.html'):
        print(f'   • {filename} - Raw search results for manual analysis')
    elif filename.endswith('.json'):
        print(f'   • {filename} - Structured research data')

print('\n=== ROBERTSON BROTHERS & DICKENS ILLUSTRATOR RESEARCH COMPLETE ===')
print('All search data preserved for further investigation')
```