### Development Step 40: 2011 Bulgarian Census Tertiary Education Completion Data by Gender

**Description**: Search for the official 2011 Bulgarian census data from the Bulgarian National Statistical Institute (NSI) or other authoritative government sources that specifically contain the tertiary education completion numbers by gender. Focus on finding the exact counts or percentages of men and women who completed tertiary education according to the 2011 census results.

**Use Cases**:
- Gender equality policy development by the Bulgarian Ministry of Education to tailor scholarship programs aimed at reducing male-female disparities in tertiary attainment based on 2011 census figures
- Academic demographic research at Sofia University analyzing 2011 tertiary education completion rates by gender to publish peer-reviewed papers on long-term educational trends in Bulgaria
- European Union social fund grant applications, where NGOs need authoritative 2011 gender-specific tertiary education data to justify funding for women’s empowerment initiatives
- Regional economic planning by municipal authorities in Plovdiv to correlate workforce skill levels with tertiary graduation rates by gender from the 2011 census, optimizing local vocational training programs
- Market entry strategy for a global e-learning platform using gender-disaggregated 2011 tertiary education statistics to identify underserved segments in Bulgaria for targeted course offerings
- Investigative journalism features in Bulgarian national media, leveraging raw 2011 census data on tertiary degrees by gender to expose areas with persistent educational inequalities
- Public health policy studies linking 2011 Bulgarian tertiary education completion data by gender to health literacy outcomes and designing targeted health promotion campaigns
- Data science and AI modeling projects at a research institute that integrate 2011 census tertiary education by gender with economic indicators to predict future labor market skill shortages

```
import os
import json
import requests
from bs4 import BeautifulSoup
import re
import time

workspace_dir = 'workspace'
if not os.path.exists(workspace_dir):
    os.makedirs(workspace_dir)

print("=== SEARCHING FOR 2011 BULGARIAN CENSUS TERTIARY EDUCATION DATA BY GENDER ===")
print("\nObjective: Find official NSI census data on tertiary education completion by gender\n")

# Clear approach: Access official Bulgarian NSI census sources
headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
}

# Official NSI census URLs to search
official_census_urls = [
    'https://www.nsi.bg/census2011/',
    'https://www.nsi.bg/en/content/6704/population-census-2011', 
    'https://www.nsi.bg/en/content/6710/population-education',
    'https://www.nsi.bg/en/statistical-data/151'  # Census section
]

print("=== PHASE 1: ACCESSING OFFICIAL NSI CENSUS SOURCES ===")

successful_downloads = []

for i, url in enumerate(official_census_urls, 1):
    print(f"\n{i}. Accessing: {url}")
    
    try:
        response = requests.get(url, headers=headers, timeout=20)
        print(f"   Response status: {response.status_code}")
        
        if response.status_code == 200:
            print(f"   ✓ Success! Downloaded {len(response.content):,} bytes")
            
            # Save the HTML content
            filename = f"nsi_census_source_{i}.html"
            filepath = os.path.join(workspace_dir, filename)
            
            with open(filepath, 'w', encoding='utf-8') as f:
                f.write(response.text)
            print(f"   Saved as: {filename}")
            
            # Parse content to look for education-related information
            soup = BeautifulSoup(response.content, 'html.parser')
            content_text = soup.get_text().lower()
            
            # Count education and gender related terms
            education_terms = {
                'tertiary': content_text.count('tertiary'),
                'higher_education': content_text.count('higher education'),
                'education': content_text.count('education'),
                'university': content_text.count('university'),
                'degree': content_text.count('degree')
            }
            
            gender_terms = {
                'male': content_text.count('male'),
                'female': content_text.count('female'), 
                'men': content_text.count('men'),
                'women': content_text.count('women'),
                'gender': content_text.count('gender')
            }
            
            census_terms = {
                '2011': content_text.count('2011'),
                'census': content_text.count('census'),
                'population': content_text.count('population')
            }
            
            # Look for downloadable files (Excel, PDF, CSV)
            download_links = []
            for link in soup.find_all('a', href=True):
                href = link.get('href', '')
                link_text = link.get_text().strip()
                
                # Check for data file extensions
                if any(ext in href.lower() for ext in ['.xls', '.xlsx', '.pdf', '.csv']):
                    # Build full URL
                    if href.startswith('http'):
                        full_url = href
                    elif href.startswith('/'):
                        full_url = f"https://www.nsi.bg{href}"
                    else:
                        full_url = f"https://www.nsi.bg/en/{href}"
                    
                    download_links.append({
                        'text': link_text,
                        'url': full_url,
                        'file_type': href.split('.')[-1].lower() if '.' in href else 'unknown'
                    })
            
            print(f"   Education terms found: {sum(education_terms.values())}")
            print(f"   Gender terms found: {sum(gender_terms.values())}")
            print(f"   Census terms found: {sum(census_terms.values())}")
            print(f"   Download links found: {len(download_links)}")
            
            if download_links:
                print(f"   Top download files:")
                for j, dl in enumerate(download_links[:5], 1):
                    print(f"     {j}. {dl['file_type'].upper()}: '{dl['text']}'")
                    print(f"        {dl['url']}")
            
            successful_downloads.append({
                'url': url,
                'filename': filename,
                'content_size': len(response.content),
                'education_terms': education_terms,
                'gender_terms': gender_terms,
                'census_terms': census_terms,
                'download_links': download_links,
                'relevance_score': sum(education_terms.values()) + sum(gender_terms.values()) + sum(census_terms.values())
            })
            
        else:
            print(f"   ✗ Failed with status: {response.status_code}")
            
    except Exception as e:
        print(f"   ✗ Error: {str(e)}")
    
    time.sleep(2)  # Respectful delay

print(f"\n=== PHASE 1 RESULTS ===")
print(f"Successfully downloaded: {len(successful_downloads)} sources")

# Rank sources by relevance
successful_downloads.sort(key=lambda x: x['relevance_score'], reverse=True)

if successful_downloads:
    print("\nSources ranked by relevance to education/gender/census terms:")
    for i, source in enumerate(successful_downloads, 1):
        print(f"\n{i}. {source['filename']} (Score: {source['relevance_score']})")
        print(f"   URL: {source['url']}")
        print(f"   Size: {source['content_size']:,} bytes")
        print(f"   Education terms: {source['education_terms']}")
        print(f"   Gender terms: {source['gender_terms']}")
        print(f"   Download links: {len(source['download_links'])}")
        
        if source['relevance_score'] > 50:
            print(f"   *** HIGH RELEVANCE - PRIORITY FOR ANALYSIS ***")
        elif source['relevance_score'] > 20:
            print(f"   ** MODERATE RELEVANCE **")

print(f"\n=== PHASE 2: ANALYZING TOP SOURCES FOR EDUCATION DATA ===")

# Analyze the most relevant sources for specific education data
top_sources = successful_downloads[:3]  # Top 3 most relevant

for source in top_sources:
    print(f"\n--- Detailed analysis of {source['filename']} ---")
    
    filepath = os.path.join(workspace_dir, source['filename'])
    with open(filepath, 'r', encoding='utf-8') as f:
        html_content = f.read()
    
    soup = BeautifulSoup(html_content, 'html.parser')
    
    # Look for tables that might contain education data
    tables = soup.find_all('table')
    print(f"Tables found: {len(tables)}")
    
    relevant_tables = []
    for j, table in enumerate(tables):
        table_text = table.get_text().lower()
        
        # Check if table contains education AND gender information
        has_education = any(term in table_text for term in ['education', 'tertiary', 'university', 'degree', 'higher'])
        has_gender = any(term in table_text for term in ['male', 'female', 'men', 'women', 'gender'])
        has_census = '2011' in table_text or 'census' in table_text
        
        if has_education and (has_gender or has_census):
            relevant_tables.append({
                'table_index': j,
                'has_education': has_education,
                'has_gender': has_gender,
                'has_census': has_census,
                'sample_text': table_text[:200]
            })
    
    if relevant_tables:
        print(f"Relevant tables found: {len(relevant_tables)}")
        for table_info in relevant_tables:
            print(f"  Table {table_info['table_index']}: Education={table_info['has_education']}, Gender={table_info['has_gender']}, Census={table_info['has_census']}")
            print(f"    Sample: {table_info['sample_text'][:150]}...")
    
    # Look for links to detailed census publications
    education_links = []
    for link in soup.find_all('a', href=True):
        href = link.get('href', '')
        link_text = link.get_text().strip()
        
        # Check if link is related to education or detailed census data
        text_lower = link_text.lower()
        href_lower = href.lower()
        
        education_keywords = ['education', 'tertiary', 'higher', 'university', 'demographic', 'characteristics', 'results', 'data', 'statistics']
        
        is_education_link = any(keyword in text_lower or keyword in href_lower for keyword in education_keywords)
        has_2011 = '2011' in text_lower or '2011' in href_lower
        
        if is_education_link and (has_2011 or 'census' in text_lower):
            # Build full URL
            if href.startswith('http'):
                full_url = href
            elif href.startswith('/'):
                full_url = f"https://www.nsi.bg{href}"
            else:
                full_url = f"https://www.nsi.bg/en/{href}"
            
            education_links.append({
                'text': link_text,
                'url': full_url
            })
    
    if education_links:
        print(f"\nEducation-related links found: {len(education_links)}")
        for k, edu_link in enumerate(education_links[:5], 1):
            print(f"  {k}. '{edu_link['text']}'")
            print(f"     {edu_link['url']}")

# Save comprehensive analysis results
analysis_results = {
    'objective': '2011 Bulgarian Census - Tertiary Education by Gender',
    'search_timestamp': time.strftime('%Y-%m-%d %H:%M:%S'),
    'methodology': 'Direct access to official NSI census sources',
    'sources_accessed': len(official_census_urls),
    'successful_downloads': len(successful_downloads),
    'download_details': successful_downloads,
    'summary': {
        'total_education_terms': sum(sum(s['education_terms'].values()) for s in successful_downloads),
        'total_gender_terms': sum(sum(s['gender_terms'].values()) for s in successful_downloads),
        'total_census_terms': sum(sum(s['census_terms'].values()) for s in successful_downloads),
        'total_download_links': sum(len(s['download_links']) for s in successful_downloads)
    },
    'next_steps': [
        'Parse downloaded HTML files for specific education tables',
        'Access identified download links for detailed census data',
        'Extract tertiary education completion statistics by gender',
        'Verify data source is official 2011 Bulgarian census'
    ]
}

results_file = os.path.join(workspace_dir, 'bulgarian_census_tertiary_education_search_results.json')
with open(results_file, 'w', encoding='utf-8') as f:
    json.dump(analysis_results, f, indent=2, ensure_ascii=False)

print(f"\n=== SEARCH ANALYSIS COMPLETE ===")
print(f"Results saved to: {results_file}")
print(f"\nFiles created:")
for source in successful_downloads:
    print(f"  - {source['filename']} ({source['content_size']:,} bytes)")

print(f"\nNext step: Parse the downloaded census files to extract specific tertiary education completion data by gender from the 2011 Bulgarian census.")
print(f"Focus on sources with highest relevance scores and most download links.")
```