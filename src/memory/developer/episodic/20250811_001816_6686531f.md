### Development Step 3: Extract and Summarize Professorâ€™s Anagram Question from Provided Audio Recording

**Description**: Analyze the attached audio file data/gaia/2023/validation/2b3ef98c-cc05-450b-a719-711aee40ac65.mp3 to extract the professor's anagram question. Listen to the recording to understand what original line or phrase needs to be rearranged into an anagram, and identify the specific request or criteria the professor mentioned for creating the anagram.

**Use Cases**:
- Automated extraction of professor quiz challenges from lecture audio recordings for university learning management systems
- Archiving and indexing of spoken exam questions in educational institutions for compliance and review
- Assisting accessibility teams by converting spoken classroom puzzles into searchable, text-based formats for students with hearing impairments
- Supporting academic integrity investigations by extracting and analyzing unique assessment content from recorded lectures
- Enabling digital humanities researchers to analyze patterns in pedagogical approaches using transcribed and categorized classroom audio data
- Streamlining the creation of study guides by automatically identifying and summarizing key challenges or questions posed in course recordings
- Enhancing online course platforms with searchable databases of instructor questions and challenges extracted from multimedia content
- Automating the generation of quiz content for tutoring services by extracting and reformatting instructor-posed puzzles from class audio files

```
import os
import json

# First, let's inspect the workspace to understand what files we have
print("=== INSPECTING WORKSPACE FOR EXISTING ANALYSIS ===\n")

# Check what files exist in workspace
workspace_dirs = []
if os.path.exists('workspace'):
    for item in os.listdir('workspace'):
        item_path = os.path.join('workspace', item)
        if os.path.isdir(item_path):
            workspace_dirs.append(item_path)
            print(f"Found workspace directory: {item_path}")
            # List files in this directory
            for file in os.listdir(item_path):
                file_path = os.path.join(item_path, file)
                file_size = os.path.getsize(file_path)
                print(f"  - {file} ({file_size} bytes)")
else:
    print("No workspace directory found")

# Look for the analysis files mentioned in the tester feedback
analysis_files = []
for workspace_dir in workspace_dirs:
    for file in os.listdir(workspace_dir):
        if file.endswith('.json') or file.endswith('.txt'):
            analysis_files.append(os.path.join(workspace_dir, file))

print(f"\n=== FOUND {len(analysis_files)} ANALYSIS FILES ===\n")

# Inspect the JSON analysis file first
json_files = [f for f in analysis_files if f.endswith('.json')]
if json_files:
    json_file = json_files[0]
    print(f"Inspecting JSON analysis file: {json_file}")
    
    # Load and inspect the structure
    with open(json_file, 'r', encoding='utf-8') as f:
        analysis_data = json.load(f)
    
    print(f"JSON file keys: {list(analysis_data.keys())}")
    
    # Display the structure safely
    for key, value in analysis_data.items():
        if isinstance(value, str):
            print(f"  {key}: <string of length {len(value)}>")
            if key == 'transcription':
                print(f"    Preview: {value[:100]}...")
        elif isinstance(value, list):
            print(f"  {key}: <list with {len(value)} items>")
            if value:
                print(f"    First item type: {type(value[0])}")
                if isinstance(value[0], dict):
                    print(f"    First item keys: {list(value[0].keys())}")
        elif isinstance(value, dict):
            print(f"  {key}: <dict with keys: {list(value.keys())}>")
        else:
            print(f"  {key}: {value}")

# Now let's examine the transcription and extract the anagram phrase
if json_files:
    print(f"\n=== ANALYZING TRANSCRIPTION FOR ANAGRAM PHRASE ===\n")
    
    transcription = analysis_data.get('transcription', '')
    print(f"Full transcription ({len(transcription)} chars):")
    print(f'"{transcription}"')
    
    print(f"\n=== EXTRACTING THE ANAGRAM PHRASE ===\n")
    
    # Based on the tester feedback, the anagram phrase is:
    # "in one of The Bard's best thought of tragedies are insistent hero Hamlet queries on two fronts about how life turns rotten"
    
    # Let's find this phrase in the transcription
    # Look for the part that starts with "here's the anagram"
    anagram_start_phrase = "here's the anagram"
    anagram_start_pos = transcription.lower().find(anagram_start_phrase)
    
    if anagram_start_pos != -1:
        print(f"Found 'here's the anagram' at position {anagram_start_pos}")
        
        # Extract everything after "here's the anagram"
        anagram_part = transcription[anagram_start_pos + len(anagram_start_phrase):].strip()
        print(f"Text after 'here's the anagram': '{anagram_part}'")
        
        # The anagram phrase should be the rest of the sentence
        anagram_phrase = anagram_part
        
    else:
        print("Could not find 'here's the anagram' in transcription")
        # Let's try to identify it manually by looking at the structure
        print("\nManual analysis of transcription structure:")
        
        # Split into sentences or logical parts
        parts = transcription.split('.')
        for i, part in enumerate(parts):
            part = part.strip()
            if part:
                print(f"Part {i+1}: '{part}'")
        
        # Based on the tester feedback, let's extract the known anagram phrase
        anagram_phrase = "in one of The Bard's best thought of tragedies are insistent hero Hamlet queries on two fronts about how life turns rotten"
        print(f"\nBased on tester feedback, the anagram phrase is:")
        print(f"'{anagram_phrase}'")
    
    print(f"\n=== ANAGRAM ANALYSIS ===\n")
    
    # Clean up the anagram phrase
    if 'anagram_phrase' in locals():
        # Remove any leading/trailing whitespace and normalize
        clean_anagram = anagram_phrase.strip()
        
        print(f"Anagram to solve: '{clean_anagram}'")
        print(f"Length: {len(clean_anagram)} characters")
        
        # Count letters (ignoring spaces and punctuation)
        letters_only = ''.join(c.lower() for c in clean_anagram if c.isalpha())
        print(f"Letters only: '{letters_only}'")
        print(f"Letter count: {len(letters_only)}")
        
        # Count each letter
        from collections import Counter
        letter_counts = Counter(letters_only)
        print(f"Letter frequency: {dict(sorted(letter_counts.items()))}")
        
        print(f"\n=== CONTEXT FROM TRANSCRIPTION ===\n")
        print("The professor says this anagram is from 'one of The Bard's most well-known lines'")
        print("It's from 'one of The Bard's best thought of tragedies' - referring to Shakespeare's Hamlet")
        print("The student who provides the original line gets 'an automatic a on next week's quiz'")
        
        # Save the extracted anagram information
        anagram_analysis = {
            'source_audio': analysis_data.get('source_file', 'unknown'),
            'full_transcription': transcription,
            'anagram_phrase': clean_anagram,
            'anagram_letters_only': letters_only,
            'letter_count': len(letters_only),
            'letter_frequency': dict(letter_counts),
            'context': {
                'source': 'Shakespeare (The Bard)',
                'work': 'Hamlet (one of his best thought of tragedies)',
                'description': 'one of his most well-known lines',
                'reward': 'automatic A on next week\'s quiz'
            },
            'task': 'Find the original Shakespeare line that this anagram represents'
        }
        
        # Save the anagram analysis
        output_file = 'workspace/anagram_phrase_extracted.json'
        with open(output_file, 'w', encoding='utf-8') as f:
            json.dump(anagram_analysis, f, indent=2)
        
        print(f"\n=== RESULTS SAVED ===\n")
        print(f"Anagram analysis saved to: {output_file}")
        
        # Create a summary file
        summary_file = 'workspace/anagram_challenge_summary.txt'
        with open(summary_file, 'w', encoding='utf-8') as f:
            f.write("PROFESSOR'S ANAGRAM CHALLENGE - EXTRACTED INFORMATION\n")
            f.write("=" * 60 + "\n\n")
            f.write(f"Source: {analysis_data.get('source_file', 'Audio file')}\n\n")
            f.write("CHALLENGE DESCRIPTION:\n")
            f.write("- Find the original Shakespeare line that this anagram represents\n")
            f.write("- The line is from Hamlet (one of Shakespeare's best-known tragedies)\n")
            f.write("- It's described as 'one of The Bard's most well-known lines'\n")
            f.write("- Reward: Automatic A on next week's quiz\n\n")
            f.write("ANAGRAM TO SOLVE:\n")
            f.write(f"'{clean_anagram}'\n\n")
            f.write(f"LETTER ANALYSIS:\n")
            f.write(f"- Total characters: {len(clean_anagram)}\n")
            f.write(f"- Letters only: {len(letters_only)}\n")
            f.write(f"- Letters: {letters_only}\n")
            f.write(f"- Letter frequency: {dict(sorted(letter_counts.items()))}\n\n")
            f.write("FULL TRANSCRIPTION:\n")
            f.write("-" * 30 + "\n")
            f.write(transcription)
            f.write("\n" + "-" * 30 + "\n\n")
            f.write("NEXT STEP:\n")
            f.write("Rearrange the letters in the anagram to find the famous Hamlet quote.\n")
        
        print(f"Challenge summary saved to: {summary_file}")
        
        print(f"\n=== EXTRACTION COMPLETE ===\n")
        print(f"Successfully extracted the anagram challenge:")
        print(f"ANAGRAM: '{clean_anagram}'")
        print(f"TASK: Find the original Shakespeare line from Hamlet")
        print(f"CONTEXT: One of The Bard's most well-known lines")
        
else:
    print("No JSON analysis file found to process")

print("\n*** ANAGRAM PHRASE EXTRACTION COMPLETE ***")
```