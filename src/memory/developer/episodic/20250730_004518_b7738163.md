### Development Step 2: Seahorse Island Full-House Rentals With Swimming Amenities, Family-Friendly Features, and Availability Status

**Description**: Parse and analyze the attached PDF file data/gaia/2023/validation/366e2f2b-8632-4ef2-81eb-bc3877489217.pdf to extract information about all accommodations in Seahorse Island. Focus on identifying properties that offer full house rentals and have swimming amenities (pools, beach access, or water features). Extract details including accommodation names, property types, amenities, availability status, and any family-friendly features to enable comparison of options suitable for a family seeking a full house with swimming facilities.

**Use Cases**:
- Travel agency itinerary automation by parsing PDF catalogs of Seahorse Island lodgings to curate full-house rentals with pools and beach access for family vacation packages
- Vacation rental aggregator platform extracting detailed amenities and availability from island property PDF reports to dynamically update swim-friendly listings for parents planning trips
- Real estate investment analysis tool processing PDF accommodation data to evaluate full-house rentals with water features for ROI projections and portfolio diversification
- Local tourism board content management system summarizing PDF accommodation brochures to highlight family-oriented swim-enabled properties on official island visitor websites
- Property management CRM integration that ingests PDF booking and amenity details to automatically recommend available family-friendly houses with pools to repeat guests
- Hospitality market research solution scanning competitor PDF listings to identify gaps in full-house swim amenity offerings on Seahorse Island for strategic service expansion
- Insurance underwriting pre-screening process parsing PDF descriptions of rental houses with water features to assess property risk and streamline quote generation for seasonal policies

```
import os
import json
import pandas as pd
import re

print("=== STRUCTURED ANALYSIS OF SEAHORSE ISLAND ACCOMMODATIONS ===")
print("Parsing extracted PDF content to identify full house rentals with swimming amenities...")

# First, let's inspect the workspace files to understand what we have
workspace_files = []
for root, dirs, files in os.walk('workspace'):
    for file in files:
        file_path = os.path.join(root, file)
        workspace_files.append(file_path)
        print(f"Found workspace file: {file_path}")

# Load the raw content
raw_content_path = None
for file_path in workspace_files:
    if 'seahorse_island_accommodations_raw.txt' in file_path:
        raw_content_path = file_path
        break

if raw_content_path and os.path.exists(raw_content_path):
    print(f"\nLoading raw content from: {raw_content_path}")
    with open(raw_content_path, 'r', encoding='utf-8') as f:
        raw_content = f.read()
else:
    # Use the content from the history if file not found
    print("\nUsing raw content from PDF extraction...")
    raw_content = """Name Rating (out of 5)Vacancy Pool Sample Review
Hotels
Neptune's Palace 5 Yes Yes A hotel fit for a king.
Admiral Sturgeon 5 No Yes The breakfast was wonderful. The price was not.
Currents 4 Yes Yes The staff was helpful and accomodating.
The Laughing Gull 3 No Yes Great proximity to the beach.
Loach Towers 2 Yes No Good view of the water.
Motels
Sea Escape Inn 5 Yes Yes Don't let the "motel" look scare you. This place made for a clean and comfortable vacation.
Wash Inn 3 No Yes It was nice that they had laundry machines for guests.
Boulevard Motel 2 Yes No Real close to the gas station.
Good Motel 1 Yes No Name is false advertising.
Sea Larva Motel 0 Yes Yes Name is true advertising.
Rental Houses
Cape Super 4 No No The owner was very nice. A pleasure to talk to.
Bleek Island 3 No No We got a personalized box of chocolates upon our arrival. How sweet!
Pinedrift Avenue 4 Yes No This would be a good place if it wasn't an hour away from everything.
Ocean and Main 5 No Yes The location is great, if you don't mind the noise.
4th Street Cottage 5 No No The board games in the living room were nice to have.
Shelley's Place 4 Yes Yes The floorboards creaked too loud! Made it hard to walk and sleep at the same time.
Creakwood Creek 3 No Yes Tried fishing in the creek but nothing was biting.
Headrush Beach 3 No No The accomodations are rough, but the private beach is amazing.
Shiplap Cabin 3 Yes No Pretty sure this place is haunted.
Haddonfield House 1 Yes No The kitchen made it easy to prepare our own meals during our stay.
Campgrounds
The Glampground 4 Yes Yes Has the most Ultra HD TVs out of any campground I've been to.
Gull Crest 5 Yes Yes A bird defecated on our tent... never going back.
Barnacle Isle 3 No No Hard to bring our RV here when the only access to the island is by boat.
Cozy Wood 4 Yes Yes Not the most secluded, but clean and comfortable.
Gravel Lot Campground 1 Yes No No water or electric hookups for our camper... talk about "roughing it"."""

print(f"Content length: {len(raw_content)} characters")

# Parse the structured data from the table
print("\n=== PARSING ACCOMMODATION DATA ===")

# Split content into lines and identify sections
lines = raw_content.strip().split('\n')
print(f"Total lines to parse: {len(lines)}")

# Parse the data structure
accommodations = []
current_category = ""

for i, line in enumerate(lines):
    print(f"Processing line {i}: '{line}'")
    
    # Skip the header line
    if "Name Rating" in line and "Vacancy" in line and "Pool" in line:
        print("  -> Header line, skipping")
        continue
    
    # Identify category headers
    if line.strip() in ['Hotels', 'Motels', 'Rental Houses', 'Campgrounds']:
        current_category = line.strip()
        print(f"  -> Category: {current_category}")
        continue
    
    # Skip empty lines
    if not line.strip():
        print("  -> Empty line, skipping")
        continue
    
    # Parse accommodation data lines
    if current_category and line.strip():
        # Split the line into components
        # Pattern: Name Rating Vacancy Pool Review
        
        # Use regex to parse the structured format
        # Looking for: Name (words) Rating (number) Vacancy (Yes/No) Pool (Yes/No) Review (rest)
        
        # Find the rating (number 0-5)
        rating_match = re.search(r'\b[0-5]\b', line)
        if rating_match:
            rating_pos = rating_match.start()
            rating = int(rating_match.group())
            
            # Extract name (everything before rating)
            name = line[:rating_pos].strip()
            
            # Extract the part after rating
            after_rating = line[rating_match.end():].strip()
            
            # The next two words should be vacancy and pool status
            parts = after_rating.split()
            if len(parts) >= 2:
                vacancy = parts[0]
                pool = parts[1]
                
                # The rest is the review
                review = ' '.join(parts[2:]) if len(parts) > 2 else ""
                
                accommodation = {
                    'name': name,
                    'category': current_category,
                    'rating': rating,
                    'vacancy': vacancy,
                    'pool': pool,
                    'review': review
                }
                
                accommodations.append(accommodation)
                print(f"  -> Parsed: {accommodation}")
            else:
                print(f"  -> Could not parse line properly: insufficient parts after rating")
        else:
            print(f"  -> Could not find rating in line")

print(f"\nSuccessfully parsed {len(accommodations)} accommodations")

# Display all parsed accommodations
print("\n=== ALL PARSED ACCOMMODATIONS ===")
for i, acc in enumerate(accommodations, 1):
    print(f"{i}. {acc['name']} ({acc['category']})")
    print(f"   Rating: {acc['rating']}/5, Vacancy: {acc['vacancy']}, Pool: {acc['pool']}")
    print(f"   Review: {acc['review']}")
    print()

# Focus on Rental Houses as requested for full house rentals
print("\n=== RENTAL HOUSES ANALYSIS ===")
rental_houses = [acc for acc in accommodations if acc['category'] == 'Rental Houses']
print(f"Found {len(rental_houses)} rental houses:")

for house in rental_houses:
    print(f"\n- {house['name']}")
    print(f"  Rating: {house['rating']}/5")
    print(f"  Vacancy: {house['vacancy']}")
    print(f"  Pool: {house['pool']}")
    print(f"  Review: {house['review']}")

# Identify houses with swimming amenities (pool or beach access)
print("\n" + "="*70)
print("RENTAL HOUSES WITH SWIMMING AMENITIES (POOL OR BEACH ACCESS)")
print("="*70)

swimming_houses = []
for house in rental_houses:
    has_pool = house['pool'].lower() == 'yes'
    has_beach_access = 'beach' in house['review'].lower()
    has_water_access = 'water' in house['review'].lower() or 'creek' in house['review'].lower()
    
    if has_pool or has_beach_access or has_water_access:
        swimming_info = []
        if has_pool:
            swimming_info.append('Pool')
        if has_beach_access:
            swimming_info.append('Beach Access')
        if has_water_access and not has_beach_access:
            swimming_info.append('Water Access')
        
        house['swimming_amenities'] = swimming_info
        swimming_houses.append(house)

print(f"Found {len(swimming_houses)} rental houses with swimming amenities:")

for i, house in enumerate(swimming_houses, 1):
    print(f"\n{i}. {house['name']}")
    print(f"   Rating: {house['rating']}/5 stars")
    print(f"   Availability: {'Available' if house['vacancy'].lower() == 'yes' else 'Not Available'}")
    print(f"   Swimming Amenities: {', '.join(house['swimming_amenities'])}")
    print(f"   Guest Review: {house['review']}")
    
    # Analyze family-friendliness from review content
    family_indicators = []
    review_lower = house['review'].lower()
    
    if 'kitchen' in review_lower:
        family_indicators.append('Kitchen facilities for family meals')
    if 'living room' in review_lower or 'board games' in review_lower:
        family_indicators.append('Family entertainment options')
    if 'private' in review_lower:
        family_indicators.append('Privacy for families')
    if 'clean' in review_lower or 'comfortable' in review_lower:
        family_indicators.append('Clean and comfortable environment')
    
    if family_indicators:
        print(f"   Family-Friendly Features: {', '.join(family_indicators)}")
    
    # Note any potential concerns
    concerns = []
    if 'noise' in review_lower:
        concerns.append('Potential noise issues')
    if 'creaked' in review_lower or 'haunted' in review_lower:
        concerns.append('Property condition concerns')
    if 'rough' in review_lower:
        concerns.append('Basic accommodations')
    
    if concerns:
        print(f"   ‚ö†Ô∏è Considerations: {', '.join(concerns)}")

# Create final recommendation summary
print("\n" + "="*70)
print("FAMILY RECOMMENDATION SUMMARY - FULL HOUSES WITH SWIMMING")
print("="*70)

# Sort by rating and availability
available_swimming_houses = [h for h in swimming_houses if h['vacancy'].lower() == 'yes']
unavailable_swimming_houses = [h for h in swimming_houses if h['vacancy'].lower() != 'yes']

print(f"\nüèä AVAILABLE OPTIONS ({len(available_swimming_houses)} properties):")
available_swimming_houses.sort(key=lambda x: x['rating'], reverse=True)

for i, house in enumerate(available_swimming_houses, 1):
    amenities = ', '.join(house['swimming_amenities'])
    print(f"\n{i}. ‚≠ê {house['name']} - {house['rating']}/5 stars")
    print(f"   üèä Swimming: {amenities}")
    print(f"   üí≠ Review: {house['review']}")

if unavailable_swimming_houses:
    print(f"\n‚ùå CURRENTLY UNAVAILABLE ({len(unavailable_swimming_houses)} properties):")
    unavailable_swimming_houses.sort(key=lambda x: x['rating'], reverse=True)
    
    for i, house in enumerate(unavailable_swimming_houses, 1):
        amenities = ', '.join(house['swimming_amenities'])
        print(f"\n{i}. {house['name']} - {house['rating']}/5 stars (No Vacancy)")
        print(f"   üèä Swimming: {amenities}")
        print(f"   üí≠ Review: {house['review']}")

# Save structured data
structured_data = {
    'total_accommodations': len(accommodations),
    'rental_houses_total': len(rental_houses),
    'rental_houses_with_swimming': len(swimming_houses),
    'available_with_swimming': len(available_swimming_houses),
    'all_accommodations': accommodations,
    'rental_houses': rental_houses,
    'swimming_amenity_houses': swimming_houses,
    'available_swimming_houses': available_swimming_houses,
    'analysis_focus': 'Full house rentals with swimming amenities for families'
}

with open('workspace/seahorse_island_structured_analysis.json', 'w', encoding='utf-8') as f:
    json.dump(structured_data, f, indent=2, ensure_ascii=False)

# Create a family-friendly summary report
summary_report = f"""SEAHORSE ISLAND FAMILY ACCOMMODATION REPORT
{'='*50}

FOCUS: Full House Rentals with Swimming Amenities

TOTAL RENTAL HOUSES: {len(rental_houses)}
HOUSES WITH SWIMMING AMENITIES: {len(swimming_houses)}
AVAILABLE WITH SWIMMING: {len(available_swimming_houses)}

AVAILABLE RECOMMENDATIONS:
{'-'*30}
"""

for i, house in enumerate(available_swimming_houses, 1):
    summary_report += f"""
{i}. {house['name']} ({house['rating']}/5 stars)
   Swimming: {', '.join(house['swimming_amenities'])}
   Review: {house['review']}
"""

with open('workspace/family_swimming_house_recommendations.txt', 'w', encoding='utf-8') as f:
    f.write(summary_report)

print(f"\nStructured analysis saved to: workspace/seahorse_island_structured_analysis.json")
print(f"Family recommendations saved to: workspace/family_swimming_house_recommendations.txt")
print("\n=== ANALYSIS COMPLETE ===")
```