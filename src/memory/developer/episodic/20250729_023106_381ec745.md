### Development Step 1: Parse PPTX and Extract Text, Count Slides, Search for Crustacean Mentions

**Description**: Parse and analyze the attached PowerPoint presentation file data/gaia/2023/validation/a3fbeb63-0e8c-4a11-bff6-0e3b484c3e9c.pptx to extract text content from all slides. Identify the total number of slides in the presentation and systematically search through each slide's content for any mentions of crustaceans or related terms such as 'crab', 'lobster', 'shrimp', 'crayfish', 'barnacle', and other crustacean-related vocabulary.

**Use Cases**:
- Marine biology conference presentation scanning to extract and quantify mentions of specific crustacean taxa (e.g., krill, amphipods) for large-scale biodiversity meta-analyses
- Seafood processing plant safety-training deck auditing to automatically flag slides that mention shrimp or lobster handling without proper hazard controls
- Hospitality and restaurant allergen compliance verification by scanning internal PPT menus for any shellfish (crab, prawns, barnacles) references and ensuring allergen disclaimers are present
- Environmental NGO report review to identify and categorize presentations discussing crustacean aquaculture practices and their ecological impacts on coastal ecosystems
- Academic curriculum quality control in marine science departments by validating that lecture slides cover mandatory crustacean groups (decapods, isopods, copepods) according to accreditation standards
- Culinary marketing competitive analysis by mining investor pitch decks and slide decks for mentions of lobster-based dishes or shrimp specialities to inform product development strategies
- Seafood supply chain traceability auditing through automated detection of crustacean mentions in logistics and vendor training presentations to ensure regulatory documentation completeness
- Digital marine science library indexing by tagging and organizing PowerPoint collections based on extracted crustacean-related keywords for improved search and retrieval of species-specific research materials

```
import os
import html
import tempfile
import base64
import pptx
import re

# The path to the PowerPoint file to be parsed
pptx_path = "data/gaia/2023/validation/a3fbeb63-0e8c-4a11-bff6-0e3b484c3e9c.pptx"

print("=== POWERPOINT PRESENTATION ANALYSIS ===")
print(f"Analyzing file: {pptx_path}")

# Check if file exists
if not os.path.exists(pptx_path):
    print(f"Error: PowerPoint file '{pptx_path}' does not exist.")
else:
    print(f"File exists: {pptx_path}")
    file_size = os.path.getsize(pptx_path)
    print(f"File size: {file_size} bytes")

# Parse PowerPoint presentation using python-pptx
print("\nLoading PowerPoint presentation...")
presentation = pptx.Presentation(pptx_path)

total_slides = len(presentation.slides)
print(f"Total number of slides: {total_slides}")

# Define crustacean-related terms to search for
crustacean_terms = [
    'crustacean', 'crustaceans',
    'crab', 'crabs',
    'lobster', 'lobsters', 
    'shrimp', 'shrimps', 'prawn', 'prawns',
    'crayfish', 'crawfish',
    'barnacle', 'barnacles',
    'krill',
    'copepod', 'copepods',
    'amphipod', 'amphipods',
    'isopod', 'isopods',
    'decapod', 'decapods',
    'arthropod', 'arthropods'
]

print(f"\nSearching for crustacean terms: {crustacean_terms}")

# Extract content from all slides
all_slide_content = []
crustacean_mentions = []

print("\n=== SLIDE-BY-SLIDE ANALYSIS ===\n")

for slide_num, slide in enumerate(presentation.slides, 1):
    print(f"--- SLIDE {slide_num} ---")
    
    slide_text_content = []
    slide_crustacean_found = []
    
    # Extract text from all text shapes on the slide
    for shape in slide.shapes:
        if shape.has_text_frame and shape.text.strip():
            shape_text = shape.text.strip()
            slide_text_content.append(shape_text)
            print(f"Text found: {shape_text}")
            
            # Search for crustacean terms in this text (case-insensitive)
            text_lower = shape_text.lower()
            for term in crustacean_terms:
                if term in text_lower:
                    # Find all occurrences with context
                    pattern = r'\b' + re.escape(term) + r'\b'
                    matches = re.finditer(pattern, text_lower)
                    for match in matches:
                        # Get some context around the match
                        start = max(0, match.start() - 20)
                        end = min(len(shape_text), match.end() + 20)
                        context = shape_text[start:end].strip()
                        
                        crustacean_mention = {
                            'slide_number': slide_num,
                            'term': term,
                            'context': context,
                            'full_text': shape_text
                        }
                        slide_crustacean_found.append(crustacean_mention)
                        crustacean_mentions.append(crustacean_mention)
                        print(f"  *** CRUSTACEAN TERM FOUND: '{term}' in context: '{context}'")
    
    # Check slide notes if available
    if slide.has_notes_slide:
        notes_frame = slide.notes_slide.notes_text_frame
        if notes_frame is not None and notes_frame.text.strip():
            notes_text = notes_frame.text.strip()
            slide_text_content.append(f"[NOTES: {notes_text}]")
            print(f"Notes found: {notes_text}")
            
            # Search for crustacean terms in notes
            notes_lower = notes_text.lower()
            for term in crustacean_terms:
                if term in notes_lower:
                    pattern = r'\b' + re.escape(term) + r'\b'
                    matches = re.finditer(pattern, notes_lower)
                    for match in matches:
                        start = max(0, match.start() - 20)
                        end = min(len(notes_text), match.end() + 20)
                        context = notes_text[start:end].strip()
                        
                        crustacean_mention = {
                            'slide_number': slide_num,
                            'term': term,
                            'context': context,
                            'full_text': f"[NOTES: {notes_text}]",
                            'location': 'notes'
                        }
                        slide_crustacean_found.append(crustacean_mention)
                        crustacean_mentions.append(crustacean_mention)
                        print(f"  *** CRUSTACEAN TERM FOUND IN NOTES: '{term}' in context: '{context}'")
    
    # Store slide content
    slide_data = {
        'slide_number': slide_num,
        'text_content': slide_text_content,
        'crustacean_mentions': slide_crustacean_found
    }
    all_slide_content.append(slide_data)
    
    if not slide_text_content:
        print("No text content found on this slide")
    
    print(f"Crustacean mentions on this slide: {len(slide_crustacean_found)}\n")

# Summary analysis
print("=" * 60)
print("ANALYSIS SUMMARY")
print("=" * 60)

print(f"\nPresentation file: {os.path.basename(pptx_path)}")
print(f"Total slides analyzed: {total_slides}")
print(f"Total crustacean mentions found: {len(crustacean_mentions)}")

if crustacean_mentions:
    print("\n=== DETAILED CRUSTACEAN MENTIONS ===\n")
    
    # Group mentions by slide
    slides_with_crustaceans = {}
    for mention in crustacean_mentions:
        slide_num = mention['slide_number']
        if slide_num not in slides_with_crustaceans:
            slides_with_crustaceans[slide_num] = []
        slides_with_crustaceans[slide_num].append(mention)
    
    for slide_num in sorted(slides_with_crustaceans.keys()):
        mentions = slides_with_crustaceans[slide_num]
        print(f"SLIDE {slide_num}: {len(mentions)} mention(s)")
        for i, mention in enumerate(mentions, 1):
            location = mention.get('location', 'slide content')
            print(f"  {i}. Term: '{mention['term']}' (in {location})")
            print(f"     Context: \"{mention['context']}\"")
            print(f"     Full text: \"{mention['full_text'][:100]}{'...' if len(mention['full_text']) > 100 else ''}\"")
        print()
    
    # Count unique terms found
    unique_terms_found = set(mention['term'] for mention in crustacean_mentions)
    print(f"Unique crustacean terms found: {sorted(unique_terms_found)}")
    
    # Count mentions per term
    term_counts = {}
    for mention in crustacean_mentions:
        term = mention['term']
        term_counts[term] = term_counts.get(term, 0) + 1
    
    print("\nTerm frequency:")
    for term, count in sorted(term_counts.items()):
        print(f"  '{term}': {count} occurrence(s)")

else:
    print("\n*** NO CRUSTACEAN MENTIONS FOUND ***")
    print("The presentation does not contain any of the searched crustacean terms.")

# Save complete analysis to workspace
analysis_results = {
    'file_info': {
        'filename': os.path.basename(pptx_path),
        'file_size': file_size,
        'total_slides': total_slides
    },
    'search_terms': crustacean_terms,
    'slide_content': all_slide_content,
    'crustacean_mentions': crustacean_mentions,
    'summary': {
        'total_mentions': len(crustacean_mentions),
        'slides_with_mentions': len(set(mention['slide_number'] for mention in crustacean_mentions)),
        'unique_terms_found': list(set(mention['term'] for mention in crustacean_mentions))
    }
}

with open('workspace/powerpoint_crustacean_analysis.json', 'w') as f:
    import json
    json.dump(analysis_results, f, indent=2)

print(f"\nComplete analysis saved to: workspace/powerpoint_crustacean_analysis.json")

# Also create a readable text summary
with open('workspace/crustacean_search_summary.txt', 'w') as f:
    f.write(f"POWERPOINT CRUSTACEAN ANALYSIS SUMMARY\n")
    f.write(f"{'='*50}\n\n")
    f.write(f"File: {os.path.basename(pptx_path)}\n")
    f.write(f"Total slides: {total_slides}\n")
    f.write(f"Total crustacean mentions: {len(crustacean_mentions)}\n\n")
    
    if crustacean_mentions:
        f.write("CRUSTACEAN MENTIONS FOUND:\n")
        f.write("-" * 30 + "\n")
        for mention in crustacean_mentions:
            f.write(f"Slide {mention['slide_number']}: '{mention['term']}' - {mention['context']}\n")
    else:
        f.write("NO CRUSTACEAN MENTIONS FOUND\n")
        f.write("The presentation does not contain any crustacean-related terms.\n")

print(f"Text summary saved to: workspace/crustacean_search_summary.txt")

print("\n*** ANALYSIS COMPLETE ***")
if crustacean_mentions:
    print(f"RESULT: Found {len(crustacean_mentions)} crustacean mention(s) across {len(set(mention['slide_number'] for mention in crustacean_mentions))} slide(s)")
else:
    print("RESULT: No crustacean mentions found in the presentation")
```