### Development Step 39: 2011 Bulgarian NSI Census: Tertiary Education Completion by Gender – Counts and Percentages

**Description**: Search for the official 2011 Bulgarian census data from the Bulgarian National Statistical Institute (NSI) or other authoritative government sources that specifically contain the tertiary education completion numbers by gender. Focus on finding the exact counts or percentages of men and women who completed tertiary education according to the 2011 census results.

**Use Cases**:
- Government education policy planning and gender gap analysis: Using the 2011 tertiary completion figures by men and women to adjust funding and scholarship programs targeting underrepresented groups
- University admissions forecasting and equity program evaluation: Leveraging historical gender breakdowns in higher education to predict enrollment trends and measure outreach initiatives’ effectiveness
- Non-profit advocacy reporting on gender disparities: Extracting census data to support NGO reports and campaigns aimed at closing the tertiary education gap between men and women
- Educational publishing market research: Analyzing regional and gender-specific tertiary attainment rates to tailor textbook and e-learning product development for under-served cohorts
- Academic demographic studies for comparative research: Incorporating Bulgarian 2011 census tertiary completion numbers by gender into cross-national analyses of higher education trends in Eastern Europe
- Media fact-checking and infographic creation: Sourcing official census tables on male versus female tertiary graduates to produce accurate visual stories for news outlets and blogs
- Urban planning and resource allocation: Mapping district-level tertiary education completion rates by gender to guide local authorities in placing vocational centers and adult learning programs

```
import os
import json
from bs4 import BeautifulSoup
import re
import time
import requests

workspace_dir = 'workspace'

print("=== SEARCHING FOR OFFICIAL 2011 BULGARIAN CENSUS TERTIARY EDUCATION DATA BY GENDER ===")
print("\nObjective: Find exact counts/percentages of men and women who completed tertiary education in 2011 Bulgarian census\n")

# Let's start with a direct approach - search for official NSI census publications
print("=== PHASE 1: DIRECT SEARCH FOR 2011 CENSUS EDUCATION PUBLICATIONS ===")

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
}

# Try to access the main 2011 census page directly
census_2011_urls = [
    'https://www.nsi.bg/census2011/',
    'https://www.nsi.bg/en/content/6704/population-census-2011',
    'https://www.nsi.bg/en/content/6710/population-education',
    'https://www.nsi.bg/en/statistical-data/151'  # Census data section
]

successful_sources = []

for i, url in enumerate(census_2011_urls, 1):
    print(f"{i}. Accessing: {url}")
    
    try:
        response = requests.get(url, headers=headers, timeout=15)
        print(f"   Status: {response.status_code}")
        
        if response.status_code == 200:
            print(f"   ✓ Success! Content length: {len(response.content):,} bytes")
            
            # Save the content
            filename = f"census_2011_source_{i}.html"
            filepath = os.path.join(workspace_dir, filename)
            
            with open(filepath, 'w', encoding='utf-8') as f:
                f.write(response.text)
            print(f"   HTML file saved: {filename}")
            
            # Quick analysis for relevant content
            soup = BeautifulSoup(response.content, 'html.parser')
            content_text = soup.get_text().lower()
            
            # Look for education and gender indicators
            education_indicators = {
                'tertiary': content_text.count('tertiary'),
                'higher_education': content_text.count('higher education'),
                'university': content_text.count('university'),
                'education': content_text.count('education'),
                'male': content_text.count('male'),
                'female': content_text.count('female'),
                'gender': content_text.count('gender'),
                'men': content_text.count('men'),
                'women': content_text.count('women')
            }
            
            relevant_indicators = {k: v for k, v in education_indicators.items() if v > 0}
            if relevant_indicators:
                print(f"   Education/gender indicators: {relevant_indicators}")
            
            # Look for downloadable files (Excel, PDF)
            download_links = []
            for link in soup.find_all('a', href=True):
                href = link.get('href', '')
                text = link.get_text().strip()
                
                if any(ext in href.lower() for ext in ['.xls', '.xlsx', '.pdf', '.csv']):
                    # Construct full URL
                    if href.startswith('http'):
                        full_url = href
                    elif href.startswith('/'):
                        full_url = f"https://www.nsi.bg{href}"
                    else:
                        full_url = f"https://www.nsi.bg/en/{href}"
                    
                    download_links.append({
                        'text': text,
                        'url': full_url,
                        'type': href.split('.')[-1].lower() if '.' in href else 'unknown'
                    })
            
            if download_links:
                print(f"   Download links found: {len(download_links)}")
                for j, dl in enumerate(download_links[:5], 1):
                    print(f"     {j}. {dl['type'].upper()}: '{dl['text']}' -> {dl['url']}")
            
            successful_sources.append({
                'url': url,
                'filename': filename,
                'content_size': len(response.content),
                'education_indicators': relevant_indicators,
                'download_links': download_links
            })
            
        else:
            print(f"   ✗ Failed - Status: {response.status_code}")
            
    except Exception as e:
        print(f"   ✗ Error: {str(e)}")
    
    time.sleep(2)  # Be respectful to the server

print(f"\n=== PHASE 1 RESULTS ===")
print(f"Successfully accessed: {len(successful_sources)} census sources")

# Now let's look for specific census publications or data tables
print(f"\n=== PHASE 2: SEARCHING FOR SPECIFIC CENSUS EDUCATION TABLES ===")

# Search for common census publication patterns
search_patterns = [
    'education level',
    'educational attainment',
    'tertiary education',
    'higher education',
    'population by education',
    'education and gender',
    'demographic characteristics',
    'census results education'
]

for source in successful_sources:
    print(f"\n--- Analyzing {source['filename']} for education data ---")
    
    filepath = os.path.join(workspace_dir, source['filename'])
    with open(filepath, 'r', encoding='utf-8') as f:
        html_content = f.read()
    
    soup = BeautifulSoup(html_content, 'html.parser')
    
    # Look for links that might contain education statistics
    education_links = []
    for link in soup.find_all('a', href=True):
        href = link.get('href', '')
        text = link.get_text().strip()
        
        # Check if link text or href contains education-related terms
        text_lower = text.lower()
        href_lower = href.lower()
        
        is_education_related = False
        for pattern in search_patterns:
            if pattern in text_lower or pattern in href_lower:
                is_education_related = True
                break
        
        # Also check for general census results or statistical data
        if not is_education_related:
            general_terms = ['results', 'data', 'statistics', 'tables', 'publication', 'report']
            if any(term in text_lower for term in general_terms) and ('2011' in text_lower or '2011' in href_lower):
                is_education_related = True
        
        if is_education_related:
            # Construct full URL
            if href.startswith('http'):
                full_url = href
            elif href.startswith('/'):
                full_url = f"https://www.nsi.bg{href}"
            else:
                full_url = f"https://www.nsi.bg/en/{href}"
            
            education_links.append({
                'text': text,
                'href': href,
                'full_url': full_url
            })
    
    if education_links:
        print(f"Found {len(education_links)} education-related links:")
        for i, link in enumerate(education_links[:8], 1):
            print(f"  {i}. '{link['text']}'")
            print(f"     {link['full_url']}")
        
        # Try to access the most promising education links
        print(f"\n--- Accessing top education links from {source['filename']} ---")
        
        for i, link in enumerate(education_links[:3], 1):
            print(f"\nTrying education link {i}: {link['full_url']}")
            print(f"Link text: '{link['text']}'")
            
            try:
                response = requests.get(link['full_url'], headers=headers, timeout=15)
                print(f"Status: {response.status_code}")
                
                if response.status_code == 200:
                    print(f"✓ Success! Content length: {len(response.content):,} bytes")
                    
                    # Save the content
                    link_filename = f"education_link_{source['filename'].split('.')[0]}_{i}.html"
                    link_filepath = os.path.join(workspace_dir, link_filename)
                    
                    with open(link_filepath, 'w', encoding='utf-8') as f:
                        f.write(response.text)
                    print(f"Saved: {link_filename}")
                    
                    # Quick analysis
                    link_soup = BeautifulSoup(response.content, 'html.parser')
                    link_content = link_soup.get_text().lower()
                    
                    # Look for specific tertiary education data
                    tertiary_count = link_content.count('tertiary')
                    gender_count = link_content.count('male') + link_content.count('female')
                    numbers_count = len(re.findall(r'\d+[,.]?\d*\s*%?', link_content))
                    
                    print(f"Content analysis: tertiary={tertiary_count}, gender_terms={gender_count}, numbers={numbers_count}")
                    
                    # Look for tables with potential data
                    tables = link_soup.find_all('table')
                    if tables:
                        print(f"Tables found: {len(tables)}")
                        
                        # Analyze first few tables for education data
                        for j, table in enumerate(tables[:3], 1):
                            table_text = table.get_text().lower()
                            if 'education' in table_text and ('male' in table_text or 'female' in table_text):
                                print(f"  Table {j}: Contains education and gender data")
                                print(f"    Sample: {table_text[:200]}...")
                    
                    if tertiary_count > 0 and gender_count > 0:
                        print(f"*** POTENTIAL DATA SOURCE - Contains tertiary education and gender information ***")
                
                else:
                    print(f"✗ Failed - Status: {response.status_code}")
                    
            except Exception as e:
                print(f"✗ Error: {str(e)}")
            
            time.sleep(2)
    else:
        print("No education-related links found")

# Save comprehensive search results
search_results = {
    'objective': '2011 Bulgarian Census - Tertiary Education by Gender',
    'search_timestamp': time.strftime('%Y-%m-%d %H:%M:%S'),
    'successful_sources': len(successful_sources),
    'sources_analyzed': successful_sources,
    'methodology': [
        'Direct access to NSI 2011 census pages',
        'Search for education-related links and publications',
        'Download and analyze census data sources',
        'Look for tertiary education statistics by gender'
    ],
    'next_steps': [
        'Parse downloaded HTML files for data tables',
        'Extract specific tertiary education completion numbers by gender',
        'Verify data is from official 2011 Bulgarian census',
        'Calculate percentages if only raw numbers are available'
    ]
}

results_file = os.path.join(workspace_dir, 'bulgarian_census_tertiary_education_search.json')
with open(results_file, 'w', encoding='utf-8') as f:
    json.dump(search_results, f, indent=2, ensure_ascii=False)

print(f"\n=== SEARCH COMPLETE ===")
print(f"Search results saved to: {results_file}")
print(f"\nFiles created in workspace:")

# List all files created
if os.path.exists(workspace_dir):
    created_files = [f for f in os.listdir(workspace_dir) if f.startswith(('census_2011_source_', 'education_link_'))]
    for filename in created_files:
        filepath = os.path.join(workspace_dir, filename)
        file_size = os.path.getsize(filepath)
        print(f"  - {filename} ({file_size:,} bytes)")

print(f"\nNext step: Parse the downloaded census files to extract the specific tertiary education completion data by gender from the 2011 Bulgarian census.")
```