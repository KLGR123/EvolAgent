### Development Step 2: ClinicalTrials.gov Trials on H. pylori Treatment in Acne Vulgaris Patients Jan–May 2018

**Description**: Search the NIH clinical trials database (ClinicalTrials.gov) for clinical trials involving H. pylori treatment in acne vulgaris patients that were conducted during the January-May 2018 timeframe. Extract the actual enrollment count from the trial listing, focusing on studies that specifically examine the relationship between H. pylori infection and acne vulgaris treatment during this exact time period.

**Use Cases**:
- Competitive intelligence for a pharmaceutical R&D team analyzing enrollment trends in H. pylori–focused acne trials from January–May 2018 to inform pipeline prioritization
- Academic systematic review by a dermatology researcher extracting precise participant counts in 2018 H. pylori acne studies for publication in a meta-analysis
- Biotech startup market validation automating ClinicalTrials.gov queries to gauge historical demand and study sizes for H. pylori acne treatment programs
- Regulatory affairs specialist compiling historical enrollment data on H. pylori and acne vulgaris trials in early 2018 to strengthen an IND submission dossier
- Data engineering team building an internal clinical-trial dashboard that refreshes enrollment metrics for H. pylori–related dermatology studies on a scheduled basis
- Clinical operations manager assessing site feasibility by reviewing actual recruitment numbers from January–May 2018 H. pylori acne trials before launching a new protocol
- Public health analyst monitoring antibiotic treatment impacts on skin conditions by mining completed H. pylori eradication trials linked to acne vulgaris outcomes
- Medical grant writer sourcing concrete enrollment statistics from early 2018 H. pylori acne trials to justify sample-size calculations in a funding proposal

```
import requests
import json
import xml.etree.ElementTree as ET
from datetime import datetime
import re

# Direct approach: Use ClinicalTrials.gov API to search for H. pylori acne trials
print("=" * 80)
print("DIRECT CLINICALTRIALS.GOV API SEARCH FOR H. PYLORI ACNE VULGARIS TRIALS")
print("Target Period: January-May 2018")
print("=" * 80)

# ClinicalTrials.gov API endpoint for searching studies
base_url = "https://clinicaltrials.gov/api/query/study_fields"

# Define search parameters for H. pylori and acne studies
search_terms = [
    "H. pylori acne",
    "Helicobacter pylori acne",
    "H pylori acne vulgaris",
    "helicobacter acne vulgaris",
    "pylori acne treatment"
]

# Fields to retrieve from the API
fields = [
    "NCTId",
    "BriefTitle",
    "OfficialTitle", 
    "Condition",
    "Intervention",
    "StudyFirstPostDate",
    "StartDate",
    "CompletionDate",
    "EnrollmentCount",
    "EnrollmentType",
    "StudyType",
    "Phase",
    "DetailedDescription",
    "BriefSummary",
    "LocationCountry",
    "OverallStatus"
]

all_trials = []
print(f"Searching with {len(search_terms)} different search terms...\n")

for i, term in enumerate(search_terms, 1):
    print(f"Search {i}/{len(search_terms)}: '{term}'")
    print("-" * 50)
    
    # Prepare API parameters
    params = {
        "expr": term,
        "fields": ",".join(fields),
        "fmt": "json",
        "min_rnk": 1,
        "max_rnk": 50  # Get up to 50 results per search
    }
    
    try:
        response = requests.get(base_url, params=params, timeout=30)
        print(f"API Response Status: {response.status_code}")
        
        if response.status_code == 200:
            data = response.json()
            
            if 'StudyFieldsResponse' in data and 'StudyFields' in data['StudyFieldsResponse']:
                studies = data['StudyFieldsResponse']['StudyFields']
                print(f"Found {len(studies)} studies")
                
                # Process each study
                for study in studies:
                    # Extract study information
                    nct_id = study.get('NCTId', [''])[0] if study.get('NCTId') else ''
                    brief_title = study.get('BriefTitle', [''])[0] if study.get('BriefTitle') else ''
                    official_title = study.get('OfficialTitle', [''])[0] if study.get('OfficialTitle') else ''
                    conditions = study.get('Condition', [])
                    interventions = study.get('Intervention', [])
                    start_date = study.get('StartDate', [''])[0] if study.get('StartDate') else ''
                    enrollment_count = study.get('EnrollmentCount', [''])[0] if study.get('EnrollmentCount') else ''
                    enrollment_type = study.get('EnrollmentType', [''])[0] if study.get('EnrollmentType') else ''
                    study_type = study.get('StudyType', [''])[0] if study.get('StudyType') else ''
                    brief_summary = study.get('BriefSummary', [''])[0] if study.get('BriefSummary') else ''
                    detailed_description = study.get('DetailedDescription', [''])[0] if study.get('DetailedDescription') else ''
                    overall_status = study.get('OverallStatus', [''])[0] if study.get('OverallStatus') else ''
                    
                    # Check if this study is relevant to our search
                    combined_text = f"{brief_title} {official_title} {' '.join(conditions)} {' '.join(interventions)} {brief_summary} {detailed_description}".lower()
                    
                    # Look for H. pylori and acne mentions
                    has_h_pylori = any(term in combined_text for term in ['h. pylori', 'h pylori', 'helicobacter pylori', 'helicobacter'])
                    has_acne = any(term in combined_text for term in ['acne', 'acne vulgaris'])
                    
                    if has_h_pylori or has_acne:  # Include if it has either term
                        study_info = {
                            'search_term': term,
                            'nct_id': nct_id,
                            'brief_title': brief_title,
                            'official_title': official_title,
                            'conditions': conditions,
                            'interventions': interventions,
                            'start_date': start_date,
                            'enrollment_count': enrollment_count,
                            'enrollment_type': enrollment_type,
                            'study_type': study_type,
                            'brief_summary': brief_summary[:500] + '...' if len(brief_summary) > 500 else brief_summary,
                            'detailed_description': detailed_description[:500] + '...' if len(detailed_description) > 500 else detailed_description,
                            'overall_status': overall_status,
                            'has_h_pylori': has_h_pylori,
                            'has_acne': has_acne,
                            'relevance_score': (2 if has_h_pylori and has_acne else 1)
                        }
                        
                        all_trials.append(study_info)
                        
                        print(f"  📋 Study Found: {nct_id}")
                        print(f"     Title: {brief_title}")
                        print(f"     H. pylori: {'✓' if has_h_pylori else '✗'}")
                        print(f"     Acne: {'✓' if has_acne else '✗'}")
                        print(f"     Start Date: {start_date}")
                        print(f"     Enrollment: {enrollment_count} ({enrollment_type})")
                        print(f"     Status: {overall_status}")
                        print()
                
            else:
                print("No studies found in API response")
                
        else:
            print(f"API request failed with status {response.status_code}")
            print(f"Response: {response.text[:500]}")
            
    except Exception as e:
        print(f"Error during search: {str(e)}")
        continue
    
    print()

print("\n" + "=" * 80)
print("CLINICAL TRIALS ANALYSIS")
print("=" * 80)

# Remove duplicates based on NCT ID
unique_trials = {}
for trial in all_trials:
    nct_id = trial['nct_id']
    if nct_id not in unique_trials or trial['relevance_score'] > unique_trials[nct_id]['relevance_score']:
        unique_trials[nct_id] = trial

unique_trials_list = list(unique_trials.values())

# Sort by relevance score (highest first)
unique_trials_list.sort(key=lambda x: x['relevance_score'], reverse=True)

print(f"Total unique trials found: {len(unique_trials_list)}")
print(f"Trials with both H. pylori and acne: {len([t for t in unique_trials_list if t['relevance_score'] == 2])}")
print(f"Trials with H. pylori only: {len([t for t in unique_trials_list if t['has_h_pylori'] and not t['has_acne']])}")
print(f"Trials with acne only: {len([t for t in unique_trials_list if t['has_acne'] and not t['has_h_pylori']])}")

# Filter for 2018 trials (January-May)
print("\n" + "-" * 60)
print("FILTERING FOR JANUARY-MAY 2018 TRIALS")
print("-" * 60)

# Function to check if date falls in January-May 2018
def is_jan_may_2018(date_str):
    if not date_str:
        return False
    
    # Common date formats in ClinicalTrials.gov
    date_patterns = [
        r'January (\d{1,2}), 2018',
        r'February (\d{1,2}), 2018', 
        r'March (\d{1,2}), 2018',
        r'April (\d{1,2}), 2018',
        r'May (\d{1,2}), 2018',
        r'(January|February|March|April|May) 2018',
        r'2018-0[1-5]',  # 2018-01 through 2018-05
        r'01/\d{1,2}/2018',  # January
        r'02/\d{1,2}/2018',  # February  
        r'03/\d{1,2}/2018',  # March
        r'04/\d{1,2}/2018',  # April
        r'05/\d{1,2}/2018'   # May
    ]
    
    for pattern in date_patterns:
        if re.search(pattern, date_str, re.IGNORECASE):
            return True
    
    return False

target_period_trials = []
for trial in unique_trials_list:
    start_date = trial['start_date']
    if is_jan_may_2018(start_date):
        target_period_trials.append(trial)
        print(f"✅ MATCH: {trial['nct_id']} - {trial['brief_title']}")
        print(f"   Start Date: {start_date}")
        print(f"   Enrollment: {trial['enrollment_count']} ({trial['enrollment_type']})")
        print(f"   H. pylori: {'✓' if trial['has_h_pylori'] else '✗'}, Acne: {'✓' if trial['has_acne'] else '✗'}")
        print()

print(f"Trials in January-May 2018 period: {len(target_period_trials)}")

# Save all results to workspace
timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
results_file = f"workspace/clinicaltrials_h_pylori_acne_2018_{timestamp}.json"

with open(results_file, 'w', encoding='utf-8') as f:
    json.dump({
        'search_timestamp': timestamp,
        'search_terms_used': search_terms,
        'total_trials_found': len(unique_trials_list),
        'jan_may_2018_trials': len(target_period_trials),
        'all_unique_trials': unique_trials_list,
        'target_period_trials': target_period_trials,
        'search_criteria': {
            'conditions': ['H. pylori', 'Helicobacter pylori', 'acne', 'acne vulgaris'],
            'time_period': 'January-May 2018',
            'database': 'ClinicalTrials.gov API'
        }
    }, f, indent=2, ensure_ascii=False)

print(f"\nResults saved to: {results_file}")

# Final summary
print("\n" + "=" * 80)
print("FINAL SUMMARY: H. PYLORI ACNE VULGARIS TRIALS (JAN-MAY 2018)")
print("=" * 80)

if target_period_trials:
    print(f"🎯 SUCCESS: Found {len(target_period_trials)} clinical trial(s) in target period")
    
    for i, trial in enumerate(target_period_trials, 1):
        print(f"\nTrial {i}:")
        print(f"  NCT ID: {trial['nct_id']}")
        print(f"  Title: {trial['brief_title']}")
        print(f"  Start Date: {trial['start_date']}")
        print(f"  Enrollment Count: {trial['enrollment_count']}")
        print(f"  Enrollment Type: {trial['enrollment_type']}")
        print(f"  Status: {trial['overall_status']}")
        print(f"  Conditions: {', '.join(trial['conditions'])}")
        print(f"  Interventions: {', '.join(trial['interventions'])}")
        print(f"  H. pylori mentioned: {'Yes' if trial['has_h_pylori'] else 'No'}")
        print(f"  Acne mentioned: {'Yes' if trial['has_acne'] else 'No'}")
        
        if trial['brief_summary']:
            print(f"  Summary: {trial['brief_summary'][:200]}...")
else:
    print("❌ No clinical trials found for H. pylori treatment in acne vulgaris patients during January-May 2018")
    
    if unique_trials_list:
        print(f"\nHowever, found {len(unique_trials_list)} related trials in other time periods:")
        for trial in unique_trials_list[:5]:  # Show top 5
            print(f"  - {trial['nct_id']}: {trial['brief_title']} (Start: {trial['start_date']})")

print(f"\nDetailed data available in: {results_file}")
```