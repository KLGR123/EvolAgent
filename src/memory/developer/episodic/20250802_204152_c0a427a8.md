### Development Step 55: Extract gender-specific tertiary education completion figures from 2011 Bulgarian census PDF

**Description**: Extract the specific tertiary education completion data by gender from the downloaded Census2011final_en.pdf file in the workspace. Parse the document to locate the section containing tertiary education graduates by educational-qualification degree and sex, then extract the exact numbers of men and women who completed tertiary education according to the 2011 Bulgarian census.

**Use Cases**:
- Government policy evaluation and monitoring gender parity in higher education for Bulgaria‚Äôs Ministry of Education
- Academic demographic research analyzing regional tertiary graduation rates by sex in Eastern European studies
- NGO program impact assessment tracking women‚Äôs university completion to measure the success of scholarship initiatives
- Corporate HR workforce planning integrating census education-attainment data by gender to inform diversity and inclusion targets
- Market research segmentation of potential professional training clients based on male versus female higher-education credentials
- Journalism and media outlets generating data-driven infographics on the gender gap in university graduates for national news features
- Educational consultancy firms designing targeted STEM outreach programs for underrepresented gender groups using census-derived metrics
- Business intelligence teams automating dashboard reports that compare male and female tertiary-education completion trends over time

```
import os
from langchain_community.document_loaders import PyPDFLoader

# Use the correct PDF file path found in the previous step
pdf_path = "workspace_e0c10771-d627-4fd7-9694-05348e54ee36/census_2011_Census2011final_en.pdf"
print(f"Loading PDF file: {pdf_path}")
print(f"File size: {os.path.getsize(pdf_path)} bytes ({os.path.getsize(pdf_path)/1024/1024:.2f} MB)")

# Load and examine the PDF structure
print("\nLoading PDF with LangChain PyPDFLoader...")
loader = PyPDFLoader(pdf_path)
pages = loader.load_and_split()

print(f"Total pages in PDF: {len(pages)}")

if len(pages) == 0:
    print("ERROR: No pages found in PDF")
else:
    print("\n=== SEARCHING FOR TERTIARY EDUCATION DATA BY GENDER ===")
    
    # Enhanced search for education-related content
    education_keywords = ['tertiary', 'higher education', 'university', 'degree', 'graduate', 'qualification', 'educational attainment', 'education level', 'completed education']
    gender_keywords = ['men', 'women', 'male', 'female', 'sex', 'gender', 'by sex', 'by gender']
    numerical_patterns = ['total', 'number', 'persons', 'population']
    
    relevant_pages = []
    
    for i, page in enumerate(pages):
        content = page.page_content.lower()
        
        # Check if page contains education, gender, and numerical data
        has_education = any(keyword in content for keyword in education_keywords)
        has_gender = any(keyword in content for keyword in gender_keywords)
        has_numbers = any(char.isdigit() for char in page.page_content)
        has_numerical_context = any(pattern in content for pattern in numerical_patterns)
        
        # Score the relevance of each page
        relevance_score = 0
        if has_education: relevance_score += 2
        if has_gender: relevance_score += 2  
        if has_numbers: relevance_score += 1
        if has_numerical_context: relevance_score += 1
        
        if relevance_score >= 3:  # Minimum threshold for relevance
            relevant_pages.append((i, relevance_score))
            print(f"\nüìÑ Page {i+1} (relevance score: {relevance_score})")
            
            # Show keywords found
            found_edu = [kw for kw in education_keywords if kw in content]
            found_gender = [kw for kw in gender_keywords if kw in content]
            print(f"  Education keywords: {found_edu}")
            print(f"  Gender keywords: {found_gender}")
            
            # Show a preview of the page content
            preview = page.page_content[:400].replace('\n', ' ').strip()
            print(f"  Preview: {preview}...")
    
    # Sort by relevance score (highest first)
    relevant_pages.sort(key=lambda x: x[1], reverse=True)
    print(f"\nFound {len(relevant_pages)} potentially relevant pages")
    
    # Examine the most relevant pages in detail
    if relevant_pages:
        print("\n=== DETAILED EXAMINATION OF MOST RELEVANT PAGES ===")
        
        for page_idx, score in relevant_pages[:3]:  # Examine top 3 most relevant pages
            print(f"\n{'='*60}")
            print(f"PAGE {page_idx+1} (Relevance Score: {score})")
            print(f"{'='*60}")
            content = pages[page_idx].page_content
            print(content)
            print(f"{'='*60}")
            
            # Look for specific patterns that might indicate tertiary education data
            lines = content.split('\n')
            for line_num, line in enumerate(lines, 1):
                line_lower = line.lower()
                if ('tertiary' in line_lower or 'higher' in line_lower or 'university' in line_lower) and any(char.isdigit() for char in line):
                    print(f"\n*** POTENTIAL TERTIARY EDUCATION DATA (Line {line_num}): {line.strip()} ***")
    else:
        print("\n‚ö†Ô∏è No highly relevant pages found. Searching with broader criteria...")
        
        # Broader search for any education-related content
        for i, page in enumerate(pages[:30]):  # Check first 30 pages
            content = page.page_content.lower()
            if any(keyword in content for keyword in ['education', 'qualification', 'attainment', 'level']):
                print(f"\nPage {i+1} contains education-related content:")
                preview = page.page_content[:300].replace('\n', ' ').strip()
                print(f"Preview: {preview}...")
                
                # Check for tables or structured data
                if '|' in page.page_content or 'table' in content:
                    print("  ‚Ü≥ This page appears to contain tabular data")

print("\n=== PDF ANALYSIS COMPLETE ===")
```