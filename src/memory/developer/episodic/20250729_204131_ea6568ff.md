### Development Step 2: Locate Nedoshivina 2010 paper on Vietnamese specimens by Kuznetzov, including methods and repository info

**Description**: Search for Nedoshivina's 2010 scientific paper that includes descriptions of Vietnamese specimens by Kuznetzov. Focus on finding the complete publication with methods/materials sections or specimen repository information. Use these search approaches: (1) Academic databases like Google Scholar, PubMed, or ResearchGate using keywords 'Nedoshivina 2010 Vietnamese specimens Kuznetzov', (2) Taxonomic databases that might reference specimen deposits, (3) Journal archives that published the paper in 2010. Look specifically for sections mentioning specimen deposition, museum collections, or institutional repositories where the Vietnamese materials were stored.

**Use Cases**:
- Museum curators automatically extracting specimen deposition details from Nedoshivina’s 2010 catalogue to update and verify their Tortricidae collection database at ZISP
- Biodiversity informaticians harvesting Vietnamese Tortricidae origin and repository metadata from published PDFs to integrate into a global species occurrence platform
- Academic researchers conducting a meta‐analysis of Tortricidae diversity by programmatically discovering, downloading, and parsing type specimen catalogues from online archives
- Digital librarians automating the discovery and archiving of obscure entomological publications in Atalanta to ensure complete institutional repository holdings
- Grant administrators monitoring open‐access compliance by locating and validating full‐text taxonomic papers in Google Scholar, ResearchGate, and journal archives
- Conservation biologists retrieving museum accession numbers and collection localities from PDF methods sections to model habitat suitability for endangered moth species
- Systematics PhD students streamlining their literature reviews by scraping abstracts, methods/materials, and repository information from historical taxonomic papers
- Data journalists investigating transparency in specimen reporting by aggregating repository details from multiple scientific databases into an interactive dashboard

```
import os
import json
import requests

# First, let's inspect the search results file to understand its structure
search_results_file = 'workspace/nedoshivina_2010_search_results.json'

print("=== ANALYZING NEDOSHIVINA 2010 SEARCH RESULTS ===\n")

if os.path.exists(search_results_file):
    print("Inspecting search results file structure:")
    with open(search_results_file, 'r') as f:
        search_data = json.load(f)
    
    print(f"Main keys in search data: {list(search_data.keys())}")
    
    if 'search_results' in search_data:
        results = search_data['search_results']
        print(f"\nSearch query used: {search_data.get('query_used', 'Unknown')}")
        print(f"Total results found: {search_data.get('total_results', 0)}")
        print(f"Academic links identified: {search_data.get('academic_links_found', 0)}")
        
        if 'organic_results' in results:
            print(f"\n=== TOP RESULTS ANALYSIS ===\n")
            
            # Focus on the most relevant results (first few)
            top_results = results['organic_results'][:5]
            
            direct_paper_links = []
            
            for i, result in enumerate(top_results):
                title = result.get('title', 'No title')
                link = result.get('link', 'No link')
                snippet = result.get('snippet', 'No snippet')
                
                print(f"Result {i+1}:")
                print(f"Title: {title}")
                print(f"Link: {link}")
                print(f"Snippet: {snippet[:200]}..." if len(snippet) > 200 else f"Snippet: {snippet}")
                
                # Identify direct paper access links
                if any(indicator in link.lower() for indicator in ['.pdf', 'zobodat', 'archive.org']):
                    direct_paper_links.append({
                        'title': title,
                        'link': link,
                        'type': 'PDF' if '.pdf' in link else 'Archive'
                    })
                    print(f"*** DIRECT PAPER ACCESS IDENTIFIED ***")
                
                print("-" * 80)
            
            print(f"\n=== DIRECT PAPER ACCESS OPPORTUNITIES ===\n")
            
            if direct_paper_links:
                print(f"Found {len(direct_paper_links)} direct access links:")
                
                for i, paper_link in enumerate(direct_paper_links):
                    print(f"\n{i+1}. {paper_link['title']}")
                    print(f"   Link: {paper_link['link']}")
                    print(f"   Type: {paper_link['type']}")
                
                # Try to download the first PDF link
                pdf_link = next((link for link in direct_paper_links if link['type'] == 'PDF'), None)
                
                if pdf_link:
                    print(f"\n=== ATTEMPTING TO DOWNLOAD PAPER PDF ===\n")
                    print(f"Target: {pdf_link['title']}")
                    print(f"URL: {pdf_link['link']}")
                    
                    try:
                        # Set headers to mimic browser request
                        headers = {
                            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',
                            'Accept': 'application/pdf,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
                            'Accept-Language': 'en-US,en;q=0.5',
                            'Accept-Encoding': 'gzip, deflate, br',
                            'Connection': 'keep-alive',
                            'Upgrade-Insecure-Requests': '1'
                        }
                        
                        print("Making request to download PDF...")
                        response = requests.get(pdf_link['link'], headers=headers, timeout=30)
                        response.raise_for_status()
                        
                        # Check if we got a PDF
                        content_type = response.headers.get('content-type', '').lower()
                        print(f"Content-Type: {content_type}")
                        print(f"Content-Length: {len(response.content)} bytes")
                        
                        if 'pdf' in content_type or len(response.content) > 10000:  # Assume PDF if large file
                            pdf_path = 'workspace/nedoshivina_2010_catalogue_tortricidae_vietnam.pdf'
                            
                            with open(pdf_path, 'wb') as pdf_file:
                                pdf_file.write(response.content)
                            
                            file_size = os.path.getsize(pdf_path)
                            print(f"\n*** PDF SUCCESSFULLY DOWNLOADED ***")
                            print(f"Saved to: {pdf_path}")
                            print(f"File size: {file_size:,} bytes ({file_size/1024/1024:.2f} MB)")
                            
                            # Verify the file is readable
                            if file_size > 1000:
                                print("PDF download appears successful and file size is reasonable.")
                                print("Paper is now available for detailed analysis of specimen repository information.")
                            else:
                                print("Warning: Downloaded file is very small, may not be the actual PDF.")
                        
                        else:
                            print(f"Downloaded content doesn't appear to be a PDF (Content-Type: {content_type})")
                            print("Content preview:")
                            print(response.text[:500] + "..." if len(response.text) > 500 else response.text)
                    
                    except requests.exceptions.RequestException as e:
                        print(f"Error downloading PDF: {e}")
                        print("Will try alternative access methods.")
                    
                    except Exception as e:
                        print(f"Unexpected error during PDF download: {e}")
                
                else:
                    print("No direct PDF links found, but archive links are available.")
            
            else:
                print("No direct paper access links identified.")
            
            # Extract key information from search results
            print(f"\n=== KEY FINDINGS FROM SEARCH RESULTS ===\n")
            
            findings = {
                'paper_title': 'A catalogue of type specimens of the Tortricidae described by V.I. Kuznetzov from Vietnam and deposited in the Zoological Institute, St. Petersburg',
                'author': 'Nedoshivina, Svetlana (S.V.)',
                'publication_year': 2010,
                'journal': 'Atalanta',
                'volume_pages': '41: 335-347',
                'specimen_repository': 'Zoological Institute, St. Petersburg (ZISP)',
                'specimen_origin': 'Vietnamese Tortricidae collected by V.I. Kuznetzov',
                'repository_details': 'Main collection of ZISP (Zoological Institute of the Russian Academy of Sciences, St. Petersburg)',
                'paper_type': 'Type specimen catalogue',
                'access_links': [link['link'] for link in direct_paper_links]
            }
            
            for key, value in findings.items():
                if isinstance(value, list):
                    print(f"{key.replace('_', ' ').title()}: {len(value)} links available")
                    for link in value:
                        print(f"  - {link}")
                else:
                    print(f"{key.replace('_', ' ').title()}: {value}")
            
            # Save detailed findings
            with open('workspace/nedoshivina_paper_findings.json', 'w') as f:
                json.dump(findings, f, indent=2)
            print(f"\nDetailed findings saved to: workspace/nedoshivina_paper_findings.json")
            
else:
    print(f"Search results file not found: {search_results_file}")
    print("Available files in workspace:")
    if os.path.exists('workspace'):
        for file in os.listdir('workspace'):
            print(f"  - {file}")
    else:
        print("Workspace directory not found.")
```