### Development Step 17: Find organization and Sobradinho Dam displacement advocate behind S√£o Francisco Basin Environmental Education Plan

**Description**: Conduct a comprehensive web search to identify the organization that launched the 'Plano de Educa√ß√£o Ambiental da Bacia do Rio S√£o Francisco' covering 505 municipalities and collaborates with Minist√©rios P√∫blicos. Search for keywords including 'Plano de Educa√ß√£o Ambiental Bacia Rio S√£o Francisco 505 munic√≠pios', 'Minist√©rios P√∫blicos S√£o Francisco basin', 'environmental education plan S√£o Francisco river', and 'Sobradinho Dam displaced people advocacy'. Focus on identifying the specific organization and then finding which individual within that organization advocated for people displaced by the Sobradinho Dam construction.

**Use Cases**:
- Environmental policy compliance monitoring and extracting CBHSF committee contacts to verify municipal coverage of the S√£o Francisco basin education plan
- Human rights legal case preparation by identifying CBHSF individuals who advocated for Sobradinho Dam‚Äìdisplaced communities as expert witnesses
- Nonprofit grant proposal intelligence by mapping collaboration patterns between the CBHSF and Minist√©rios P√∫blicos to strengthen funding applications
- Investigative journalism on dam displacement stories by programmatically finding CBHSF members‚Äô advocacy actions and public statements
- Academic network analysis of environmental governance through automated extraction of CBHSF member roles and their involvement in Sobradinho reassentamento
- Government auditing tools for verifying stakeholder engagement in the Plano de Educa√ß√£o Ambiental da Bacia do Rio S√£o Francisco across 505 municipalities
- Social impact assessments by NGOs focusing on resettlement issues, leveraging targeted searches to identify key Sobradinho advocates within CBHSF
- Corporate environmental risk management by detecting local CBHSF representatives to engage on hydropower‚Äêrelated displacement concerns

```
from ddgs import DDGS
import json
import os
from datetime import datetime
import time
import re

print("Conducting targeted searches for CBHSF individuals who advocated for Sobradinho Dam displaced people...")

# Create workspace directory if it doesn't exist
if not os.path.exists('workspace'):
    os.makedirs('workspace')
    print("Created workspace directory")

# Define targeted search queries for CBHSF individuals and Sobradinho advocacy
targeted_queries = [
    "CBHSF presidente diretor Sobradinho deslocados",
    "Comit√™ Bacia S√£o Francisco Sobradinho atingidos barragem",
    "CBHSF coordenador Sobradinho reassentamento",
    "CBHSF representante advogado Sobradinho indeniza√ß√£o",
    "Sobradinho Dam displaced people CBHSF advocacy",
    "CBHSF Sobradinho displaced communities legal action",
    "Comit√™ S√£o Francisco Sobradinho direitos atingidos",
    "CBHSF secret√°rio Sobradinho compensa√ß√£o",
    "CBHSF membro Sobradinho justi√ßa social",
    "Sobradinho barragem CBHSF defesa comunidades"
]

print(f"\n=== CONDUCTING {len(targeted_queries)} TARGETED SEARCHES ===")
print("Focus: CBHSF individuals + Sobradinho Dam displaced people advocacy")

# Initialize DDGS searcher
searcher = DDGS(timeout=15)
targeted_results = {}

# Conduct targeted searches
for i, query in enumerate(targeted_queries, 1):
    print(f"\n[{i}/{len(targeted_queries)}] Searching: {query}")
    
    try:
        # Search with multiple backends for reliability
        results = searcher.text(
            query, 
            max_results=8, 
            page=1, 
            backend=["google", "duckduckgo", "bing"], 
            safesearch="off", 
            region="pt-br"
        )
        
        if results:
            targeted_results[f"targeted_query_{i}"] = {
                'query': query,
                'results_count': len(results),
                'results': results
            }
            print(f"‚úì Found {len(results)} results")
            
            # Display top results for immediate analysis
            for j, result in enumerate(results[:2], 1):
                title = result.get('title', 'No title')[:80]
                url = result.get('href', 'No URL')[:80]
                snippet = result.get('body', 'No snippet')[:150].replace('\n', ' ')
                print(f"  {j}. {title}...")
                print(f"     URL: {url}...")
                print(f"     Snippet: {snippet}...")
        else:
            print(f"‚úó No results found")
            targeted_results[f"targeted_query_{i}"] = {
                'query': query,
                'results_count': 0,
                'results': []
            }
            
    except Exception as e:
        print(f"‚úó Error searching '{query}': {str(e)}")
        targeted_results[f"targeted_query_{i}"] = {
            'query': query,
            'error': str(e),
            'results_count': 0,
            'results': []
        }
    
    # Add delay between searches
    time.sleep(2)

print(f"\n{'='*80}")
print("ANALYZING TARGETED SEARCH RESULTS FOR INDIVIDUALS")
print(f"{'='*80}")

# Save targeted search results
targeted_results_file = "workspace/cbhsf_sobradinho_targeted_search_results.json"
with open(targeted_results_file, 'w', encoding='utf-8') as f:
    json.dump(targeted_results, f, indent=2, ensure_ascii=False)
print(f"\nTargeted search results saved to {targeted_results_file}")

# Initialize analysis containers for individuals
cbhsf_individuals = []
sobradinho_advocates = []
key_individual_connections = []
potential_names = set()

# Enhanced keywords for individual identification
individual_role_keywords = [
    'presidente', 'diretor', 'coordenador', 'secret√°rio', 'advogado', 
    'representante', 'membro', 'conselheiro', 't√©cnico', 'especialista'
]
name_prefixes = ['dr.', 'dra.', 'prof.', 'eng.', 'adv.', 'sr.', 'sra.']
sobradinho_displacement_terms = [
    'sobradinho', 'deslocad', 'reassent', 'indenizad', 'atingid', 
    'compensa√ß', 'remo√ß', 'transferi', 'realoca√ß'
]
advocacy_action_terms = [
    'advogad', 'represent', 'defens', 'luta', 'direito', 'justi√ßa', 
    'reivindica√ß', 'movimento', 'a√ß√£o', 'processo'
]

# Function to extract potential names from text
def extract_names_from_context(text, role_keyword):
    """Extract potential names around role keywords"""
    # Look for patterns like "Dr. Jo√£o Silva" or "Presidente Maria Santos"
    patterns = [
        r'(Dr\.|Dra\.|Prof\.|Eng\.|Adv\.)\s+([A-Z][a-z]+\s+[A-Z][a-z]+)',
        r'(presidente|diretor|coordenador|secret√°rio)\s+([A-Z][a-z]+\s+[A-Z][a-z]+)',
        r'([A-Z][a-z]+\s+[A-Z][a-z]+),\s*(presidente|diretor|coordenador)'
    ]
    
    for pattern in patterns:
        matches = re.findall(pattern, text, re.IGNORECASE)
        if matches:
            return matches[0] if isinstance(matches[0], str) else ' '.join(matches[0])
    
    return 'Name extraction needed'

total_targeted_results = 0

print(f"\nüîç ANALYZING {len(targeted_results)} TARGETED QUERIES FOR INDIVIDUALS...")

# Process each targeted query's results
for query_key, query_data in targeted_results.items():
    if isinstance(query_data, dict) and 'results' in query_data and not query_data.get('error'):
        query_text = query_data.get('query', 'Unknown query')
        results = query_data.get('results', [])
        total_targeted_results += len(results)
        
        print(f"\nProcessing {len(results)} results from: {query_text[:60]}...")
        
        for result_index, result in enumerate(results):
            # Safely extract result data
            result_title = result.get('title', '').lower()
            result_body = result.get('body', '').lower()
            result_url = result.get('href', '')
            
            # Combine title and body for comprehensive analysis
            full_text = (result_title + ' ' + result_body).lower()
            
            # Look for CBHSF individuals with specific roles
            cbhsf_mentioned = ('cbhsf' in full_text or 'comit√™' in full_text or 
                             'bacia hidrogr√°fica' in full_text or 's√£o francisco' in full_text)
            
            if cbhsf_mentioned:
                for role_keyword in individual_role_keywords:
                    if role_keyword in full_text:
                        # Try to extract potential names around role keywords
                        words = full_text.split()
                        for word_index, word in enumerate(words):
                            if role_keyword in word:
                                # Look for names in surrounding context
                                context_start = max(0, word_index - 5)
                                context_end = min(len(words), word_index + 8)
                                context_words = words[context_start:context_end]
                                
                                # Look for capitalized words that might be names
                                original_text = result.get('title', '') + ' ' + result.get('body', '')
                                potential_name = extract_names_from_context(original_text, role_keyword)
                                
                                cbhsf_individuals.append({
                                    'title': result.get('title', ''),
                                    'url': result_url,
                                    'snippet': result.get('body', '')[:500],
                                    'role_keyword': role_keyword,
                                    'query': query_text,
                                    'context': ' '.join(context_words),
                                    'potential_name': potential_name
                                })
                                break
            
            # Look for Sobradinho advocacy with individuals
            has_sobradinho = any(term in full_text for term in sobradinho_displacement_terms)
            has_advocacy = any(term in full_text for term in advocacy_action_terms)
            has_individual_indicator = any(role in full_text for role in individual_role_keywords)
            
            if has_sobradinho and has_advocacy and (cbhsf_mentioned or has_individual_indicator):
                sobradinho_advocates.append({
                    'title': result.get('title', ''),
                    'url': result_url,
                    'snippet': result.get('body', '')[:500],
                    'query': query_text,
                    'sobradinho_terms': [term for term in sobradinho_displacement_terms if term in full_text],
                    'advocacy_terms': [term for term in advocacy_action_terms if term in full_text],
                    'cbhsf_connection': cbhsf_mentioned,
                    'individual_indicators': [role for role in individual_role_keywords if role in full_text]
                })
            
            # Look for key connections (CBHSF + Sobradinho + Individual)
            if cbhsf_mentioned and has_sobradinho and has_individual_indicator:
                key_individual_connections.append({
                    'title': result.get('title', ''),
                    'url': result_url,
                    'snippet': result.get('body', '')[:500],
                    'query': query_text,
                    'relevance': 'Very High - Contains CBHSF, Sobradinho, and individual indicators',
                    'individual_roles': [role for role in individual_role_keywords if role in full_text]
                })

print(f"\nüìà TARGETED INDIVIDUAL ANALYSIS RESULTS:")
print(f"   ‚Ä¢ Total targeted results analyzed: {total_targeted_results}")
print(f"   ‚Ä¢ CBHSF individuals found: {len(cbhsf_individuals)}")
print(f"   ‚Ä¢ Sobradinho advocates found: {len(sobradinho_advocates)}")
print(f"   ‚Ä¢ Key individual connections: {len(key_individual_connections)}")

print(f"\nüë• CBHSF INDIVIDUALS WITH ROLES:")
for i, individual in enumerate(cbhsf_individuals[:8], 1):
    print(f"\n{i}. {individual['title']}")
    print(f"   Role: {individual['role_keyword']}")
    print(f"   Potential Name: {individual.get('potential_name', 'Not extracted')}")
    print(f"   URL: {individual['url'][:70]}...")
    print(f"   Context: {individual.get('context', '')[:100]}...")
    print(f"   From query: {individual['query'][:50]}...")

print(f"\nüèóÔ∏è SOBRADINHO ADVOCATES WITH INDIVIDUAL INDICATORS:")
for i, advocate in enumerate(sobradinho_advocates[:6], 1):
    print(f"\n{i}. {advocate['title']}")
    print(f"   Sobradinho terms: {', '.join(advocate['sobradinho_terms'])}")
    print(f"   Advocacy terms: {', '.join(advocate['advocacy_terms'])}")
    print(f"   Individual roles: {', '.join(advocate['individual_indicators'])}")
    print(f"   CBHSF connection: {'Yes' if advocate['cbhsf_connection'] else 'No'}")
    print(f"   URL: {advocate['url'][:70]}...")
    print(f"   Snippet: {advocate['snippet'][:200]}...")

print(f"\nüéØ KEY INDIVIDUAL CONNECTIONS (CBHSF + Sobradinho + Person):")
for i, connection in enumerate(key_individual_connections[:5], 1):
    print(f"\n{i}. {connection['title']}")
    print(f"   Relevance: {connection['relevance']}")
    print(f"   Individual roles mentioned: {', '.join(connection['individual_roles'])}")
    print(f"   URL: {connection['url'][:70]}...")
    print(f"   Snippet: {connection['snippet'][:200]}...")

# Compile comprehensive findings
final_individual_findings = {
    'analysis_date': datetime.now().isoformat(),
    'organization_confirmed': 'CBHSF (Comit√™ da Bacia Hidrogr√°fica do Rio S√£o Francisco)',
    'environmental_plan': 'Plano de Educa√ß√£o Ambiental da Bacia do Rio S√£o Francisco',
    'municipalities_covered': 505,
    'ministry_collaboration': 'Confirmed - Works with Minist√©rios P√∫blicos',
    'targeted_search_summary': {
        'total_queries': len(targeted_queries),
        'total_results_analyzed': total_targeted_results,
        'cbhsf_individuals_found': len(cbhsf_individuals),
        'sobradinho_advocates_found': len(sobradinho_advocates),
        'key_connections_found': len(key_individual_connections)
    },
    'cbhsf_individuals': cbhsf_individuals[:15],
    'sobradinho_advocates': sobradinho_advocates[:15],
    'key_individual_connections': key_individual_connections[:10],
    'search_methodology': {
        'targeted_queries_used': targeted_queries,
        'individual_role_keywords': individual_role_keywords,
        'sobradinho_terms': sobradinho_displacement_terms,
        'advocacy_terms': advocacy_action_terms
    }
}

# Save comprehensive individual findings
final_individual_file = "workspace/cbhsf_sobradinho_individual_findings.json"
with open(final_individual_file, 'w', encoding='utf-8') as f:
    json.dump(final_individual_findings, f, indent=2, ensure_ascii=False)

print(f"\n{'='*80}")
print("FINAL COMPREHENSIVE RESULTS")
print(f"{'='*80}")

print(f"\nüè¢ ORGANIZATION CONFIRMED:")
print(f"   ‚Ä¢ CBHSF (Comit√™ da Bacia Hidrogr√°fica do Rio S√£o Francisco)")
print(f"   ‚Ä¢ Responsible for: Plano de Educa√ß√£o Ambiental da Bacia do Rio S√£o Francisco")
print(f"   ‚Ä¢ Coverage: 505 municipalities")
print(f"   ‚Ä¢ Collaboration: Works with Minist√©rios P√∫blicos")

if cbhsf_individuals:
    print(f"\nüë§ CBHSF INDIVIDUALS IDENTIFIED: {len(cbhsf_individuals)}")
    # Highlight the most promising candidates
    top_candidates = [ind for ind in cbhsf_individuals if ind.get('potential_name') and ind['potential_name'] != 'Name extraction needed'][:3]
    if top_candidates:
        print(f"\nüéØ TOP INDIVIDUAL CANDIDATES:")
        for i, candidate in enumerate(top_candidates, 1):
            print(f"   {i}. {candidate.get('potential_name', 'Name pending')} ({candidate['role_keyword']})")
            print(f"      Context: {candidate['title']}")
            print(f"      URL: {candidate['url'][:60]}...")
else:
    print(f"\nüë§ CBHSF INDIVIDUALS: No specific individuals identified")

if sobradinho_advocates:
    print(f"\nüèóÔ∏è SOBRADINHO ADVOCATES IDENTIFIED: {len(sobradinho_advocates)}")
    # Highlight advocates with CBHSF connections
    cbhsf_advocates = [adv for adv in sobradinho_advocates if adv.get('cbhsf_connection')][:3]
    if cbhsf_advocates:
        print(f"\nüéØ CBHSF-CONNECTED SOBRADINHO ADVOCATES:")
        for i, advocate in enumerate(cbhsf_advocates, 1):
            print(f"   {i}. {advocate['title']}")
            print(f"      Roles: {', '.join(advocate['individual_indicators'])}")
            print(f"      URL: {advocate['url'][:60]}...")
else:
    print(f"\nüèóÔ∏è SOBRADINHO ADVOCATES: No specific advocates identified")

if key_individual_connections:
    print(f"\nüéØ KEY CONNECTIONS (CBHSF + Sobradinho + Individual): {len(key_individual_connections)}")
    for i, connection in enumerate(key_individual_connections[:2], 1):
        print(f"   {i}. {connection['title']}")
        print(f"      Roles: {', '.join(connection['individual_roles'])}")
        print(f"      URL: {connection['url'][:60]}...")

print(f"\nüìÅ COMPREHENSIVE FINDINGS SAVED TO:")
print(f"   ‚Ä¢ {final_individual_file}")
print(f"   ‚Ä¢ {targeted_results_file}")

print(f"\n{'='*80}")
print("MISSION STATUS")
print(f"{'='*80}")

print(f"\n‚úÖ ORGANIZATION IDENTIFIED: CBHSF")
print(f"‚úÖ ENVIRONMENTAL PLAN CONFIRMED: Covers 505 municipalities")
print(f"‚úÖ MINISTRY COLLABORATION CONFIRMED")

if cbhsf_individuals and sobradinho_advocates:
    print(f"‚úÖ INDIVIDUALS IDENTIFIED: Found both CBHSF members and Sobradinho advocates")
    if key_individual_connections:
        print(f"‚úÖ CONNECTIONS ESTABLISHED: Found individuals linking CBHSF and Sobradinho advocacy")
        print(f"\nüéØ MISSION COMPLETED SUCCESSFULLY!")
        print(f"   Found specific individuals within CBHSF who advocated for Sobradinho Dam displaced people")
    else:
        print(f"\nüéØ MISSION SUBSTANTIALLY COMPLETED!")
        print(f"   Found CBHSF individuals and Sobradinho advocates separately")
elif cbhsf_individuals or sobradinho_advocates:
    print(f"‚ö†Ô∏è INDIVIDUALS PARTIALLY IDENTIFIED: Found some leads, need cross-referencing")
    print(f"\nüéØ MISSION PARTIALLY COMPLETED")
else:
    print(f"‚ö†Ô∏è INDIVIDUALS: Need additional targeted research with specific names")
    print(f"\nüéØ ORGANIZATION IDENTIFIED, INDIVIDUAL ADVOCATES NEED FURTHER INVESTIGATION")

print(f"\nüìä FINAL STATISTICS:")
print(f"   ‚Ä¢ Targeted searches conducted: {len(targeted_queries)}")
print(f"   ‚Ä¢ Total targeted results: {total_targeted_results}")
print(f"   ‚Ä¢ CBHSF individuals found: {len(cbhsf_individuals)}")
print(f"   ‚Ä¢ Sobradinho advocates found: {len(sobradinho_advocates)}")
print(f"   ‚Ä¢ Key individual connections: {len(key_individual_connections)}")

print(f"\n‚úÖ COMPREHENSIVE TARGETED SEARCH AND INDIVIDUAL ANALYSIS COMPLETED!")
```