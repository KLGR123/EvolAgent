### Development Step 29: Locate 2011 Bulgarian NSI Census Data on Tertiary Education Completion by Gender

**Description**: Search for the official 2011 Bulgarian census data from the Bulgarian National Statistical Institute (NSI) or other authoritative government sources that specifically contain the tertiary education completion numbers by gender. Focus on finding the exact counts or percentages of men and women who completed tertiary education according to the 2011 census results.

**Use Cases**:
- Bulgarian Ministry of Education allocating higher-education funding by analyzing male vs. female tertiary completion numbers from the 2011 census to target underrepresented groups
- Gender-equality NGO mapping regional disparities in tertiary attainment by gender to design scholarship and mentorship programs in Bulgaria
- University sociologists extracting 2011 census data on men’s and women’s degree completions for a peer-reviewed study on gender trends in higher education
- HR team at a multinational benchmarking local graduate recruitment in Bulgaria using official male and female tertiary education counts
- Labor market consultancy assessing workforce qualification gaps by gender to recommend corporate training investments based on 2011 education statistics
- Educational publisher tailoring postgraduate course portfolios by province and gender, informed by census data on tertiary completion rates
- Data journalism unit building interactive visualizations of Bulgaria’s 2011 higher-education gender balance to inform public debate
- National statistical office automating its dashboard pipeline by scraping and parsing official NSI census files for gender-disaggregated tertiary education figures

```
import os
import json
from bs4 import BeautifulSoup
import re

# Let's examine the most promising files from the workspace analysis
workspace_dir = 'workspace'

print("=== ANALYZING BULGARIAN CENSUS DATA FILES ===\n")
print("Target: Extract tertiary education completion by gender from 2011 Bulgarian census\n")

# First, let's examine the JSON analysis files to understand what data has been extracted
analysis_files = [
    'bulgarian_2011_census_tertiary_education_final_results.json',
    'bulgarian_2011_tertiary_education_gender_final.json', 
    'bulgarian_census_tertiary_education_comprehensive_final.json',
    'bulgarian_2011_census_tertiary_education_comprehensive_results.json'
]

print("=== EXAMINING EXISTING ANALYSIS FILES ===\n")

for analysis_file in analysis_files:
    filepath = os.path.join(workspace_dir, analysis_file)
    if os.path.exists(filepath):
        print(f"\n--- Analyzing: {analysis_file} ---")
        
        with open(filepath, 'r', encoding='utf-8') as f:
            try:
                data = json.load(f)
                print(f"File loaded successfully")
                print(f"Top-level keys: {list(data.keys()) if isinstance(data, dict) else 'Not a dictionary'}")
                
                # Look for gender-related data
                if isinstance(data, dict):
                    # Check for common keys that might contain gender data
                    gender_keys = [k for k in data.keys() if any(term in k.lower() for term in ['gender', 'male', 'female', 'men', 'women', 'tertiary'])]
                    if gender_keys:
                        print(f"Gender-related keys found: {gender_keys}")
                        
                        for key in gender_keys[:3]:  # Show first 3 gender-related keys
                            value = data[key]
                            print(f"  {key}: {type(value)} - {str(value)[:200]}..." if len(str(value)) > 200 else f"  {key}: {value}")
                    
                    # Look for results or findings
                    result_keys = [k for k in data.keys() if any(term in k.lower() for term in ['result', 'finding', 'data', 'statistic', 'number', 'count'])]
                    if result_keys:
                        print(f"Result-related keys found: {result_keys[:5]}")
                        
                        for key in result_keys[:2]:  # Show first 2 result keys
                            value = data[key]
                            print(f"  {key}: {type(value)} - {str(value)[:200]}..." if len(str(value)) > 200 else f"  {key}: {value}")
                
            except json.JSONDecodeError as e:
                print(f"Error loading JSON: {e}")
            except Exception as e:
                print(f"Error processing file: {e}")
    else:
        print(f"File not found: {analysis_file}")

# Now let's examine the most promising NSI HTML files
print("\n\n=== EXAMINING NSI HTML FILES ===\n")

nsi_files = [
    'www_nsi_bg_en_content_6710_population_education.html',
    'www_nsi_bg_en_content_6704_population_census_2011.html',
    'www_nsi_bg_en.html'
]

for nsi_file in nsi_files:
    filepath = os.path.join(workspace_dir, nsi_file)
    if os.path.exists(filepath):
        print(f"\n--- Analyzing: {nsi_file} ---")
        
        with open(filepath, 'r', encoding='utf-8') as f:
            html_content = f.read()
        
        print(f"File size: {len(html_content):,} characters")
        
        # Parse with BeautifulSoup
        soup = BeautifulSoup(html_content, 'html.parser')
        title = soup.find('title')
        print(f"Page title: {title.get_text().strip() if title else 'No title'}")
        
        # Look for tables that might contain census data
        tables = soup.find_all('table')
        print(f"Tables found: {len(tables)}")
        
        # Search for specific tertiary education and gender terms
        content_text = soup.get_text().lower()
        
        # Key terms to search for
        key_terms = {
            'tertiary education': content_text.count('tertiary education'),
            'higher education': content_text.count('higher education'),
            'university': content_text.count('university'),
            'bachelor': content_text.count('bachelor'),
            'master': content_text.count('master'),
            'gender': content_text.count('gender'),
            'male': content_text.count('male'),
            'female': content_text.count('female'),
            'men': content_text.count('men'),
            'women': content_text.count('women'),
            '2011': content_text.count('2011'),
            'census': content_text.count('census')
        }
        
        print(f"Key term frequencies:")
        for term, count in key_terms.items():
            if count > 0:
                print(f"  '{term}': {count}")
        
        # Look for numerical data patterns that might be statistics
        number_patterns = re.findall(r'\b\d{1,3}(?:,\d{3})*\b', content_text)
        large_numbers = [n for n in number_patterns if len(n.replace(',', '')) >= 4]  # Numbers with 4+ digits
        
        if large_numbers:
            print(f"Large numbers found (potential statistics): {large_numbers[:10]}")
        
        # Look for percentage patterns
        percentage_patterns = re.findall(r'\b\d+(?:\.\d+)?%', content_text)
        if percentage_patterns:
            print(f"Percentages found: {percentage_patterns[:10]}")
        
        # If this file has good indicators, let's examine its table structure
        if (key_terms['tertiary education'] > 0 or key_terms['higher education'] > 0) and key_terms['2011'] > 0:
            print(f"\n*** HIGH PRIORITY FILE - Contains tertiary education and 2011 census data ***")
            
            if tables:
                print(f"\nExamining table structure:")
                for i, table in enumerate(tables[:3], 1):  # Look at first 3 tables
                    rows = table.find_all('tr')
                    print(f"  Table {i}: {len(rows)} rows")
                    
                    if rows:
                        # Look at headers
                        header_row = rows[0]
                        headers = [th.get_text().strip() for th in header_row.find_all(['th', 'td'])]
                        print(f"    Headers: {headers[:5]}..." if len(headers) > 5 else f"    Headers: {headers}")
                        
                        # Look at first data row
                        if len(rows) > 1:
                            data_row = rows[1]
                            data_cells = [td.get_text().strip() for td in data_row.find_all(['th', 'td'])]
                            print(f"    Sample data: {data_cells[:5]}..." if len(data_cells) > 5 else f"    Sample data: {data_cells}")

print("\n=== FILE ANALYSIS COMPLETE ===\n")
print("Next step: Parse the most promising files to extract specific tertiary education statistics by gender")
```