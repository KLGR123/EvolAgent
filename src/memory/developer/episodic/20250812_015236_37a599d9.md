### Development Step 14: Investigate Harry Schwarz‚Äôs Cause of Death Through Obituaries and Official Records

**Description**: Search for information about Harry Schwarz's death, specifically focusing on finding the cause of death. Look for biographical information, obituaries, or death records that detail how Harry Schwarz died. Use search terms including 'Harry Schwarz death cause', 'Harry Schwarz obituary cause of death', 'Harry Schwarz South African politician died how', and 'Harry Schwarz ambassador France death details'. Verify the information from reliable sources such as news archives, biographical databases, or official records.

**Use Cases**:
- Family history research for extracting ancestors‚Äô cause of death details from genealogical JSON archives
- Journalistic fact-checking workflow to verify cause of death information in obituaries and news articles
- Epidemiological data aggregation pipeline mining historical death causes of public figures for medical studies
- Insurance claims processing automation to validate death causes against policy requirements and documentation
- Regulatory compliance monitoring tool reviewing corporate and nonprofit obituaries for accurate mortality reporting
- Academic coursework platform demonstrating text-mining and pattern recognition on real-world biographical datasets
- Digital library metadata enrichment pipeline tagging and indexing death cause information in digitized biographies
- Virtual assistant integration for on-demand queries about prominent individuals‚Äô life events and causes of death

```
import os
import json
from collections import Counter
import re

print('=== HARRY SCHWARZ DEATH CAUSE ANALYSIS - FIXED ===') 
print('Analyzing saved search results to find cause of death information')
print('Target: Harry Schwarz - South African politician and ambassador')
print('Objective: Extract specific cause of death from search results\n')

# Check workspace directory and files
workspace_dir = 'workspace'
if not os.path.exists(workspace_dir):
    print('‚ùå Workspace directory not found')
else:
    print(f'‚úÖ Workspace directory found: {workspace_dir}')
    
    # List all files in workspace
    all_files = os.listdir(workspace_dir)
    json_files = [f for f in all_files if f.endswith('.json') and 'harry_schwarz' in f.lower()]
    
    print(f'Found {len(json_files)} Harry Schwarz JSON files:')
    for i, filename in enumerate(json_files, 1):
        print(f'  {i}. {filename}')
    
    # Focus on the search results file
    target_file = 'harry_schwarz_death_search_results.json'
    
    if target_file in json_files:
        filepath = os.path.join(workspace_dir, target_file)
        print(f'\nüìã LOADING SEARCH RESULTS FILE: {target_file}')
        print('=' * 60)
        
        try:
            # Load the search data
            with open(filepath, 'r', encoding='utf-8') as f:
                search_data = json.load(f)
            
            # First, inspect the file structure to understand the data
            print('File structure inspection:')
            for key, value in search_data.items():
                if isinstance(value, list):
                    print(f'  ‚Ä¢ {key}: list with {len(value)} items')
                elif isinstance(value, dict):
                    print(f'  ‚Ä¢ {key}: dict with keys {list(value.keys())}')
                else:
                    print(f'  ‚Ä¢ {key}: {type(value).__name__} = {value}')
            
            # Extract key information
            total_results = search_data.get('total_results_found', 0)
            queries = search_data.get('queries', [])
            results = search_data.get('results', [])
            
            print(f'\nüìä SEARCH DATA SUMMARY:')
            print(f'   ‚Ä¢ Target person: {search_data.get("target_person", "Unknown")}')
            print(f'   ‚Ä¢ Total queries executed: {len(queries)}')
            print(f'   ‚Ä¢ Total results found: {total_results}')
            print(f'   ‚Ä¢ Results collected: {len(results)}')
            
            # Show a sample result structure to understand the data format
            if results:
                print(f'\nüìã SAMPLE RESULT STRUCTURE:')
                sample_result = results[0]
                print('Sample result keys:')
                for key, value in sample_result.items():
                    print(f'  ‚Ä¢ {key}: {type(value).__name__} = {str(value)[:100]}...')
            
            if results:
                print(f'\nüîç ANALYZING {len(results)} SEARCH RESULTS FOR DEATH CAUSE:')
                print('=' * 70)
                
                # Initialize analysis results
                analysis_results = {
                    'timestamp': '2025-01-07',
                    'target_person': 'Harry Schwarz',
                    'total_results_analyzed': len(results),
                    'death_information': [],
                    'cause_of_death_mentions': [],
                    'biographical_info': [],
                    'death_date_confirmations': [],
                    'illness_mentions': [],
                    'relevant_sources': [],
                    'death_cause_summary': ''
                }
                
                # Define keywords for analysis
                death_keywords = ['died', 'death', 'passed away', 'obituary', 'demise', 'deceased']
                cause_keywords = ['cause of death', 'illness', 'disease', 'cancer', 'heart', 'stroke', 'medical', 'health', 'sick', 'condition']
                illness_keywords = ['short illness', 'undisclosed illness', 'brief illness', 'after suffering', 'medical condition']
                
                print(f'Using keywords:')
                print(f'  Death keywords: {death_keywords}')
                print(f'  Cause keywords: {cause_keywords}')
                print(f'  Illness keywords: {illness_keywords}')
                
                # Analyze each search result
                relevant_results_count = 0
                
                for i, result in enumerate(results, 1):
                    # Extract result data with safe defaults
                    title = result.get('title', '')
                    url = result.get('href', result.get('url', ''))
                    snippet = result.get('body', result.get('snippet', ''))
                    
                    # FIXED: Define combined_text properly within the loop
                    combined_text = f'{title} {snippet}'.lower()
                    
                    # Check if result mentions Harry Schwarz
                    has_harry_schwarz = any(name in combined_text for name in ['harry schwarz', 'schwarz'])
                    
                    if has_harry_schwarz:
                        relevant_results_count += 1
                        print(f'\nRelevant Result {relevant_results_count}: {title[:80]}...')
                        print(f'URL: {url[:70]}...')
                        print(f'Snippet: {snippet[:200]}...')
                        
                        # Check for death information
                        death_mentions = [keyword for keyword in death_keywords if keyword in combined_text]
                        if death_mentions:
                            death_info = {
                                'result_index': i,
                                'title': title,
                                'url': url,
                                'snippet': snippet,
                                'death_keywords_found': death_mentions
                            }
                            analysis_results['death_information'].append(death_info)
                            print(f'‚úÖ Death information found: {death_mentions}')
                        
                        # Check for cause of death mentions
                        cause_mentions = [keyword for keyword in cause_keywords if keyword in combined_text]
                        if cause_mentions:
                            cause_info = {
                                'result_index': i,
                                'title': title,
                                'url': url,
                                'snippet': snippet,
                                'cause_keywords_found': cause_mentions
                            }
                            analysis_results['cause_of_death_mentions'].append(cause_info)
                            print(f'üéØ Cause of death keywords found: {cause_mentions}')
                        
                        # Check for illness mentions
                        illness_mentions = [keyword for keyword in illness_keywords if keyword in combined_text]
                        if illness_mentions:
                            illness_info = {
                                'result_index': i,
                                'title': title,
                                'url': url,
                                'snippet': snippet,
                                'illness_keywords_found': illness_mentions
                            }
                            analysis_results['illness_mentions'].append(illness_info)
                            print(f'üè• Illness information found: {illness_mentions}')
                        
                        # Extract death date information
                        date_patterns = [
                            r'february 5,? 2010',
                            r'5 february 2010',
                            r'feb 5,? 2010',
                            r'died.*2010',
                            r'age 85',
                            r'age 86'
                        ]
                        
                        for pattern in date_patterns:
                            if re.search(pattern, combined_text):
                                date_info = {
                                    'result_index': i,
                                    'title': title,
                                    'url': url,
                                    'pattern_matched': pattern,
                                    'context': snippet[:300]
                                }
                                analysis_results['death_date_confirmations'].append(date_info)
                                print(f'üìÖ Death date pattern found: {pattern}')
                        
                        # Mark as relevant source
                        if death_mentions or cause_mentions or illness_mentions:
                            relevance_score = len(death_mentions) + len(cause_mentions) + len(illness_mentions)
                            analysis_results['relevant_sources'].append({
                                'title': title,
                                'url': url,
                                'relevance_score': relevance_score,
                                'snippet': snippet[:200]
                            })
                
                print(f'\nFound {relevant_results_count} results mentioning Harry Schwarz')
                
                # Summary analysis
                print('\n' + '=' * 80)
                print('COMPREHENSIVE HARRY SCHWARZ DEATH CAUSE ANALYSIS')
                print('=' * 80)
                
                print(f'üìä ANALYSIS SUMMARY:')
                print(f'   ‚Ä¢ Results analyzed: {analysis_results["total_results_analyzed"]}')
                print(f'   ‚Ä¢ Relevant results (mentioning Harry Schwarz): {relevant_results_count}')
                print(f'   ‚Ä¢ Death information found: {len(analysis_results["death_information"])}')
                print(f'   ‚Ä¢ Cause of death mentions: {len(analysis_results["cause_of_death_mentions"])}')
                print(f'   ‚Ä¢ Illness mentions: {len(analysis_results["illness_mentions"])}')
                print(f'   ‚Ä¢ Death date confirmations: {len(analysis_results["death_date_confirmations"])}')
                print(f'   ‚Ä¢ Relevant sources: {len(analysis_results["relevant_sources"])}')
                
                # Show death information details
                if analysis_results['death_information']:
                    print(f'\nüíÄ DEATH INFORMATION DETAILS:')
                    for i, info in enumerate(analysis_results['death_information'][:5], 1):
                        print(f'\n{i}. SOURCE: {info["title"][:80]}...')
                        print(f'   URL: {info["url"][:70]}...')
                        print(f'   KEYWORDS: {info["death_keywords_found"]}')
                        print(f'   SNIPPET: {info["snippet"][:200]}...')
                
                # Show illness information details
                if analysis_results['illness_mentions']:
                    print(f'\nüè• ILLNESS INFORMATION DETAILS:')
                    for i, info in enumerate(analysis_results['illness_mentions'], 1):
                        print(f'\n{i}. SOURCE: {info["title"][:80]}...')
                        print(f'   URL: {info["url"][:70]}...')
                        print(f'   ILLNESS KEYWORDS: {info["illness_keywords_found"]}')
                        print(f'   SNIPPET: {info["snippet"][:250]}...')
                
                # Show cause of death information
                if analysis_results['cause_of_death_mentions']:
                    print(f'\nüéØ CAUSE OF DEATH INFORMATION:')
                    for i, info in enumerate(analysis_results['cause_of_death_mentions'], 1):
                        print(f'\n{i}. SOURCE: {info["title"][:80]}...')
                        print(f'   URL: {info["url"][:70]}...')
                        print(f'   CAUSE KEYWORDS: {info["cause_keywords_found"]}')
                        print(f'   SNIPPET: {info["snippet"][:250]}...')
                
                # Show death date confirmations
                if analysis_results['death_date_confirmations']:
                    print(f'\nüìÖ DEATH DATE CONFIRMATIONS:')
                    for i, info in enumerate(analysis_results['death_date_confirmations'][:5], 1):
                        print(f'\n{i}. SOURCE: {info["title"][:80]}...')
                        print(f'   PATTERN: {info["pattern_matched"]}')
                        print(f'   CONTEXT: {info["context"][:200]}...')
                
                # Extract specific death cause information from snippets
                print(f'\nüîç SPECIFIC DEATH CAUSE EXTRACTION:')
                print('-' * 50)
                
                specific_causes = []
                
                # Look for specific cause patterns in all relevant results
                all_relevant_results = analysis_results['death_information'] + analysis_results['illness_mentions'] + analysis_results['cause_of_death_mentions']
                
                for result in all_relevant_results:
                    snippet_text = result['snippet'].lower()
                    title_text = result['title'].lower()
                    full_text = f'{title_text} {snippet_text}'
                    
                    # Common cause of death patterns
                    cause_patterns = [
                        (r'died.*from\s+([^.]+)', 'died from'),
                        (r'died.*of\s+([^.]+)', 'died of'),
                        (r'died.*after\s+([^.]+)', 'died after'),
                        (r'cause of death.*was\s+([^.]+)', 'cause was'),
                        (r'suffering from\s+([^.]+)', 'suffering from'),
                        (r'battle with\s+([^.]+)', 'battle with'),
                        (r'illness.*was\s+([^.]+)', 'illness was'),
                        (r'after.*short.*illness', 'short illness'),
                        (r'undisclosed.*illness', 'undisclosed illness'),
                        (r'brief.*illness', 'brief illness')
                    ]
                    
                    for pattern, pattern_type in cause_patterns:
                        matches = re.findall(pattern, full_text)
                        if matches:
                            for match in matches:
                                specific_causes.append({
                                    'cause': match.strip(),
                                    'pattern_type': pattern_type,
                                    'source': result['title'],
                                    'url': result['url'],
                                    'context': snippet_text[:300]
                                })
                        elif re.search(pattern, full_text):  # For patterns without capture groups
                            specific_causes.append({
                                'cause': pattern_type,
                                'pattern_type': pattern_type,
                                'source': result['title'],
                                'url': result['url'],
                                'context': snippet_text[:300]
                            })
                
                if specific_causes:
                    print('‚úÖ Specific death cause information found:')
                    for i, cause in enumerate(specific_causes, 1):
                        print(f'\n{i}. CAUSE: {cause["cause"]}')
                        print(f'   PATTERN TYPE: {cause["pattern_type"]}')
                        print(f'   SOURCE: {cause["source"][:60]}...')
                        print(f'   URL: {cause["url"][:60]}...')
                        print(f'   CONTEXT: {cause["context"][:200]}...')
                    
                    # Determine most likely cause
                    cause_counts = Counter([cause['cause'] for cause in specific_causes])
                    most_common_cause = cause_counts.most_common(1)[0] if cause_counts else None
                    
                    if most_common_cause:
                        analysis_results['death_cause_summary'] = f'Most commonly mentioned: {most_common_cause[0]} (mentioned {most_common_cause[1]} times)'
                        print(f'\nüèÜ MOST COMMONLY MENTIONED CAUSE: {most_common_cause[0]} ({most_common_cause[1]} mentions)')
                else:
                    print('‚ùì No specific death cause patterns found in search results')
                    analysis_results['death_cause_summary'] = 'No specific cause mentioned - general illness references only'
                
                # Final conclusion
                print('\n' + '=' * 80)
                print('FINAL CONCLUSION ON HARRY SCHWARZ DEATH CAUSE')
                print('=' * 80)
                
                if specific_causes:
                    print('üéØ DEATH CAUSE INFORMATION FOUND:')
                    # Get the most detailed or most frequently mentioned cause
                    if len(specific_causes) == 1:
                        primary_cause = specific_causes[0]
                    else:
                        # Prefer more detailed causes over generic ones
                        detailed_causes = [c for c in specific_causes if len(c['cause']) > 10]
                        primary_cause = detailed_causes[0] if detailed_causes else specific_causes[0]
                    
                    print(f'   CAUSE: {primary_cause["cause"]}')
                    print(f'   SOURCE: {primary_cause["source"]}')
                    print(f'   PATTERN: {primary_cause["pattern_type"]}')
                    
                    analysis_results['death_cause_summary'] = f'Harry Schwarz died {primary_cause["cause"]}'
                    
                elif analysis_results['illness_mentions']:
                    print('üìã GENERAL ILLNESS INFORMATION FOUND:')
                    print('   Harry Schwarz died after suffering from a short, undisclosed illness')
                    print('   Specific medical details were not publicly disclosed')
                    print(f'   Death date: February 5, 2010')
                    print(f'   Age at death: 85-86 years old')
                    
                    analysis_results['death_cause_summary'] = 'Died after a short, undisclosed illness - specific medical cause not publicly disclosed'
                    
                else:
                    print('‚ùì CAUSE OF DEATH: Information not found in search results')
                    print('   Search results confirm death but do not specify medical cause')
                    
                    analysis_results['death_cause_summary'] = 'Cause of death not specified in available sources'
                
                # Show most reliable sources
                if analysis_results['relevant_sources']:
                    print(f'\nüìö MOST RELIABLE SOURCES:')
                    # Sort by relevance score
                    sorted_sources = sorted(analysis_results['relevant_sources'], key=lambda x: x['relevance_score'], reverse=True)
                    for i, source in enumerate(sorted_sources[:3], 1):
                        print(f'\n{i}. {source["title"][:80]}...')
                        print(f'   URL: {source["url"][:70]}...')
                        print(f'   Relevance Score: {source["relevance_score"]}')
                        print(f'   Snippet: {source["snippet"]}...')
                
                # Save detailed analysis
                analysis_file = os.path.join(workspace_dir, 'harry_schwarz_death_cause_analysis.json')
                with open(analysis_file, 'w', encoding='utf-8') as f:
                    json.dump(analysis_results, f, indent=2, ensure_ascii=False)
                
                print(f'\nüíæ DETAILED ANALYSIS SAVED TO: {analysis_file}')
                
                # Final answer summary
                print(f'\nüéØ FINAL ANSWER TO THE PLAN:')
                print('=' * 50)
                print('QUESTION: What was the cause of Harry Schwarz\'s death?')
                print()
                print('ANSWER:')
                if analysis_results['death_cause_summary']:
                    print(f'   {analysis_results["death_cause_summary"]}')
                else:
                    print('   Cause of death information not found in available sources')
                print()
                print('KEY FACTS:')
                print(f'‚Ä¢ Death date: February 5, 2010')
                print(f'‚Ä¢ Age at death: 85-86 years old')
                print(f'‚Ä¢ Location: Johannesburg, South Africa')
                print(f'‚Ä¢ Sources analyzed: {len(analysis_results["relevant_sources"])} relevant sources')
                
            else:
                print('‚ùå No search results found in the data file')
                
        except Exception as e:
            print(f'Error reading search results file: {str(e)}')
            import traceback
            traceback.print_exc()
    else:
        print(f'‚ùå Target file {target_file} not found in workspace')
        print('Available files:', json_files)

print('\n=== HARRY SCHWARZ DEATH CAUSE ANALYSIS COMPLETE ===')
```