### Development Step 9: Study Abel Hugo’s Napoleonic Military Service, Madrid Hospital Involvement, Map Publications, and Reign Context

**Description**: Research Abel Hugo, Victor Hugo's brother, focusing on his military service during the Napoleonic Wars and his time in Madrid. Search for information about his authorship of works containing maps of Napoleon's camps in Spain, his connection to the Hospital de Saint Louis in Madrid (converted to military hospital in 1809), and identify during which ruler's reign these events occurred. Look for biographical details about Abel Hugo's military career, his publications, and the specific timeframe when he was in Madrid with Victor Hugo.

**Use Cases**:
- Academic historian consolidates multiple JSON research files to extract Abel Hugo’s military service details and campaign timeline for a peer-reviewed article on Napoleonic Wars.
- Digital humanities team processes Wikipedia and Google Books JSON dumps to identify and geolocate references to “Napoleon camps” in Spain, powering an interactive map visualization.
- Museum curator automates extraction of biographical facts and publication summaries of Abel Hugo from aggregated research data, streamlining exhibit label creation and catalog writing.
- Genealogist verifies the sibling relationship between Victor Hugo and Abel Hugo by parsing text content and keyword matches across historical document archives.
- Military history blogger uses the pipeline to detect mentions of Hospital de Saint Louis’s conversion in 1809, enriching online articles with precise dates, context, and source citations.
- Academic publisher validates authorship and publication timeline of Abel Hugo’s works (e.g., La France Militaire) by cross-referencing metadata and content snippets in consolidated JSON outputs.
- E-learning platform generates interactive timelines of the Napoleonic Wars by ingesting Einstein-Hugo research data, automatically extracting key dates, rulers, and campaign summaries for course modules.

```
import json
import os
from datetime import datetime

print("Abel Hugo research - analyzing existing data and completing the research...")

# First, let's inspect the workspace to see what files we have
print("\n=== INSPECTING WORKSPACE FILES ===")
if os.path.exists('workspace'):
    workspace_files = os.listdir('workspace')
    print(f"Found {len(workspace_files)} files in workspace:")
    for file in workspace_files:
        print(f"  - {file}")
else:
    print("No workspace directory found")
    os.makedirs('workspace')

# Load and inspect existing research files to understand their structure
print("\n=== INSPECTING EXISTING RESEARCH FILES ===")
existing_files = ['abel_hugo_final_research.json', 'abel_hugo_complete_research.json', 'abel_hugo_final_comprehensive_research.json']

all_existing_results = []
for filename in existing_files:
    filepath = f'workspace/{filename}'
    if os.path.exists(filepath):
        print(f"\nInspecting: {filename}")
        try:
            with open(filepath, 'r') as f:
                data = json.load(f)
            
            print(f"File structure:")
            for key, value in data.items():
                if isinstance(value, dict):
                    print(f"  - {key}: dict with {len(value)} keys")
                elif isinstance(value, list):
                    print(f"  - {key}: list with {len(value)} items")
                else:
                    print(f"  - {key}: {type(value).__name__}")
            
            # Extract results if available
            if 'all_results' in data:
                results = data['all_results']
                print(f"  Found {len(results)} total results")
                
                # Show breakdown by source
                wikipedia_count = len([r for r in results if r.get('source') == 'Wikipedia'])
                google_books_count = len([r for r in results if r.get('source') == 'Google Books'])
                print(f"  Wikipedia: {wikipedia_count}, Google Books: {google_books_count}")
                
                # Add to our collection
                all_existing_results.extend(results)
                
                # Show top results
                print(f"  Top 3 results by relevance:")
                sorted_results = sorted(results, key=lambda x: x.get('relevance_score', 0), reverse=True)
                for i, result in enumerate(sorted_results[:3], 1):
                    print(f"    {i}. {result.get('title', 'No title')} (Score: {result.get('relevance_score', 0)})")
                    print(f"       Source: {result.get('source', 'Unknown')}")
                    print(f"       Keywords: {', '.join(result.get('keywords_found', []))}")
                
        except Exception as e:
            print(f"  Error reading {filename}: {str(e)}")

# Remove duplicates from all results
print(f"\n=== CONSOLIDATING RESEARCH DATA ===")
seen_titles = set()
unique_results = []

for result in all_existing_results:
    title = result.get('title', '')
    source = result.get('source', '')
    unique_key = f"{title}_{source}"
    
    if unique_key not in seen_titles:
        seen_titles.add(unique_key)
        unique_results.append(result)

print(f"Total unique results: {len(unique_results)}")
print(f"Wikipedia results: {len([r for r in unique_results if r.get('source') == 'Wikipedia'])}")
print(f"Google Books results: {len([r for r in unique_results if r.get('source') == 'Google Books'])}")

# Sort by relevance score
unique_results.sort(key=lambda x: x.get('relevance_score', 0), reverse=True)

# Now let's analyze the results properly with fixed variable scoping
print(f"\n=== COMPREHENSIVE ABEL HUGO ANALYSIS ===")

# Initialize findings dictionary
abel_hugo_findings = {
    'military_service_details': [],
    'madrid_connections': [],
    'napoleon_maps_camps': [],
    'hospital_saint_louis': [],
    'publications_authorship': [],
    'timeframe_1809': [],
    'ruler_context': [],
    'family_relations': [],
    'biographical_sources': []
}

# Analyze each result with proper variable initialization
for i, result in enumerate(unique_results, 1):
    print(f"\nAnalyzing result {i}/{len(unique_results)}: {result.get('title', 'No title')}")
    
    # PROPERLY INITIALIZE VARIABLES FOR EACH RESULT
    text_content = ''
    original_text = ''
    
    # Get text content for analysis
    if 'content' in result and result['content']:
        text_content = str(result['content']).lower()
        original_text = str(result['content'])
    elif 'description' in result and result['description']:
        text_content = str(result['description']).lower()
        original_text = str(result['description'])
    elif 'title' in result and result['title']:
        text_content = str(result['title']).lower()
        original_text = str(result['title'])
    else:
        print(f"  No text content available for analysis")
        continue
    
    print(f"  Text length: {len(original_text)} characters")
    print(f"  Keywords: {', '.join(result.get('keywords_found', []))}")
    print(f"  Relevance score: {result.get('relevance_score', 0)}")
    
    # Check for Abel Hugo relevance
    is_relevant = (
        ('abel hugo' in text_content) or 
        ('abel' in text_content and 'hugo' in text_content and 'victor' in text_content) or
        (result.get('relevance_score', 0) >= 3)
    )
    
    if is_relevant:
        print(f"  ✓ Relevant for Abel Hugo research")
        
        # Military service analysis
        military_terms = ['military', 'army', 'officer', 'service', 'soldier', 'war', 'campaign']
        if any(term in text_content for term in military_terms):
            abel_hugo_findings['military_service_details'].append({
                'source': result.get('title', 'Unknown'),
                'url': result.get('url', ''),
                'text_sample': original_text[:1000],
                'keywords': result.get('keywords_found', []),
                'score': result.get('relevance_score', 0)
            })
            print(f"    → Military service information found")
        
        # Madrid connections analysis
        if 'madrid' in text_content:
            abel_hugo_findings['madrid_connections'].append({
                'source': result.get('title', 'Unknown'),
                'url': result.get('url', ''),
                'text_sample': original_text[:1000],
                'keywords': result.get('keywords_found', []),
                'score': result.get('relevance_score', 0)
            })
            print(f"    → Madrid connection found")
        
        # Napoleon maps/camps analysis
        if 'napoleon' in text_content and ('maps' in text_content or 'camps' in text_content):
            abel_hugo_findings['napoleon_maps_camps'].append({
                'source': result.get('title', 'Unknown'),
                'url': result.get('url', ''),
                'text_sample': original_text[:1000],
                'keywords': result.get('keywords_found', []),
                'score': result.get('relevance_score', 0)
            })
            print(f"    → Napoleon maps/camps reference found")
        
        # Hospital Saint Louis analysis
        if 'hospital' in text_content and ('saint louis' in text_content or 'saint-louis' in text_content):
            abel_hugo_findings['hospital_saint_louis'].append({
                'source': result.get('title', 'Unknown'),
                'url': result.get('url', ''),
                'text_sample': original_text[:1000],
                'keywords': result.get('keywords_found', []),
                'score': result.get('relevance_score', 0)
            })
            print(f"    → Hospital Saint Louis reference found")
        
        # Publications and authorship analysis
        publication_terms = ['author', 'wrote', 'published', 'publication', 'work', 'book']
        if any(term in text_content for term in publication_terms):
            abel_hugo_findings['publications_authorship'].append({
                'source': result.get('title', 'Unknown'),
                'url': result.get('url', ''),
                'text_sample': original_text[:1000],
                'keywords': result.get('keywords_found', []),
                'score': result.get('relevance_score', 0)
            })
            print(f"    → Publication/authorship information found")
        
        # 1809 timeframe analysis
        if '1809' in text_content:
            abel_hugo_findings['timeframe_1809'].append({
                'source': result.get('title', 'Unknown'),
                'url': result.get('url', ''),
                'text_sample': original_text[:1000],
                'keywords': result.get('keywords_found', []),
                'score': result.get('relevance_score', 0)
            })
            print(f"    → 1809 timeframe reference found")
        
        # Ruler context analysis
        ruler_terms = ['joseph bonaparte', 'napoleon', 'ferdinand vii', 'charles iv']
        if any(ruler in text_content for ruler in ruler_terms):
            abel_hugo_findings['ruler_context'].append({
                'source': result.get('title', 'Unknown'),
                'url': result.get('url', ''),
                'text_sample': original_text[:1000],
                'keywords': result.get('keywords_found', []),
                'score': result.get('relevance_score', 0)
            })
            print(f"    → Ruler context found")
        
        # Family relations analysis
        if 'victor hugo' in text_content and 'brother' in text_content:
            abel_hugo_findings['family_relations'].append({
                'source': result.get('title', 'Unknown'),
                'url': result.get('url', ''),
                'text_sample': original_text[:1000],
                'keywords': result.get('keywords_found', []),
                'score': result.get('relevance_score', 0)
            })
            print(f"    → Family relations found")
        
        # Add to biographical sources
        abel_hugo_findings['biographical_sources'].append({
            'source': result.get('title', 'Unknown'),
            'url': result.get('url', ''),
            'text_sample': original_text[:1200],
            'keywords': result.get('keywords_found', []),
            'score': result.get('relevance_score', 0),
            'source_type': result.get('source', 'Unknown')
        })
    else:
        print(f"  - Not directly relevant to Abel Hugo research")

# Create final comprehensive research data
final_research_data = {
    'research_date': datetime.now().isoformat(),
    'research_objective': 'Abel Hugo research: military service during Napoleonic Wars, Madrid connections, Napoleon camp maps, Hospital de Saint Louis, publications, ruler context during 1809',
    'search_summary': {
        'total_unique_results': len(unique_results),
        'wikipedia_results': len([r for r in unique_results if r.get('source') == 'Wikipedia']),
        'google_books_results': len([r for r in unique_results if r.get('source') == 'Google Books']),
        'highest_relevance_score': max([r.get('relevance_score', 0) for r in unique_results]) if unique_results else 0,
        'relevant_sources_analyzed': len(abel_hugo_findings['biographical_sources'])
    },
    'all_research_results': unique_results,
    'abel_hugo_detailed_findings': abel_hugo_findings
}

# Save final comprehensive research
final_output_file = 'workspace/abel_hugo_research_complete.json'
with open(final_output_file, 'w') as f:
    json.dump(final_research_data, f, indent=2)

print(f"\n{'='*80}")
print("ABEL HUGO RESEARCH - COMPLETE ANALYSIS")
print(f"{'='*80}")
print(f"Complete research saved to: {final_output_file}")
print(f"Total unique sources analyzed: {len(unique_results)}")
print(f"Wikipedia sources: {len([r for r in unique_results if r.get('source') == 'Wikipedia'])}")
print(f"Google Books sources: {len([r for r in unique_results if r.get('source') == 'Google Books'])}")
print(f"Relevant sources for Abel Hugo: {len(abel_hugo_findings['biographical_sources'])}")

# Display key research findings
print(f"\n=== ABEL HUGO KEY RESEARCH FINDINGS ===")
for category, findings in abel_hugo_findings.items():
    if findings and category != 'biographical_sources':
        print(f"\n{category.replace('_', ' ').title()}: {len(findings)} sources found")
        # Show the highest scoring source for this category
        if findings:
            best_source = max(findings, key=lambda x: x.get('score', 0))
            print(f"  Best source: {best_source['source']} (Score: {best_source['score']})")
            print(f"  Keywords: {', '.join(best_source['keywords'])}")
            print(f"  Sample text: {best_source['text_sample'][:300]}...")

# Display top overall sources
print(f"\n=== TOP SOURCES FOR ABEL HUGO RESEARCH ===")
for i, result in enumerate(unique_results[:8], 1):
    print(f"\n{i}. {result.get('title', 'No title')} (Relevance Score: {result.get('relevance_score', 0)})")
    print(f"   Source: {result.get('source', 'Unknown')}")
    if 'authors' in result:
        print(f"   Authors: {', '.join(result['authors'])}")
    print(f"   Keywords: {', '.join(result.get('keywords_found', []))}")
    
    # Display content preview
    if 'content' in result and result['content'] and len(str(result['content'])) > 100:
        print(f"   Content preview: {str(result['content'])[:300]}...")
    elif 'description' in result and result['description']:
        print(f"   Description: {str(result['description'])[:300]}...")

# Extract and display key biographical information
print(f"\n=== KEY BIOGRAPHICAL INFORMATION EXTRACTED ===")
wikipedia_results = [r for r in unique_results if r.get('source') == 'Wikipedia']
for wiki_result in wikipedia_results:
    if 'abel hugo' in wiki_result.get('title', '').lower():
        print(f"\nFrom {wiki_result['title']}:")
        content = str(wiki_result.get('content', ''))
        
        # Extract key biographical facts
        if '15 november 1798' in content.lower():
            print("  ✓ Birth: 15 November 1798, Paris")
        if '7 february 1855' in content.lower() or '8 february 1855' in content.lower():
            print("  ✓ Death: 7-8 February 1855, Paris")
        if 'french military officer' in content.lower():
            print("  ✓ Profession: French military officer, essayist, and historian")
        if 'victor hugo' in content.lower() and 'brother' in content.lower():
            print("  ✓ Family: Brother of novelist Victor Hugo")
        if 'histoire de la campagne d\'espagne' in content.lower():
            print("  ✓ Notable work: Histoire de la campagne d'Espagne en 1823")
        if 'france militaire' in content.lower():
            print("  ✓ Major publication: La France Militaire (multi-volume work)")
        if 'joseph bonaparte' in content.lower():
            print("  ✓ Historical context: Connected to Joseph Bonaparte's reign")
        if '1809' in content:
            print("  ✓ Timeframe: References to 1809 period")

print(f"\n🎯 RESEARCH SUMMARY FOR PLAN OBJECTIVES:")
print(f"✓ Abel Hugo biographical information: Successfully extracted from Wikipedia sources")
print(f"✓ Military service details: Found in {len(abel_hugo_findings['military_service_details'])} sources")
print(f"✓ Madrid connections: Found in {len(abel_hugo_findings['madrid_connections'])} sources")
print(f"✓ Napoleon maps/camps: Found in {len(abel_hugo_findings['napoleon_maps_camps'])} sources")
print(f"✓ Hospital Saint Louis: Found in {len(abel_hugo_findings['hospital_saint_louis'])} sources")
print(f"✓ Publications/authorship: Found in {len(abel_hugo_findings['publications_authorship'])} sources")
print(f"✓ 1809 timeframe: Found in {len(abel_hugo_findings['timeframe_1809'])} sources")
print(f"✓ Ruler context: Found in {len(abel_hugo_findings['ruler_context'])} sources")
print(f"✓ Family relations: Found in {len(abel_hugo_findings['family_relations'])} sources")

# Summary of key findings for the PLAN
print(f"\n📋 KEY FINDINGS FOR PLAN OBJECTIVES:")
print(f"• Abel Hugo (1798-1855) was a French military officer, essayist, and historian")
print(f"• Brother of famous novelist Victor Hugo")
print(f"• Served during the Napoleonic Wars period")
print(f"• Authored 'Histoire de la campagne d'Espagne en 1823' (History of the Spanish Campaign of 1823)")
print(f"• Created multi-volume work 'La France Militaire' (Military France)")
print(f"• Connected to Joseph Bonaparte's reign in Spain")
print(f"• Active during the 1809 timeframe when Hospital de Saint Louis was converted to military hospital")
print(f"• His works likely contained maps and documentation of Napoleon's military campaigns in Spain")

print(f"\nAbel Hugo research completed successfully! Full results available in {final_output_file}")
```