### Development Step 3: Post-1977 20th-Century Malko Competition Winners: Names, Years, Nationalities (Including Defunct States)

**Description**: Search for comprehensive information about the Malko Competition, focusing on identifying all recipients from the 20th Century after 1977. Target these research approaches: (1) Official Malko Competition website or archives for complete winner lists, (2) Classical music databases and competition records, (3) Music journalism sources and historical archives, (4) Academic or institutional music resources. Extract complete recipient data including names, years of victory, and recorded nationalities. Pay special attention to nationalities that correspond to countries that no longer exist (such as USSR, Yugoslavia, Czechoslovakia, East Germany, etc.). Compile a systematic list of all post-1977 20th century winners with their nationality information for further analysis.

**Use Cases**:
- Automated compilation of Malko Competition winners by nationality for a musicology research paper on post-1977 European conductor trends
- Cultural heritage data enrichment in a digital library to tag and cross-reference 20th-century competition laureates
- Historical geopolitical analysis of USSR and Yugoslavian artists for a Cold War-era performing arts exhibition catalogue
- University curriculum development tool that aggregates real-world competition results to build case studies in conducting courses
- Classical music streaming platform feature that auto-generates artist profiles with competition wins and former-country origins
- Grant-writing support system for arts foundations, pre-filling applicant profiles with past prize data sorted by year and historical nationality
- Automated archival metadata creation for national music archives, extracting structured winner records from public web sources

```
import os
import json
from bs4 import BeautifulSoup
import re

print("=== MALKO COMPETITION PHASE 3: EXTRACTING WINNER DATA ===\n")
print("Objective: Parse Wikipedia HTML to extract winners from 1978-2000 with nationality data\n")

# Load the Wikipedia HTML file for detailed parsing
wikipedia_file = 'workspace/en_wikipedia_org_wiki_Malko_Competition.html'

if not os.path.exists(wikipedia_file):
    print(f"Wikipedia file not found: {wikipedia_file}")
    exit()

print(f"Loading Wikipedia content from: {wikipedia_file}")

with open(wikipedia_file, 'r', encoding='utf-8') as f:
    html_content = f.read()

soup = BeautifulSoup(html_content, 'html.parser')

print(f"HTML content loaded - {len(html_content)} characters")
print(f"Page title: {soup.find('title').get_text().strip() if soup.find('title') else 'No title found'}\n")

# Look for tables that might contain winner information
all_tables = soup.find_all('table')
print(f"Found {len(all_tables)} tables in the Wikipedia page\n")

# Analyze each table to identify winner lists
print("=== ANALYZING TABLES FOR WINNER DATA ===\n")

winner_tables = []
for i, table in enumerate(all_tables):
    print(f"Table {i+1}:")
    
    # Get table headers
    headers = table.find_all('th')
    header_texts = [th.get_text().strip() for th in headers]
    print(f"  Headers ({len(header_texts)}): {header_texts[:8]}")  # Show first 8 headers
    
    # Get first few rows to understand structure
    rows = table.find_all('tr')
    print(f"  Total rows: {len(rows)}")
    
    if len(rows) > 1:  # Has data rows beyond header
        # Sample first data row
        first_data_row = rows[1] if len(rows) > 1 else None
        if first_data_row:
            cells = first_data_row.find_all(['td', 'th'])
            cell_texts = [cell.get_text().strip() for cell in cells]
            print(f"  Sample row: {cell_texts[:6]}")  # First 6 columns
    
    # Check if table contains winner/year information
    table_text = table.get_text().lower()
    winner_indicators = ['winner', 'year', '19', 'conductor', 'prize', 'first', 'second', 'third']
    has_winner_content = any(indicator in table_text for indicator in winner_indicators)
    
    # Check for years in our target range (1978-2000)
    years_in_table = re.findall(r'19[7-9]\d|2000', table.get_text())
    target_years = [year for year in years_in_table if 1978 <= int(year) <= 2000]
    
    print(f"  Contains winner indicators: {has_winner_content}")
    print(f"  Years found in target range (1978-2000): {sorted(set(target_years))}")
    
    if has_winner_content and target_years:
        print(f"  *** TABLE {i+1} IDENTIFIED AS WINNER TABLE ***")
        winner_tables.append({
            'table_index': i,
            'table_element': table,
            'headers': header_texts,
            'row_count': len(rows),
            'target_years_found': sorted(set(target_years))
        })
    
    print()

print(f"Identified {len(winner_tables)} potential winner tables\n")

# Extract detailed winner information from identified tables
all_winners = []

for table_info in winner_tables:
    table_index = table_info['table_index']
    table = table_info['table_element']
    
    print(f"=== EXTRACTING FROM TABLE {table_index + 1} ===\n")
    print(f"Headers: {table_info['headers']}")
    print(f"Target years in this table: {table_info['target_years_found']}\n")
    
    rows = table.find_all('tr')
    
    # Process each row to extract winner data
    for row_idx, row in enumerate(rows):
        cells = row.find_all(['td', 'th'])
        
        if len(cells) >= 2:  # Need at least 2 columns for meaningful data
            cell_texts = [cell.get_text().strip() for cell in cells]
            row_text = ' '.join(cell_texts)
            
            # Look for years in our target range
            years_in_row = re.findall(r'19[7-9]\d|2000', row_text)
            target_years_in_row = [year for year in years_in_row if 1978 <= int(year) <= 2000]
            
            if target_years_in_row:
                print(f"Row {row_idx}: {cell_texts}")
                
                # Extract potential winner information
                # Look for names (capitalize words), countries, and years
                
                # Find potential names (words that start with capital letters)
                potential_names = []
                for cell_text in cell_texts:
                    # Look for patterns like "FirstName LastName" or "LastName, FirstName"
                    name_patterns = re.findall(r'[A-Z][a-z]+\s+[A-Z][a-z]+|[A-Z][a-z]+,\s*[A-Z][a-z]+', cell_text)
                    potential_names.extend(name_patterns)
                
                # Look for countries/nationalities
                country_keywords = ['USSR', 'Soviet', 'Yugoslavia', 'Czechoslovakia', 'East Germany', 'GDR', 'Hungary', 'Poland', 'Bulgaria', 'Romania', 'Finland', 'Denmark', 'Sweden', 'Norway', 'Germany', 'Austria', 'France', 'Italy', 'Spain', 'UK', 'Britain', 'USA', 'Japan', 'Israel']
                found_countries = []
                
                for country in country_keywords:
                    if country.lower() in row_text.lower():
                        found_countries.append(country)
                
                # Store extracted information
                for year in target_years_in_row:
                    winner_entry = {
                        'table_index': table_index + 1,
                        'row_index': row_idx,
                        'year': int(year),
                        'raw_row_data': cell_texts,
                        'potential_names': potential_names,
                        'countries_found': found_countries,
                        'full_text': row_text
                    }
                    all_winners.append(winner_entry)
                    
                    print(f"  -> Year: {year}")
                    print(f"  -> Potential names: {potential_names}")
                    print(f"  -> Countries: {found_countries}")
                    print(f"  -> Full text: {row_text[:100]}...")
                    print()

print(f"\n=== EXTRACTED WINNER DATA SUMMARY ===\n")
print(f"Total entries extracted: {len(all_winners)}")

# Sort by year
all_winners_sorted = sorted(all_winners, key=lambda x: x['year'])

# Group by year and display
years_found = sorted(set([w['year'] for w in all_winners]))
print(f"Years covered: {years_found}")
print(f"Year range: {min(years_found) if years_found else 'None'} - {max(years_found) if years_found else 'None'}\n")

# Display detailed results
print("=== DETAILED WINNER INFORMATION ===\n")

for year in years_found:
    year_winners = [w for w in all_winners_sorted if w['year'] == year]
    print(f"**{year}:**")
    
    for winner in year_winners:
        print(f"  Names: {winner['potential_names']}")
        print(f"  Countries: {winner['countries_found']}")
        print(f"  Source row: {winner['raw_row_data']}")
        print()

# Focus on historical countries that no longer exist
historical_countries = ['USSR', 'Soviet', 'Yugoslavia', 'Czechoslovakia', 'East Germany', 'GDR']
historical_winners = []

for winner in all_winners:
    historical_found = [country for country in winner['countries_found'] if country in historical_countries]
    if historical_found:
        historical_winners.append({
            'year': winner['year'],
            'names': winner['potential_names'],
            'historical_countries': historical_found,
            'full_data': winner
        })

print(f"\n=== WINNERS FROM HISTORICAL COUNTRIES (USSR, Yugoslavia, etc.) ===\n")
print(f"Found {len(historical_winners)} winners from historical countries\n")

for hw in sorted(historical_winners, key=lambda x: x['year']):
    print(f"{hw['year']}: {hw['names']} - {hw['historical_countries']}")

# Save complete results
results = {
    'competition': 'Malko Competition',
    'search_period': '1978-2000 (post-1977 20th Century)',
    'extraction_timestamp': time.strftime('%Y-%m-%d %H:%M:%S'),
    'source': 'Wikipedia - Malko Competition page',
    'total_entries_found': len(all_winners),
    'years_covered': years_found,
    'historical_country_winners': len(historical_winners),
    'complete_winner_data': all_winners_sorted,
    'historical_countries_focus': historical_winners
}

with open('workspace/malko_winners_1978_2000.json', 'w') as f:
    json.dump(results, f, indent=2)

print(f"\n=== EXTRACTION COMPLETE ===\n")
print(f"Complete results saved to: workspace/malko_winners_1978_2000.json")
print(f"Total winner entries: {len(all_winners)}")
print(f"Years covered: {len(years_found)} years ({min(years_found) if years_found else 'None'} - {max(years_found) if years_found else 'None'})")
print(f"Historical country winners: {len(historical_winners)}")
```