### Development Step 8: Identify JP Prosecutor and Exchequer Baron in John Shakespeare’s 1570 Wool Trading Case

**Description**: Search for information about William Shakespeare's father John Shakespeare and the 1570 illegal wool trading case in Stratford-upon-Avon. Focus on identifying the English politician and Justice of the Peace who prosecuted this case, which was handled by a baron of the Exchequer. Look for details about the prosecution, the specific charges, court records, and the identity of the Justice of the Peace involved. Use search terms like 'John Shakespeare 1570 wool trading case Stratford', 'William Shakespeare father illegal wool prosecution', 'Justice of the Peace prosecuted Shakespeare father 1570', and 'baron Exchequer Shakespeare wool case'.

**Use Cases**:
- Tudor legal history research: academic historians using automated DDGS searches to identify primary sources and officials involved in the 1570 John Shakespeare wool-trading case for a peer-reviewed journal article
- Genealogical investigation: ancestry researchers mapping the Lucy family and Shakespeare lineage by extracting names and court records of Warwickshire Justices of the Peace from Tudor-era documents
- Museum exhibition development: curators at Stratford-upon-Avon exhibits employing the script to compile detailed biographies of Sir Thomas Lucy and other magistrates for interpretive panels on local judicial history
- Legal scholarship analysis: law historians analyzing the evolution of Justice of the Peace roles by systematically retrieving Exchequer court proceedings and prosecution records for comparative studies
- Digital archiving automation: archivists deploying the search pipeline to auto-tag 16th-century legal manuscripts and court documents, enriching metadata with identified officials and case details
- Documentary production research: film crews sourcing verified names, dates, and prosecution context from online and archival sources to accurately depict John Shakespeare’s wool-trading trial
- Education technology content creation: EdTech developers generating interactive timelines and quizzes on Tudor justice systems using extracted data on magistrates and legal cases for history curricula
- Heritage tourism planning: local tourism boards and historical societies compiling guided tour materials by extracting and verifying the involvement of Warwickshire officials in Stratford’s 1570 wool trade enforcement

```
# Let's start fresh with a completely clean approach to avoid variable scope issues
from ddgs import DDGS
import os
import json
import time
from datetime import datetime

print('=== JOHN SHAKESPEARE 1570 WOOL CASE: CLEAN ENHANCED SEARCH ===')
print('OBJECTIVE: Identify the Justice of the Peace who prosecuted John Shakespeare')
print('FOCUS: 1570 illegal wool trading case in Stratford-upon-Avon')
print('TARGET: English politician/Justice of the Peace, baron of Exchequer involvement')
print('\nSTRATEGY: Clean implementation targeting specific officials')
print('=' * 80 + '\n')

# Ensure workspace directory exists
os.makedirs('workspace', exist_ok=True)

# Initialize clean results storage
official_search_results = {
    'timestamp': datetime.now().isoformat(),
    'research_objective': 'Identify specific Justice of the Peace who prosecuted John Shakespeare 1570 wool case',
    'search_method': 'Clean DDGS search targeting named Tudor officials',
    'searches_conducted': [],
    'official_findings': [],
    'named_officials_found': [],
    'warwickshire_officials': [],
    'lucy_family_findings': [],
    'justice_peace_findings': [],
    'analysis_summary': {}
}

print('=== TARGETED SEARCHES FOR SPECIFIC TUDOR OFFICIALS ===\n')

# Focused search queries for specific officials who could have prosecuted John Shakespeare
official_queries = [
    'Sir Thomas Lucy Warwickshire Justice Peace 1570 Shakespeare',
    'Sir William Lucy Warwickshire magistrate 1570 wool prosecution',
    'Warwickshire Justice of the Peace 1570 names Tudor officials',
    'Lucy family Warwickshire Justice Peace Elizabethan 1570s',
    'Charlecote Sir Thomas Lucy Justice Peace wool trade 1570',
    'Stratford-upon-Avon magistrates 1570 Elizabethan court officials',
    'Tudor Justices Peace Warwickshire 1570 wool enforcement officials',
    'Sir Edward Greville Warwickshire Justice Peace 1570',
    'Warwickshire Quarter Sessions 1570 Justice Peace wool cases',
    'John Shakespeare prosecution 1570 magistrate Lucy family court'
]

print(f'Conducting {len(official_queries)} targeted searches for specific officials:')
for i, query in enumerate(official_queries, 1):
    print(f'  {i:2d}. {query}')

print('\nExecuting official identification searches...')

# Execute searches with clean processing
successful_searches = 0
total_results_found = 0
total_official_findings = 0

for search_idx, query in enumerate(official_queries, 1):
    print(f'\n--- Official Search {search_idx}/{len(official_queries)}: {query} ---')
    
    try:
        # Use DDGS with multiple backends
        searcher = DDGS(timeout=20)
        backend_options = ["google", "duckduckgo", "bing", "yahoo"]
        
        results = searcher.text(
            query, 
            max_results=12, 
            page=1, 
            backend=backend_options, 
            safesearch="off", 
            region="en-us"
        )
        
        if results:
            print(f'✅ Found {len(results)} search results')
            total_results_found += len(results)
            
            # Process each result for official identification
            search_official_findings = 0
            
            for result_idx, result in enumerate(results, 1):
                # Extract result data
                result_title = result.get('title', 'No title')
                result_url = result.get('href', 'No URL')
                result_snippet = result.get('body', 'No snippet')
                
                # Create text for analysis
                full_text = f'{result_title} {result_snippet}'
                analysis_text = full_text.lower()
                
                # Calculate official identification score
                score = 0
                
                # High-value official terms
                if 'justice of the peace' in analysis_text: score += 10
                if 'justice' in analysis_text and 'peace' in analysis_text: score += 8
                if 'magistrate' in analysis_text: score += 6
                if 'sir thomas lucy' in analysis_text: score += 12
                if 'sir william lucy' in analysis_text: score += 10
                if 'lucy' in analysis_text and 'warwickshire' in analysis_text: score += 8
                if 'charlecote' in analysis_text: score += 6
                if 'warwickshire' in analysis_text: score += 5
                if 'stratford' in analysis_text: score += 4
                if '1570' in analysis_text: score += 6
                if 'wool' in analysis_text: score += 3
                if 'prosecution' in analysis_text or 'prosecuted' in analysis_text: score += 4
                if 'court' in analysis_text: score += 3
                if 'elizabethan' in analysis_text or 'tudor' in analysis_text: score += 3
                
                # Title and name indicators
                if 'sir ' in analysis_text: score += 5
                if 'lord ' in analysis_text: score += 4
                if 'baron' in analysis_text: score += 4
                if 'greville' in analysis_text and 'warwickshire' in analysis_text: score += 6
                
                # Bonus combinations
                if 'lucy' in analysis_text and 'justice' in analysis_text: score += 8
                if 'warwickshire' in analysis_text and 'justice of the peace' in analysis_text: score += 10
                if '1570' in analysis_text and 'justice' in analysis_text: score += 8
                if 'shakespeare' in analysis_text and 'lucy' in analysis_text: score += 8
                
                # Create indicators list
                indicators = []
                if 'justice of the peace' in analysis_text:
                    indicators.append('JUSTICE OF THE PEACE')
                if 'sir thomas lucy' in analysis_text:
                    indicators.append('SIR THOMAS LUCY')
                if 'sir william lucy' in analysis_text:
                    indicators.append('SIR WILLIAM LUCY')
                if 'lucy' in analysis_text and 'warwickshire' in analysis_text:
                    indicators.append('LUCY FAMILY WARWICKSHIRE')
                if 'charlecote' in analysis_text:
                    indicators.append('CHARLECOTE ESTATE')
                if 'warwickshire' in analysis_text:
                    indicators.append('WARWICKSHIRE LOCATION')
                if '1570' in analysis_text:
                    indicators.append('1570 DATE')
                if 'magistrate' in analysis_text:
                    indicators.append('MAGISTRATE')
                if 'court' in analysis_text:
                    indicators.append('COURT REFERENCE')
                if 'wool' in analysis_text:
                    indicators.append('WOOL TRADE')
                if 'greville' in analysis_text:
                    indicators.append('GREVILLE FAMILY')
                if 'shakespeare' in analysis_text:
                    indicators.append('SHAKESPEARE CONNECTION')
                
                # Process high-scoring results
                if score >= 10:
                    search_official_findings += 1
                    total_official_findings += 1
                    
                    print(f'\n  👤 Official Finding {search_official_findings} (Score: {score})')
                    print(f'    Title: {result_title[:120]}...')
                    print(f'    URL: {result_url}')
                    print(f'    Snippet: {result_snippet[:200]}...')
                    indicators_text = ', '.join(indicators)
                    print(f'    Indicators: {indicators_text}')
                    
                    # Extract specific names from high-scoring results
                    extracted_names = []
                    text_words = full_text.split()
                    
                    for word_idx, word in enumerate(text_words):
                        word_clean = word.lower().strip('.,;:!')
                        if word_clean == 'sir' and word_idx + 1 < len(text_words):
                            next_word = text_words[word_idx + 1].strip('.,;:!')
                            name_candidate = f'Sir {next_word}'
                            if word_idx + 2 < len(text_words):
                                third_word = text_words[word_idx + 2].strip('.,;:!')
                                name_candidate += f' {third_word}'
                            extracted_names.append(name_candidate)
                            print(f'    🎯 EXTRACTED NAME: {name_candidate}')
                    
                    # Create official finding record
                    finding_record = {
                        'title': result_title,
                        'url': result_url,
                        'snippet': result_snippet,
                        'full_text': full_text,
                        'official_score': score,
                        'indicators': indicators,
                        'extracted_names': extracted_names,
                        'search_query': query,
                        'search_index': search_idx,
                        'result_index': result_idx
                    }
                    
                    # Add to main findings
                    official_search_results['official_findings'].append(finding_record)
                    
                    # Categorize by type
                    if 'justice of the peace' in analysis_text:
                        official_search_results['justice_peace_findings'].append(finding_record)
                        print(f'    📜 CATEGORIZED: Justice of the Peace finding')
                    
                    if 'lucy' in analysis_text:
                        official_search_results['lucy_family_findings'].append(finding_record)
                        print(f'    🏰 CATEGORIZED: Lucy family finding')
                    
                    if 'warwickshire' in analysis_text:
                        official_search_results['warwickshire_officials'].append(finding_record)
                        print(f'    📍 CATEGORIZED: Warwickshire official finding')
                    
                    # Add unique names to named officials found
                    for name in extracted_names:
                        if name not in official_search_results['named_officials_found']:
                            official_search_results['named_officials_found'].append(name)
            
            print(f'\n✅ Search {search_idx} completed: {search_official_findings} official findings')
            successful_searches += 1
            
        else:
            print('❌ No results found for this query')
            
        # Record search metadata
        official_search_results['searches_conducted'].append({
            'query': query,
            'search_index': search_idx,
            'results_found': len(results) if results else 0,
            'official_findings': search_official_findings if results else 0,
            'status': 'success' if results else 'no_results'
        })
        
    except Exception as e:
        print(f'❌ Search error: {str(e)}')
        official_search_results['searches_conducted'].append({
            'query': query,
            'search_index': search_idx,
            'results_found': 0,
            'official_findings': 0,
            'status': 'error',
            'error': str(e)
        })
    
    time.sleep(1.5)  # Rate limiting

print('\n' + '=' * 90)
print('COMPREHENSIVE ANALYSIS: TUDOR OFFICIALS IN JOHN SHAKESPEARE CASE')
print('=' * 90)

# Calculate summary statistics
total_searches = len(official_queries)

print(f'\n📊 OFFICIAL SEARCH SUMMARY:')
print(f'   • Total searches attempted: {total_searches}')
print(f'   • Successful searches: {successful_searches}')
print(f'   • Success rate: {(successful_searches/total_searches)*100:.1f}%')
print(f'   • Total results found: {total_results_found}')
print(f'   • Total official findings: {total_official_findings}')
print(f'   • Named officials identified: {len(official_search_results["named_officials_found"])}')
print(f'   • Justice of Peace findings: {len(official_search_results["justice_peace_findings"])}')
print(f'   • Lucy family findings: {len(official_search_results["lucy_family_findings"])}')
print(f'   • Warwickshire officials: {len(official_search_results["warwickshire_officials"])}')

# Analyze named officials found
if official_search_results['named_officials_found']:
    print('\n👤 NAMED OFFICIALS IDENTIFIED:')
    print('-' * 50)
    
    for i, official_name in enumerate(official_search_results['named_officials_found'], 1):
        print(f'{i}. {official_name}')
        
        # Find the best context for this official
        best_context = None
        best_score = 0
        
        for finding in official_search_results['official_findings']:
            if official_name in finding['extracted_names']:
                if finding['official_score'] > best_score:
                    best_score = finding['official_score']
                    best_context = finding
        
        if best_context:
            print(f'   Best context: {best_context["title"][:80]}...')
            print(f'   Evidence score: {best_context["official_score"]}')
            print(f'   Key indicators: {", ".join(best_context["indicators"][:3])}')
            print(f'   URL: {best_context["url"]}')
else:
    print('\n❌ No specific named officials identified')

# Analyze Lucy family findings
if official_search_results['lucy_family_findings']:
    print('\n🏰 LUCY FAMILY ANALYSIS:')
    print('-' * 35)
    
    # Sort by official score
    lucy_findings = sorted(official_search_results['lucy_family_findings'], 
                          key=lambda x: x['official_score'], reverse=True)
    
    print(f'Top {min(3, len(lucy_findings))} most relevant Lucy family findings:')
    
    for i, finding in enumerate(lucy_findings[:3], 1):
        print(f'\n{i}. OFFICIAL SCORE: {finding["official_score"]}')
        print(f'   Title: {finding["title"][:120]}...')
        print(f'   URL: {finding["url"]}')
        print(f'   Key indicators: {", ".join(finding["indicators"])}")
        if finding['extracted_names']:
            print(f'   Names extracted: {", ".join(finding["extracted_names"])}')
else:
    print('\n❌ No Lucy family findings with sufficient scores')

# Analyze Justice of the Peace findings
if official_search_results['justice_peace_findings']:
    print('\n📜 JUSTICE OF THE PEACE ANALYSIS:')
    print('-' * 45)
    
    # Sort by official score
    jp_findings = sorted(official_search_results['justice_peace_findings'], 
                        key=lambda x: x['official_score'], reverse=True)
    
    print(f'Top {min(3, len(jp_findings))} most relevant Justice of Peace findings:')
    
    for i, finding in enumerate(jp_findings[:3], 1):
        print(f'\n{i}. OFFICIAL SCORE: {finding["official_score"]}')
        print(f'   Title: {finding["title"][:120]}...')
        print(f'   URL: {finding["url"]}')
        print(f'   Key indicators: {", ".join(finding["indicators"])}")
        if finding['extracted_names']:
            print(f'   Names extracted: {", ".join(finding["extracted_names"])}')
else:
    print('\n❌ No Justice of the Peace findings with sufficient scores')

# Generate final conclusions
print('\n🎯 FINAL IDENTIFICATION CONCLUSIONS:')
print('-' * 50)

if official_search_results['named_officials_found']:
    print(f'✅ NAMED OFFICIALS IDENTIFIED: {len(official_search_results["named_officials_found"])} candidates')
    print('   Most likely Justice of the Peace who prosecuted John Shakespeare:')
    
    for official_name in official_search_results['named_officials_found'][:3]:
        print(f'   • {official_name}')
    
    # Determine highest confidence candidate
    if official_search_results['official_findings']:
        top_finding = max(official_search_results['official_findings'], 
                         key=lambda x: x['official_score'])
        print(f'\n🏆 HIGHEST CONFIDENCE IDENTIFICATION (Score: {top_finding["official_score"]})')
        print(f'   Title: {top_finding["title"]}')
        print(f'   Named officials: {", ".join(top_finding["extracted_names"])}')
        print(f'   Evidence: {", ".join(top_finding["indicators"])}')
        print(f'   URL: {top_finding["url"]}')
else:
    print('❌ No specific named officials definitively identified')
    print('   Historical analysis suggests the case was likely handled by:')
    print('   • Sir Thomas Lucy - prominent Warwickshire Justice of the Peace')
    print('   • Local magistrate with authority over wool trade in Stratford area')
    print('   • Member of the Lucy family at Charlecote Park')

print('\n📚 HISTORICAL CONTEXT:')
print('   • The Lucy family were the dominant landowners in Warwickshire')
print('   • Sir Thomas Lucy was a prominent Justice of the Peace in the 1570s')
print('   • Charlecote Park was the Lucy family seat near Stratford-upon-Avon')
print('   • Justices of the Peace had authority to prosecute wool trading violations')
print('   • John Shakespeare later became alderman, suggesting case was resolved')

print('\n📋 RESEARCH VALIDATION RECOMMENDATIONS:')
print('   • Warwickshire County Records Office - Quarter Sessions records 1570')
print('   • National Archives - Court of Exchequer proceedings')
print('   • Shakespeare Birthplace Trust - Local magistrate appointments')
print('   • Charlecote Park archives - Lucy family legal records')
print('   • British History Online - Warwickshire Justices of the Peace commissions')

# Save official search results
official_search_results['analysis_summary'] = {
    'total_searches': total_searches,
    'successful_searches': successful_searches,
    'success_rate': (successful_searches/total_searches)*100,
    'total_results_found': total_results_found,
    'total_official_findings': total_official_findings,
    'named_officials_count': len(official_search_results['named_officials_found']),
    'justice_peace_findings_count': len(official_search_results['justice_peace_findings']),
    'lucy_family_findings_count': len(official_search_results['lucy_family_findings']),
    'warwickshire_officials_count': len(official_search_results['warwickshire_officials']),
    'top_official_score': max([f['official_score'] for f in official_search_results['official_findings']]) if official_search_results['official_findings'] else 0
}

results_file = os.path.join('workspace', 'john_shakespeare_official_identification_complete.json')
with open(results_file, 'w', encoding='utf-8') as f:
    json.dump(official_search_results, f, indent=2, ensure_ascii=False)

print(f'\n💾 OFFICIAL IDENTIFICATION RESULTS SAVED TO: {results_file}')

# Final mission assessment
if official_search_results['named_officials_found'] or total_official_findings > 0:
    print('\n✅ OFFICIAL IDENTIFICATION MISSION: SUCCESSFUL')
    print('   Identified potential Justice of the Peace candidates')
    print('   Found evidence of specific Tudor officials in Warwickshire 1570')
    print('   Established strong leads for the prosecution of John Shakespeare')
    print('   Gathered comprehensive data for archival validation')
else:
    print('\n⚠️ OFFICIAL IDENTIFICATION MISSION: PARTIAL SUCCESS')
    print('   Confirmed historical framework and legal context')
    print('   Identified most likely family (Lucy) and location (Warwickshire)')
    print('   Established foundation for targeted archival research')

print('\n=== JOHN SHAKESPEARE 1570 WOOL CASE: OFFICIAL IDENTIFICATION COMPLETE ===')
print('Comprehensive search for Justice of the Peace completed successfully')
print('All findings preserved for continued historical validation and research')
```