### Development Step 2: Extract and Analyze Fast-Food Chain Sales by City from Excel; Compare Wharvton vs Algrimand Totals

**Description**: Parse and analyze the attached Excel file data/gaia/2023/validation/7cc4acfa-63fd-4acc-a1a1-e8e529e0a97f.xlsx to extract all sales data for the regional fast-food chain menu items by city location. Identify the data structure including column headers and city organization, then calculate the total sales for Wharvton and Algrimand specifically to determine which city had greater total sales.

**Use Cases**:
- Retail chain monthly revenue auditing for two flagship outlets using Excel-driven sales extraction and automated JSON reporting to optimize local marketing spend
- Food delivery platform comparing average order values across two metropolitan zones by parsing order logs in spreadsheets and generating side-by-side sales breakdowns
- Pharmaceutical distributor analyzing prescription volume and revenue in two regional pharmacies via automated Excel parsing to identify stock-replenishment priorities
- University campus dining services comparing meal-plan purchases between North and South campuses by extracting menu-item sales from spreadsheets to balance kitchen staffing
- Vehicle rental operator assessing daily rental income and fleet utilization at two city depots through Excel data analysis and programmatic sales comparison for asset reallocation
- Non-profit organization evaluating donation totals from two signature fundraising galas by parsing contribution spreadsheets and exporting summary insights for donor relations
- E-commerce fulfillment team comparing product sales velocities in two regional warehouses via automated spreadsheet ingestion and JSON summary reports to streamline restocking
- Sports franchise analyzing merchandise and concession revenue at home vs. away stadiums by extracting itemized sales from Excel files and programmatically determining lead location

```
import os
import pandas as pd
from openpyxl import load_workbook
import json

# The path to the Excel file to be analyzed
xlsx_path = "data/gaia/2023/validation/7cc4acfa-63fd-4acc-a1a1-e8e529e0a97f.xlsx"

print("=== CALCULATING TOTAL SALES FOR WHARVTON AND ALGRIMAND ===\n")
print(f"Analyzing file: {xlsx_path}")

# Load the Excel file with pandas for complete data extraction
print("\nLoading complete dataset with pandas...")
df = pd.read_excel(xlsx_path)

print(f"Dataset shape: {df.shape}")
print(f"Column names: {list(df.columns)}")

# Display the complete dataset
print("\n=== COMPLETE DATASET ===")
print(df.to_string(index=False))

# Extract sales data specifically for Wharvton and Algrimand
print("\n" + "="*60)
print("EXTRACTING TARGET CITY SALES DATA")
print("="*60)

# Get menu item columns (exclude Location column)
menu_columns = [col for col in df.columns if col != 'Location']
print(f"\nMenu item columns: {menu_columns}")

# Find Wharvton data
wharvton_row = df[df['Location'] == 'Wharvton']
if not wharvton_row.empty:
    print(f"\n=== WHARVTON SALES DATA ===")
    print(f"Location: Wharvton")
    
    wharvton_sales = {}
    wharvton_total = 0
    
    for item in menu_columns:
        sales_value = wharvton_row[item].iloc[0]
        wharvton_sales[item] = sales_value
        wharvton_total += sales_value
        print(f"  {item}: ${sales_value:,.0f}")
    
    print(f"  WHARVTON TOTAL SALES: ${wharvton_total:,.0f}")
else:
    print("ERROR: Wharvton data not found!")
    wharvton_total = 0

# Find Algrimand data
algrimand_row = df[df['Location'] == 'Algrimand']
if not algrimand_row.empty:
    print(f"\n=== ALGRIMAND SALES DATA ===")
    print(f"Location: Algrimand")
    
    algrimand_sales = {}
    algrimand_total = 0
    
    for item in menu_columns:
        sales_value = algrimand_row[item].iloc[0]
        algrimand_sales[item] = sales_value
        algrimand_total += sales_value
        print(f"  {item}: ${sales_value:,.0f}")
    
    print(f"  ALGRIMAND TOTAL SALES: ${algrimand_total:,.0f}")
else:
    print("ERROR: Algrimand data not found!")
    algrimand_total = 0

# Compare the two cities
print("\n" + "="*60)
print("SALES COMPARISON RESULTS")
print("="*60)

print(f"\nWharvton Total Sales: ${wharvton_total:,.0f}")
print(f"Algrimand Total Sales: ${algrimand_total:,.0f}")

# Determine which city had greater total sales
if wharvton_total > algrimand_total:
    winner = "Wharvton"
    difference = wharvton_total - algrimand_total
    print(f"\n*** WINNER: WHARVTON ***")
    print(f"Wharvton had greater total sales by ${difference:,.0f}")
elif algrimand_total > wharvton_total:
    winner = "Algrimand"
    difference = algrimand_total - wharvton_total
    print(f"\n*** WINNER: ALGRIMAND ***")
    print(f"Algrimand had greater total sales by ${difference:,.0f}")
else:
    winner = "TIE"
    print(f"\n*** RESULT: TIE ***")
    print(f"Both cities had exactly the same total sales: ${wharvton_total:,.0f}")

# Create detailed analysis report
analysis_report = {
    'dataset_info': {
        'file_path': xlsx_path,
        'shape': df.shape,
        'columns': list(df.columns)
    },
    'menu_items': menu_columns,
    'wharvton_data': {
        'total_sales': int(wharvton_total),
        'item_breakdown': {item: int(wharvton_row[item].iloc[0]) for item in menu_columns} if not wharvton_row.empty else {}
    },
    'algrimand_data': {
        'total_sales': int(algrimand_total),
        'item_breakdown': {item: int(algrimand_row[item].iloc[0]) for item in menu_columns} if not algrimand_row.empty else {}
    },
    'comparison_results': {
        'wharvton_total': int(wharvton_total),
        'algrimand_total': int(algrimand_total),
        'winner': winner,
        'difference': int(abs(wharvton_total - algrimand_total))
    }
}

# Save comprehensive analysis
with open('workspace/city_sales_comparison.json', 'w') as f:
    json.dump(analysis_report, f, indent=2)

print(f"\nComprehensive analysis saved to: workspace/city_sales_comparison.json")

# Also save a summary report
with open('workspace/sales_comparison_summary.txt', 'w') as f:
    f.write("REGIONAL FAST-FOOD CHAIN - CITY SALES COMPARISON\n")
    f.write("="*60 + "\n\n")
    f.write(f"Dataset: {os.path.basename(xlsx_path)}\n")
    f.write(f"Cities analyzed: Wharvton vs Algrimand\n")
    f.write(f"Menu items: {len(menu_columns)}\n\n")
    
    f.write("SALES BREAKDOWN:\n")
    f.write(f"Wharvton Total Sales: ${wharvton_total:,.0f}\n")
    f.write(f"Algrimand Total Sales: ${algrimand_total:,.0f}\n\n")
    
    f.write("FINAL RESULT:\n")
    if winner == "TIE":
        f.write(f"Result: TIE - Both cities had exactly ${wharvton_total:,.0f} in total sales\n")
    else:
        f.write(f"Winner: {winner}\n")
        f.write(f"Difference: ${abs(wharvton_total - algrimand_total):,.0f}\n")

print(f"Sales comparison summary saved to: workspace/sales_comparison_summary.txt")

print("\n*** FINAL ANSWER ***")
print(f"Wharvton Total Sales: ${wharvton_total:,.0f}")
print(f"Algrimand Total Sales: ${algrimand_total:,.0f}")
if winner != "TIE":
    print(f"ANSWER: {winner} had greater total sales")
else:
    print(f"ANSWER: Both cities had equal total sales")
```