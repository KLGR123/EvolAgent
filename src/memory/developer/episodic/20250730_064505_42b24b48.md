### Development Step 1: Extract Fast-Food Chain Sales by City; Compare Wharvton and Algrimand Totals

**Description**: Parse and analyze the attached Excel file data/gaia/2023/validation/7cc4acfa-63fd-4acc-a1a1-e8e529e0a97f.xlsx to extract all sales data for the regional fast-food chain menu items by city location. Identify the data structure including column headers and city organization, then calculate the total sales for Wharvton and Algrimand specifically to determine which city had greater total sales.

**Use Cases**:
- Automated regional franchise performance monitoring by extracting monthly sales of burgers, fries, and drinks in Wharvton and Algrimand to generate city-level revenue comparisons for management dashboards
- Inventory restocking optimization by parsing daily Excel sales reports from each location and calculating turnover rates to trigger automated supply orders in high-demand cities
- Marketing campaign ROI evaluation by analyzing pre- and post-promotion menu item sales in Wharvton and Algrimand to quantify the impact of targeted advertising efforts
- Financial audit compliance checks by aggregating city-level sales data across multiple workbooks and reconciling reported totals for Wharvton and Algrimand against corporate ledgers
- Menu engineering insights by summarizing item-level performance in Algrimand and Wharvton to identify top-selling sandwiches and salads for recipe refinement and upsell strategies
- Franchise expansion feasibility study by comparing year-to-date sales metrics between Wharvton and Algrimand to evaluate potential profitability of a new nearby outlet
- Supply chain risk monitoring by detecting sudden drops in weekly sales for Wharvton and Algrimand to proactively reroute distributions during logistical disruptions
- Public health research support by providing consumption statistics of fast-food menu items from Wharvton and Algrimand to academic studies on regional dietary patterns

```
import os
import pandas as pd
from openpyxl import load_workbook
import json

# The path to the Excel file to be analyzed
xlsx_path = "data/gaia/2023/validation/7cc4acfa-63fd-4acc-a1a1-e8e529e0a97f.xlsx"

print("=== REGIONAL FAST-FOOD CHAIN SALES DATA ANALYSIS ===\n")
print(f"Analyzing file: {xlsx_path}")

# Check if file exists
if not os.path.exists(xlsx_path):
    print(f"Error: Excel file '{xlsx_path}' does not exist.")
    exit()

print(f"File exists: {xlsx_path}")
file_size = os.path.getsize(xlsx_path)
print(f"File size: {file_size} bytes")

# Load workbook with openpyxl to examine structure and formatting
print("\nLoading workbook with openpyxl to examine structure...")
wb = load_workbook(xlsx_path, data_only=True)  # Use data_only=True to get calculated values

print(f"Number of worksheets: {len(wb.worksheets)}")
print(f"Worksheet names: {[sheet.title for sheet in wb.worksheets]}")

# Examine each worksheet
for sheet_idx, sheet in enumerate(wb.worksheets):
    print(f"\n=== ANALYZING WORKSHEET: {sheet.title} ===")
    
    max_row = sheet.max_row
    max_col = sheet.max_column
    print(f"Sheet dimensions: {max_row} rows x {max_col} columns")
    
    # Get the range of actual data
    min_row = sheet.min_row
    min_col = sheet.min_column
    print(f"Data range: rows {min_row}-{max_row}, columns {min_col}-{max_col}")
    
    print("\n=== FIRST 15 ROWS PREVIEW ===")
    # Display first 15 rows to understand structure
    for row in range(min_row, min(max_row + 1, min_row + 15)):
        row_data = []
        for col in range(min_col, max_col + 1):
            cell = sheet.cell(row=row, column=col)
            cell_value = cell.value if cell.value is not None else ""
            row_data.append(str(cell_value))
        print(f"Row {row}: {row_data}")
    
    print("\n=== COLUMN HEADERS ANALYSIS ===")
    # Examine the first row as potential headers
    headers = []
    for col in range(min_col, max_col + 1):
        cell = sheet.cell(row=min_row, column=col)
        header_value = cell.value if cell.value is not None else f"Col_{col}"
        headers.append(str(header_value))
        print(f"Column {col}: '{header_value}'")
    
    print(f"\nIdentified headers: {headers}")
    
    # Look for city-related data and menu items
    print("\n=== SEARCHING FOR CITY AND MENU DATA ===")
    city_keywords = ['city', 'location', 'wharvton', 'algrimand', 'town', 'region']
    menu_keywords = ['burger', 'fries', 'drink', 'soda', 'food', 'sandwich', 'salad', 'sales']
    
    found_data = []
    # Check first 20 rows for relevant data
    for row in range(min_row, min(max_row + 1, min_row + 20)):
        for col in range(min_col, max_col + 1):
            cell = sheet.cell(row=row, column=col)
            if cell.value:
                cell_text = str(cell.value).lower()
                for keyword in city_keywords + menu_keywords:
                    if keyword in cell_text:
                        found_data.append({
                            'row': row,
                            'col': col,
                            'value': cell.value,
                            'keyword': keyword
                        })
                        print(f"Found keyword '{keyword}' in cell ({row}, {col}): '{cell.value}'")
    
    print(f"\nTotal relevant keywords found: {len(found_data)}")

# Load with pandas for complete data analysis
print("\n" + "="*60)
print("PANDAS DATAFRAME ANALYSIS")
print("="*60)

try:
    # Try to read the Excel file with pandas
    df_dict = pd.read_excel(xlsx_path, sheet_name=None)  # Read all sheets
    
    print(f"Pandas successfully loaded {len(df_dict)} sheet(s)")
    
    for sheet_name, sheet_df in df_dict.items():
        print(f"\n=== PANDAS ANALYSIS: {sheet_name} ===")
        print(f"DataFrame shape: {sheet_df.shape}")
        print(f"Column names: {list(sheet_df.columns)}")
        print(f"Data types:\n{sheet_df.dtypes}")
        
        print("\nComplete dataset:")
        print(sheet_df.to_string(index=False))
        
        print("\nBasic statistics for numeric columns:")
        numeric_cols = sheet_df.select_dtypes(include=['number']).columns
        if len(numeric_cols) > 0:
            print(sheet_df[numeric_cols].describe())
        else:
            print("No numeric columns found")
        
        print("\nMissing values:")
        print(sheet_df.isnull().sum())
        
        # Look specifically for Wharvton and Algrimand data
        print("\n=== SEARCHING FOR WHARVTON AND ALGRIMAND DATA ===")
        
        # Check if any columns contain city names
        city_columns = []
        for col in sheet_df.columns:
            col_str = str(col).lower()
            if 'city' in col_str or 'location' in col_str or 'region' in col_str:
                city_columns.append(col)
                print(f"Found potential city column: {col}")
        
        # Check data for the specific cities
        wharvton_data = []
        algrimand_data = []
        
        for index, row in sheet_df.iterrows():
            for col in sheet_df.columns:
                cell_value = str(row[col]).lower() if pd.notna(row[col]) else ""
                if 'wharvton' in cell_value:
                    wharvton_data.append({'row': index, 'column': col, 'value': row[col]})
                    print(f"Found Wharvton in row {index}, column '{col}': {row[col]}")
                if 'algrimand' in cell_value:
                    algrimand_data.append({'row': index, 'column': col, 'value': row[col]})
                    print(f"Found Algrimand in row {index}, column '{col}': {row[col]}")
        
        print(f"\nWharvton references found: {len(wharvton_data)}")
        print(f"Algrimand references found: {len(algrimand_data)}")
        
except Exception as e:
    print(f"Error reading with pandas: {e}")
    print("Will proceed with openpyxl analysis only")

# Save initial analysis for reference
analysis_data = {
    'file_path': xlsx_path,
    'file_size': file_size,
    'worksheets': [sheet.title for sheet in wb.worksheets],
    'analysis_timestamp': pd.Timestamp.now().isoformat()
}

with open('workspace/regional_sales_initial_analysis.json', 'w') as f:
    json.dump(analysis_data, f, indent=2)

print(f"\nInitial analysis saved to: workspace/regional_sales_initial_analysis.json")
print("Next step: Extract sales data for Wharvton and Algrimand cities and calculate totals")
```