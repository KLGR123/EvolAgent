### Development Step 1: Parse locomotive inventory; identify Murder Mystery Express engine and provide its American locomotive type name.

**Description**: Parse and analyze the attached Excel file data/gaia/2023/validation/edd4d4f2-1a58-45c4-b038-67337af4e029.xlsx to extract the complete locomotive inventory data from the local railroad museum. Identify all locomotives and their assigned excursions or services, specifically locate the locomotive(s) used for the 'Murder Mystery Express' service, then determine the locomotive type and provide the typical American name for that type of locomotive.

**Use Cases**:
- Railroad museum operations planning and excursion scheduling by automatically identifying which locomotive powers the “Murder Mystery Express” and mapping its steam/diesel classification for staff assignment
- Marketing collateral generation for tourism teams by extracting the locomotive type and American name to create accurate promotional brochures and social media posts about the “Murder Mystery Express” ride
- Historical research and preservation reporting by parsing the inventory to document which locomotive models served themed excursions like the “Murder Mystery Express” for academic publications
- Preventive maintenance automation by flagging the “Murder Mystery Express” locomotive in the CMMS (computerized maintenance management system) and scheduling inspections based on its wheel configuration and builder details
- Asset management synchronization for the museum’s ERP system by importing locomotive IDs, types, and service assignments (including “Murder Mystery Express”) to keep fixed-asset records up to date
- Mobile app development for visitors by providing real-time locomotive assignment and educational content about the type and history of the engine hauling the “Murder Mystery Express”
- Regulatory compliance reporting by generating audit-ready lists of all locomotives used on special excursions—highlighting the “Murder Mystery Express” steam locomotive class and builder for safety inspections
- Business analytics and resource optimization by analyzing locomotive usage across services, with a focus on the “Murder Mystery Express,” to balance steam versus diesel assignments and improve operational efficiency

```
import os
import pandas as pd
from openpyxl import load_workbook
import json

# The path to the Excel file to be analyzed
xlsx_path = "data/gaia/2023/validation/edd4d4f2-1a58-45c4-b038-67337af4e029.xlsx"

print("=== LOCAL RAILROAD MUSEUM - LOCOMOTIVE INVENTORY ANALYSIS ===\n")
print(f"Analyzing file: {xlsx_path}")

# Check if file exists
if not os.path.exists(xlsx_path):
    print(f"Error: Excel file '{xlsx_path}' does not exist.")
    exit()

print(f"File exists: {xlsx_path}")
file_size = os.path.getsize(xlsx_path)
print(f"File size: {file_size} bytes")

# Load workbook with openpyxl to examine structure and formatting
print("\nLoading workbook with openpyxl to examine structure...")
wb = load_workbook(xlsx_path, data_only=True)  # Use data_only=True to get calculated values

print(f"Number of worksheets: {len(wb.worksheets)}")
print(f"Worksheet names: {[sheet.title for sheet in wb.worksheets]}")

# Examine each worksheet
for sheet_idx, sheet in enumerate(wb.worksheets):
    print(f"\n=== ANALYZING WORKSHEET: {sheet.title} ===\n")
    
    max_row = sheet.max_row
    max_col = sheet.max_column
    print(f"Sheet dimensions: {max_row} rows x {max_col} columns")
    
    # Get the range of actual data
    min_row = sheet.min_row
    min_col = sheet.min_column
    print(f"Data range: rows {min_row}-{max_row}, columns {min_col}-{max_col}")
    
    print("\n=== FIRST 15 ROWS PREVIEW ===\n")
    # Display first 15 rows to understand structure
    for row in range(min_row, min(max_row + 1, min_row + 15)):
        row_data = []
        for col in range(min_col, max_col + 1):
            cell = sheet.cell(row=row, column=col)
            cell_value = cell.value if cell.value is not None else ""
            row_data.append(str(cell_value))
        print(f"Row {row}: {row_data}")
    
    print("\n=== COLUMN HEADERS ANALYSIS ===\n")
    # Examine the first row as potential headers
    headers = []
    for col in range(min_col, max_col + 1):
        cell = sheet.cell(row=min_row, column=col)
        header_value = cell.value if cell.value is not None else f"Col_{col}"
        headers.append(str(header_value))
        print(f"Column {col}: '{header_value}'")
    
    print(f"\nIdentified headers: {headers}")
    
    # Look for locomotive-related keywords in headers and data
    print("\n=== SEARCHING FOR LOCOMOTIVE-RELATED DATA ===\n")
    locomotive_keywords = ['locomotive', 'engine', 'steam', 'diesel', 'electric', 'number', 'id', 'type', 'wheel', 'configuration', 'class', 'model', 'road', 'builder', 'excursion', 'service', 'assignment']
    
    found_keywords = []
    for header in headers:
        header_lower = header.lower()
        for keyword in locomotive_keywords:
            if keyword in header_lower:
                found_keywords.append({
                    'header': header,
                    'keyword': keyword,
                    'column_index': headers.index(header)
                })
                print(f"Found keyword '{keyword}' in header: '{header}'")
    
    print(f"\nTotal locomotive-related keywords found in headers: {len(found_keywords)}")
    
    # Sample some data rows to understand content
    print("\n=== DATA SAMPLE (Rows 2-10) ===\n")
    for row in range(min_row + 1, min(max_row + 1, min_row + 10)):
        if row <= max_row:
            print(f"Row {row}:")
            for col_idx, col in enumerate(range(min_col, max_col + 1)):
                cell = sheet.cell(row=row, column=col)
                cell_value = cell.value if cell.value is not None else ""
                header = headers[col_idx] if col_idx < len(headers) else f"Col_{col}"
                print(f"  {header}: '{cell_value}' (type: {type(cell_value)})")
    
    # Search for 'Murder Mystery Express' specifically in the data
    print("\n=== SEARCHING FOR 'MURDER MYSTERY EXPRESS' ===\n")
    murder_mystery_found = []
    for row in range(min_row, max_row + 1):
        for col in range(min_col, max_col + 1):
            cell = sheet.cell(row=row, column=col)
            if cell.value and isinstance(cell.value, str):
                cell_text = cell.value.lower()
                if 'murder' in cell_text and 'mystery' in cell_text:
                    murder_mystery_found.append({
                        'row': row,
                        'col': col,
                        'value': cell.value,
                        'header': headers[col - min_col] if (col - min_col) < len(headers) else f"Col_{col}"
                    })
                    print(f"Found 'Murder Mystery Express' reference at ({row}, {col}): '{cell.value}'")
    
    print(f"Total 'Murder Mystery Express' references found: {len(murder_mystery_found)}")

# Also load with pandas for easier data manipulation
print("\n" + "="*60)
print("PANDAS DATAFRAME ANALYSIS")
print("="*60)

try:
    # Try to read the Excel file with pandas
    df_dict = pd.read_excel(xlsx_path, sheet_name=None)  # Read all sheets
    
    print(f"\nPandas successfully loaded {len(df_dict)} sheet(s)")
    
    for sheet_name, sheet_df in df_dict.items():
        print(f"\n=== PANDAS ANALYSIS: {sheet_name} ===\n")
        print(f"DataFrame shape: {sheet_df.shape}")
        print(f"Column names: {list(sheet_df.columns)}")
        print(f"Data types:\n{sheet_df.dtypes}")
        
        print("\nFirst 10 rows:")
        print(sheet_df.head(10).to_string())
        
        print("\nBasic statistics for numeric columns:")
        numeric_cols = sheet_df.select_dtypes(include=['number']).columns
        if len(numeric_cols) > 0:
            print(sheet_df[numeric_cols].describe())
        else:
            print("No numeric columns found")
        
        print("\nMissing values:")
        print(sheet_df.isnull().sum())
        
        # Look for locomotive-specific columns
        print("\n=== LOCOMOTIVE-SPECIFIC COLUMN IDENTIFICATION ===\n")
        column_names = [col.lower() for col in sheet_df.columns]
        
        potential_id_cols = [col for col in sheet_df.columns if any(keyword in col.lower() for keyword in ['number', 'id', 'locomotive', 'engine', 'road'])]
        potential_type_cols = [col for col in sheet_df.columns if any(keyword in col.lower() for keyword in ['type', 'class', 'model', 'steam', 'diesel', 'wheel', 'configuration'])]
        potential_service_cols = [col for col in sheet_df.columns if any(keyword in col.lower() for keyword in ['service', 'excursion', 'assignment', 'route', 'trip'])]
        
        print(f"Potential locomotive ID columns: {potential_id_cols}")
        print(f"Potential locomotive type columns: {potential_type_cols}")
        print(f"Potential service/excursion columns: {potential_service_cols}")
        
        # Search for 'Murder Mystery Express' in the dataframe
        print("\n=== SEARCHING FOR 'MURDER MYSTERY EXPRESS' IN DATA ===\n")
        murder_mystery_matches = []
        
        for col in sheet_df.columns:
            if sheet_df[col].dtype == 'object':  # String columns
                mask = sheet_df[col].astype(str).str.contains('murder.*mystery', case=False, na=False, regex=True)
                if mask.any():
                    matches = sheet_df[mask]
                    print(f"Found 'Murder Mystery Express' matches in column '{col}':")
                    for idx, row in matches.iterrows():
                        print(f"  Row {idx}: {row[col]}")
                        murder_mystery_matches.append({
                            'row_index': idx,
                            'column': col,
                            'value': row[col],
                            'full_row': row.to_dict()
                        })
        
        print(f"\nTotal 'Murder Mystery Express' matches found: {len(murder_mystery_matches)}")
        
except Exception as e:
    print(f"Error reading with pandas: {e}")
    print("Will proceed with openpyxl analysis only")

# Save initial analysis
analysis_data = {
    'file_path': xlsx_path,
    'file_size': file_size,
    'worksheets': [sheet.title for sheet in wb.worksheets],
    'analysis_timestamp': pd.Timestamp.now().isoformat()
}

with open('workspace/locomotive_museum_murder_mystery_analysis_initial.json', 'w') as f:
    json.dump(analysis_data, f, indent=2)

print(f"\nInitial analysis saved to: workspace/locomotive_museum_murder_mystery_analysis_initial.json")
print("Next step: Extract locomotive data and identify Murder Mystery Express locomotive type")
```