### Development Step 32: 2011 Bulgarian Census Tertiary Education Completion Numbers by Gender Search

**Description**: Search for the official 2011 Bulgarian census data from the Bulgarian National Statistical Institute (NSI) or other authoritative government sources that specifically contain the tertiary education completion numbers by gender. Focus on finding the exact counts or percentages of men and women who completed tertiary education according to the 2011 census results.

**Use Cases**:
- Government policy analysts evaluating gender disparities in higher education to draft targeted interventions using 2011 Bulgarian census tertiary completion rates
- Academic demographers conducting longitudinal studies on Bulgaria’s educational attainment trends by gender from official NSI data
- NGO program coordinators designing women’s scholarship initiatives based on precise male/female tertiary graduation figures from the 2011 census
- International agencies (e.g., UNESCO, EU Education Directorate) compiling comparative gender-parity reports across member states using Bulgaria’s census outcomes
- University strategic planners forecasting future enrollment needs by analyzing historical gender-specific completion rates in Bulgarian higher education
- Data journalists fact-checking and visualizing gender participation in tertiary education for investigative articles on Bulgaria’s social progress
- Labor market analysts assessing the supply of male and female graduates for industry skills gap reports relying on official 2011 census statistics
- Open-data platform developers automating the ingestion of NSI’s education attainment tables to provide transparent, gender-disaggregated datasets to the public

```
import os
import json
from bs4 import BeautifulSoup
import re

# Define the recursive search function BEFORE using it
def find_data_recursively(obj, path=""):
    findings = []
    if isinstance(obj, dict):
        for key, value in obj.items():
            current_path = f"{path}.{key}" if path else key
            
            # Check if this key might contain relevant data
            key_lower = key.lower()
            if any(term in key_lower for term in ['gender', 'male', 'female', 'men', 'women', 'tertiary', 'education', 'university', 'higher']):
                findings.append((current_path, type(value), str(value)[:300]))
            
            # Recurse into nested structures
            findings.extend(find_data_recursively(value, current_path))
    
    elif isinstance(obj, list):
        for i, item in enumerate(obj):
            current_path = f"{path}[{i}]"
            findings.extend(find_data_recursively(item, current_path))
    
    elif isinstance(obj, str):
        # Look for numerical patterns in strings
        if re.search(r'\d+', obj) and any(term in obj.lower() for term in ['education', 'tertiary', 'university', 'male', 'female', 'gender']):
            findings.append((path, "string_with_numbers", obj[:300]))
    
    return findings

# Now examine the most promising JSON file
workspace_dir = 'workspace'
promising_file = 'bulgarian_census_tertiary_education_comprehensive_final.json'
filepath = os.path.join(workspace_dir, promising_file)

print("=== EXTRACTING 2011 BULGARIAN CENSUS TERTIARY EDUCATION DATA BY GENDER ===")
print(f"\nAnalyzing: {promising_file}\n")

if os.path.exists(filepath):
    with open(filepath, 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    print("=== EXAMINING DETAILED DATA STRUCTURE ===")
    
    # Focus on the detailed_data section which contains the actual findings
    if 'detailed_data' in data and isinstance(data['detailed_data'], dict):
        detailed_data = data['detailed_data']
        print(f"\nDetailed data sections: {list(detailed_data.keys())}")
        
        # Examine tertiary_education_data
        if 'tertiary_education_data' in detailed_data:
            tertiary_data = detailed_data['tertiary_education_data']
            print(f"\n--- TERTIARY EDUCATION DATA ---")
            print(f"Number of tertiary education entries: {len(tertiary_data)}")
            
            for i, entry in enumerate(tertiary_data, 1):
                print(f"\nEntry {i}:")
                print(f"  Match text: {entry.get('match_text', 'N/A')}")
                print(f"  Has gender data: {entry.get('has_gender', False)}")
                print(f"  Has 2011 data: {entry.get('has_2011', False)}")
                print(f"  Has Bulgaria data: {entry.get('has_bulgaria', False)}")
                
                # Extract specific numbers from the match text
                match_text = entry.get('match_text', '')
                if match_text:
                    # Look for patterns like "male: X years" or "female: X years"
                    male_pattern = re.search(r'male:\s*(\d+)', match_text, re.IGNORECASE)
                    female_pattern = re.search(r'female:\s*(\d+)', match_text, re.IGNORECASE)
                    total_pattern = re.search(r'total:\s*(\d+)', match_text, re.IGNORECASE)
                    
                    if male_pattern or female_pattern or total_pattern:
                        print(f"  *** NUMERICAL DATA EXTRACTED ***")
                        if total_pattern:
                            print(f"    Total: {total_pattern.group(1)}")
                        if male_pattern:
                            print(f"    Male: {male_pattern.group(1)}")
                        if female_pattern:
                            print(f"    Female: {female_pattern.group(1)}")
        
        # Examine statistical_findings
        if 'statistical_findings' in detailed_data:
            stat_findings = detailed_data['statistical_findings']
            print(f"\n--- STATISTICAL FINDINGS ---")
            print(f"Number of statistical findings: {len(stat_findings)}")
            
            for i, finding in enumerate(stat_findings, 1):
                print(f"\nFinding {i}:")
                print(f"  Type: {finding.get('type', 'N/A')}")
                print(f"  Gender: {finding.get('gender', 'N/A')}")
                print(f"  Value: {finding.get('value', 'N/A')}")
                print(f"  Unit: {finding.get('unit', 'N/A')}")
                
                # Check if this is tertiary education related
                finding_type = finding.get('type', '').lower()
                if 'education' in finding_type or 'tertiary' in finding_type:
                    print(f"  *** EDUCATION-RELATED FINDING ***")
        
        # Examine census_2011_findings - FIX THE VARIABLE NAME ERROR
        if 'census_2011_findings' in detailed_data:
            census_findings = detailed_data['census_2011_findings']
            print(f"\n--- 2011 CENSUS FINDINGS ---")
            print(f"Number of census findings: {len(census_findings)}")
            
            for i, finding in enumerate(census_findings, 1):
                print(f"\nCensus Finding {i}:")
                census_text_content = finding.get('census_text', 'N/A')
                print(f"  Census text: {census_text_content}")
                
                # Look for education-related census data - FIXED VARIABLE REFERENCE
                if any(term in census_text_content.lower() for term in ['education', 'tertiary', 'university', 'degree']):
                    print(f"  *** EDUCATION-RELATED CENSUS DATA ***")
                    
                    # Extract numbers from census text
                    numbers = re.findall(r'\b\d{1,3}(?:,\d{3})*\b', census_text_content)
                    if numbers:
                        print(f"  Numbers found: {numbers}")
    
    print(f"\n=== RECURSIVE SEARCH FOR ALL RELEVANT DATA ===\n")
    
    # Use the recursive function to find all relevant data
    relevant_findings = find_data_recursively(data)
    
    if relevant_findings:
        print("All relevant gender/education data found:")
        for path, data_type, content in relevant_findings:
            print(f"\nPath: {path}")
            print(f"Type: {data_type}")
            print(f"Content: {content}")
            
            # If this contains numerical data, try to extract it
            if 'male' in content.lower() and 'female' in content.lower():
                print(f"  *** CONTAINS GENDER-SPECIFIC DATA ***")
                
                # Extract all numbers from this content
                numbers = re.findall(r'\b\d+(?:\.\d+)?\b', content)
                if numbers:
                    print(f"  Numbers extracted: {numbers}")
    else:
        print("No relevant gender/education data found through recursive search.")
    
    print(f"\n=== FINAL ANALYSIS AND CONCLUSION ===\n")
    
    # Determine what type of data we actually found
    data_analysis = {
        'source_analyzed': data.get('source_file', 'Unknown'),
        'data_type_found': 'School life expectancy (years of education)',
        'is_2011_census_data': False,
        'is_tertiary_completion_rate': False,
        'actual_data_found': {
            'metric': 'School life expectancy (primary to tertiary education)',
            'year': '2016',
            'total': '14 years',
            'male': '14 years',
            'female': '14 years'
        },
        'additional_findings': {
            'literacy_rates_2015': {
                'total': '98.4%',
                'male': '98.7%', 
                'female': '98.1%'
            },
            'youth_unemployment_2018': {
                'total': '12.7%',
                'male': '13.2%',
                'female': '13.9%'
            },
            'illiteracy_2011_census': '112,778 people aged nine or more are illiterate'
        }
    }
    
    print("CONCLUSION:")
    print("✗ The analyzed data does NOT contain the target information we need.")
    print("\nWhat we found:")
    print(f"  - School life expectancy: {data_analysis['actual_data_found']['total']} for both genders (2016 data)")
    print(f"  - Literacy rates from 2015 (not tertiary education completion)")
    print(f"  - Youth unemployment rates from 2018")
    print(f"  - General illiteracy data from 2011 census")
    
    print("\nWhat we NEED but did NOT find:")
    print("  - Specific number or percentage of men who completed tertiary education (2011 census)")
    print("  - Specific number or percentage of women who completed tertiary education (2011 census)")
    print("  - Official NSI census tables showing educational attainment by gender")
    
    print("\n=== NEXT STEPS RECOMMENDATION ===\n")
    print("The current workspace contains Wikipedia demographic data, not official NSI census tables.")
    print("To find the actual 2011 Bulgarian census tertiary education completion data by gender:")
    print("\n1. Search for official NSI (National Statistical Institute) census publications")
    print("2. Look for census tables specifically about 'Educational attainment' or 'Education level'")
    print("3. Find tables that break down tertiary/higher education completion by gender")
    print("4. Target NSI URLs like: www.nsi.bg/en/content/[census-education-tables]")
    
    # Save comprehensive analysis
    final_results = {
        'objective': '2011 Bulgarian Census - Tertiary Education Completion by Gender',
        'analysis_timestamp': '2025-01-11',
        'status': 'TARGET DATA NOT FOUND',
        'data_source_analyzed': 'Wikipedia Demographics of Bulgaria',
        'findings': data_analysis,
        'recommendation': 'Search official NSI census tables for educational attainment by gender',
        'next_search_targets': [
            'NSI official census publications',
            'Educational attainment census tables', 
            'Higher education completion statistics by gender',
            'Official Bulgarian government statistical yearbooks'
        ]
    }
    
    results_file = os.path.join(workspace_dir, 'bulgarian_census_tertiary_education_final_analysis.json')
    with open(results_file, 'w', encoding='utf-8') as f:
        json.dump(final_results, f, indent=2, ensure_ascii=False)
    
    print(f"\nFinal analysis saved to: {results_file}")
    print("\nRECOMMENDATION: Need to search for official NSI census tables with actual tertiary education completion rates by gender from 2011 Bulgarian census.")

else:
    print(f"File not found: {filepath}")
```