### Development Step 12: Comprehensive Pre-1999 Discography of Fiona Apple and Paula Cole with Exact Release Dates

**Description**: Research and compile a comprehensive list of all albums released by Fiona Apple and Paula Cole before 1999, including their exact release dates and album titles. Focus on their studio albums, EPs, and any other significant releases during this timeframe. Use multiple music databases, discographies, and reliable sources to ensure completeness.

**Use Cases**:
- Music streaming service metadata verification and enrichment to ensure accurate pre-1999 Fiona Apple and Paula Cole release dates in the catalog
- Digital music journalism workflow automation for fact-checking discography details in a 90s spotlight feature
- Record label archival system integration to consolidate studio albums, EPs, and singles before 1999 into a centralized database
- Academic musicology research support for analyzing trends in female singer-songwriter releases during the 1990s
- Machine learning model training for personalized music recommendations using validated album release timelines
- Social media marketing automation to schedule anniversary posts for key Fiona Apple and Paula Cole releases
- Museum digital archive cataloging to document and preserve early works of Fiona Apple and Paula Cole with precise release metadata

```
import os
import json
from datetime import datetime

print("=== FIONA APPLE & PAULA COLE PRE-1999 ALBUMS - FINAL VERIFICATION ===\n")
print("Objective: Clean extracted data and create verified album list with exact release dates\n")

# First, let's inspect the JSON structure to understand what we're working with
json_file = 'workspace/fiona_apple_paula_cole_albums_pre_1999.json'

if not os.path.exists(json_file):
    print(f"JSON file not found: {json_file}")
    print("Available files in workspace:")
    if os.path.exists('workspace'):
        for file in os.listdir('workspace'):
            print(f"  - {file}")
    exit()

print(f"=== INSPECTING EXTRACTED DATA STRUCTURE ===\n")
print(f"Loading: {json_file}")

with open(json_file, 'r') as f:
    extracted_data = json.load(f)

print("Top-level keys in extracted data:")
for key, value in extracted_data.items():
    if isinstance(value, dict):
        print(f"  {key}: Dictionary with {len(value)} keys")
    elif isinstance(value, list):
        print(f"  {key}: List with {len(value)} items")
    else:
        print(f"  {key}: {value}")

print(f"\n=== DATA CLEANING AND VERIFICATION ===\n")

# Initialize cleaned results
cleaned_albums = {
    'fiona_apple': {
        'artist_name': 'Fiona Apple',
        'verified_albums': [],
        'rejected_entries': [],
        'notes': []
    },
    'paula_cole': {
        'artist_name': 'Paula Cole',
        'verified_albums': [],
        'rejected_entries': [],
        'notes': []
    }
}

# Calculate original entries count properly
original_entries_count = 0
for artist_key, artist_data in extracted_data.get('artists', {}).items():
    albums = artist_data.get('albums_pre_1999', [])
    original_entries_count += len(albums)

print(f"Total original entries to process: {original_entries_count}")

# Process each artist's data
for artist_key, artist_data in extracted_data.get('artists', {}).items():
    artist_name = artist_data.get('artist_name', artist_key)
    albums = artist_data.get('albums_pre_1999', [])
    
    print(f"\n--- Processing {artist_name} ---")
    print(f"Raw entries to process: {len(albums)}")
    
    for album in albums:
        title = album.get('title', 'Unknown')
        year = album.get('release_year', 'Unknown')
        album_type = album.get('type', 'Unknown')
        confidence = album.get('confidence', 'unknown')
        source = album.get('source', 'table_parsing')
        raw_data_entry = album.get('raw_data', [])
        
        print(f"\n  Evaluating: {year}: {title} ({album_type}) - Confidence: {confidence}")
        print(f"    Source: {source}")
        
        # Determine if this is a legitimate album/release
        is_legitimate = True
        rejection_reason = None
        
        # Filter out obvious false positives
        title_lower = title.lower()
        
        # Reject Grammy/award table entries
        if 'grammy' in title_lower or 'award' in title_lower or 'mtv video music' in title_lower:
            is_legitimate = False
            rejection_reason = "Award table entry, not an album"
        
        # Reject "Years active" entries
        elif 'years active' in title_lower:
            is_legitimate = False
            rejection_reason = "Career timeline entry, not an album"
        
        # Reject entries that are clearly table headers or navigation elements
        elif title.startswith('vte') or 'vteMTV' in title or len(title) > 200:
            is_legitimate = False
            rejection_reason = "Wikipedia navigation/template element, not an album"
        
        # Reject decade labels
        elif title in ['1990s', '2000s', '2010s', '2020s']:
            is_legitimate = False
            rejection_reason = "Decade label, not an album"
        
        # Clean up and validate legitimate entries
        if is_legitimate:
            # Clean up title
            cleaned_title = title.strip('"').strip()
            
            # Determine proper album type based on known information
            if album_type == 'Unknown' and source == 'text_mention':
                # Try to infer type from known information
                if cleaned_title in ['Tidal', 'Harbinger', 'This Fire']:
                    album_type = 'Studio Album'
                elif cleaned_title in ['Criminal', 'Shadowboxer', 'Sleep to Dream', 'Where Have All the Cowboys Gone?', "I Don't Want to Wait", "I Am So Ordinary"]:
                    album_type = 'Single'
            
            # Validate year is reasonable
            if isinstance(year, int) and 1990 <= year <= 1998:
                verified_album = {
                    'title': cleaned_title,
                    'release_year': year,
                    'type': album_type,
                    'confidence': confidence,
                    'source': source,
                    'verification_status': 'verified'
                }
                
                # Add exact release date if available from raw data
                if raw_data_entry and isinstance(raw_data_entry, list):
                    for raw_item in raw_data_entry:
                        if isinstance(raw_item, str) and 'July 23, 1996' in raw_item:
                            verified_album['exact_release_date'] = 'July 23, 1996'
                            break
                
                cleaned_albums[artist_key]['verified_albums'].append(verified_album)
                print(f"    ✓ VERIFIED: {year}: {cleaned_title} ({album_type})")
            else:
                is_legitimate = False
                rejection_reason = f"Invalid year: {year}"
        
        if not is_legitimate:
            rejected_entry = {
                'original_title': title,
                'year': year,
                'type': album_type,
                'rejection_reason': rejection_reason,
                'raw_data': raw_data_entry
            }
            cleaned_albums[artist_key]['rejected_entries'].append(rejected_entry)
            print(f"    ✗ REJECTED: {rejection_reason}")

print(f"\n=== CLEANED RESULTS SUMMARY ===\n")

# Remove duplicates and sort
for artist_key, artist_data in cleaned_albums.items():
    artist_name = artist_data['artist_name']
    verified_albums = artist_data['verified_albums']
    rejected_count = len(artist_data['rejected_entries'])
    
    print(f"--- {artist_name} ---")
    
    # Remove duplicates based on title and year
    unique_albums = []
    seen_combinations = set()
    
    for album in verified_albums:
        key = (album['title'].lower(), album['release_year'])
        if key not in seen_combinations:
            unique_albums.append(album)
            seen_combinations.add(key)
    
    # Sort by year
    unique_albums.sort(key=lambda x: x['release_year'])
    artist_data['verified_albums'] = unique_albums
    
    print(f"Verified albums: {len(unique_albums)}")
    print(f"Rejected entries: {rejected_count}")
    
    if unique_albums:
        print("\nVerified releases:")
        for i, album in enumerate(unique_albums, 1):
            year = album['release_year']
            title = album['title']
            album_type = album['type']
            exact_date = album.get('exact_release_date', '')
            
            date_info = f" ({exact_date})" if exact_date else ""
            
            print(f"  {i}. {year}: {title} - {album_type}{date_info}")
    else:
        print("  No verified albums found")
    
    print()

# Calculate totals for final report - FIXED SCOPING
total_verified = 0
total_rejected = 0
for artist_key in cleaned_albums:
    total_verified += len(cleaned_albums[artist_key]['verified_albums'])
    total_rejected += len(cleaned_albums[artist_key]['rejected_entries'])

# Create final comprehensive report
final_verified_report = {
    'research_target': 'Fiona Apple & Paula Cole albums released before 1999 - VERIFIED',
    'verification_timestamp': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
    'methodology': 'Wikipedia parsing with data cleaning and false positive removal',
    'data_quality': {
        'original_entries_processed': original_entries_count,
        'verified_albums_total': total_verified,
        'rejected_entries_total': total_rejected
    },
    'artists': cleaned_albums,
    'summary': {
        'fiona_apple_verified_count': len(cleaned_albums['fiona_apple']['verified_albums']),
        'paula_cole_verified_count': len(cleaned_albums['paula_cole']['verified_albums']),
        'total_verified_releases': total_verified
    }
}

# Add key findings - FIXED SCOPING
fiona_albums = []
paula_albums = []
all_singles = []

for album in cleaned_albums['fiona_apple']['verified_albums']:
    if album['type'] in ['Studio Album', 'EP']:
        fiona_albums.append(album)
    elif album['type'] == 'Single':
        all_singles.append(album)

for album in cleaned_albums['paula_cole']['verified_albums']:
    if album['type'] in ['Studio Album', 'EP']:
        paula_albums.append(album)
    elif album['type'] == 'Single':
        all_singles.append(album)

final_verified_report['key_findings'] = {
    'fiona_apple_albums': fiona_albums,
    'paula_cole_albums': paula_albums,
    'notable_singles': all_singles
}

# Save cleaned and verified results
with open('workspace/fiona_apple_paula_cole_verified_albums_pre_1999.json', 'w') as f:
    json.dump(final_verified_report, f, indent=2)

# Create human-readable summary
summary_lines = []
summary_lines.append("=== FIONA APPLE & PAULA COLE PRE-1999 DISCOGRAPHY - FINAL VERIFIED RESULTS ===")
summary_lines.append("")
summary_lines.append(f"Research completed: {final_verified_report['verification_timestamp']}")
summary_lines.append(f"Data quality: {final_verified_report['data_quality']['verified_albums_total']} verified from {final_verified_report['data_quality']['original_entries_processed']} raw entries")
summary_lines.append("")

for artist_key, artist_data in cleaned_albums.items():
    artist_name = artist_data['artist_name']
    verified_albums = artist_data['verified_albums']
    
    summary_lines.append(f"--- {artist_name.upper()} ---")
    
    # Separate albums from singles
    albums = [a for a in verified_albums if a['type'] in ['Studio Album', 'EP']]
    singles = [a for a in verified_albums if a['type'] == 'Single']
    other_releases = [a for a in verified_albums if a['type'] not in ['Studio Album', 'EP', 'Single']]
    
    if albums:
        summary_lines.append("ALBUMS/EPs:")
        for album in albums:
            year = album['release_year']
            title = album['title']
            album_type = album['type']
            exact_date = album.get('exact_release_date', '')
            date_info = f" (Released: {exact_date})" if exact_date else ""
            summary_lines.append(f"  • {year}: {title} ({album_type}){date_info}")
    
    if singles:
        summary_lines.append("NOTABLE SINGLES:")
        for single in singles:
            year = single['release_year']
            title = single['title']
            summary_lines.append(f"  • {year}: {title}")
    
    if other_releases:
        summary_lines.append("OTHER RELEASES:")
        for release in other_releases:
            year = release['release_year']
            title = release['title']
            release_type = release['type']
            summary_lines.append(f"  • {year}: {title} ({release_type})")
    
    summary_lines.append(f"Total releases: {len(verified_albums)}")
    summary_lines.append("")

summary_lines.append(f"OVERALL SUMMARY:")
summary_lines.append(f"Total verified pre-1999 releases: {final_verified_report['summary']['total_verified_releases']}")
summary_lines.append(f"Fiona Apple: {final_verified_report['summary']['fiona_apple_verified_count']} releases")
summary_lines.append(f"Paula Cole: {final_verified_report['summary']['paula_cole_verified_count']} releases")

# Save human-readable summary
with open('workspace/fiona_apple_paula_cole_pre_1999_summary.txt', 'w') as f:
    f.write('\n'.join(summary_lines))

print(f"=== VERIFICATION COMPLETE ===\n")
print(f"Verified data saved to: workspace/fiona_apple_paula_cole_verified_albums_pre_1999.json")
print(f"Human-readable summary saved to: workspace/fiona_apple_paula_cole_pre_1999_summary.txt")
print(f"\nFINAL VERIFIED SUMMARY:")
print(f"Fiona Apple: {final_verified_report['summary']['fiona_apple_verified_count']} verified releases")
print(f"Paula Cole: {final_verified_report['summary']['paula_cole_verified_count']} verified releases")
print(f"Total: {final_verified_report['summary']['total_verified_releases']} verified releases before 1999")

# Display the key albums found
print(f"\nKEY ALBUMS IDENTIFIED:")
for artist_key, artist_data in cleaned_albums.items():
    albums = [a for a in artist_data['verified_albums'] if a['type'] in ['Studio Album', 'EP']]
    if albums:
        print(f"{artist_data['artist_name']}:")
        for album in albums:
            year = album['release_year']
            title = album['title']
            exact_date = album.get('exact_release_date', '')
            date_info = f" ({exact_date})" if exact_date else ""
            print(f"  • {year}: {title}{date_info}")

print(f"\nNOTABLE SINGLES IDENTIFIED:")
for artist_key, artist_data in cleaned_albums.items():
    singles = [a for a in artist_data['verified_albums'] if a['type'] == 'Single']
    if singles:
        print(f"{artist_data['artist_name']}:")
        for single in singles:
            year = single['release_year']
            title = single['title']
            print(f"  • {year}: {title}")
```