### Development Step 2: Pre-1974 Australia-New Zealand Test: Identify Captain with First 300+ Innings Record

**Description**: Search for information about Test matches between Australia and New Zealand before the 1973-74 season where a player scored over 300 runs in an innings for the first time in Test cricket history. Focus on identifying which Australian cricketer captained Australia in that specific match and held the record for the highest individual innings score. Search for keywords including 'first Test cricket 300 runs innings', 'Australia New Zealand Test before 1973-74', 'Arthur Morris 300 runs Test match', 'highest individual Test innings Australia captain', and 'Test cricket scoring records pre-1974'.

**Use Cases**:
- Sports historian compiling a detailed timeline of record-breaking Test cricket innings uses the pipeline to extract match reports and captaincy data for Australia vs New Zealand fixtures before 1973‚Äì74.
- Cricket analytics startup automating ingestion of historical performance metrics leverages targeted SerpAPI searches to populate its database with first-ever 300+ run innings and captain profiles.
- Wiki editor updating the ‚ÄúList of Test cricket triple-centuries‚Äù page uses the solution to verify Arthur Morris‚Äôs score, captaincy role, and match context through multiple online sources.
- Sports journalist researching a feature on cricket‚Äôs first triple-century deploys the code to gather primary newspaper archives, commentary snippets, and exact dates from 1972‚Äì73 Test matches.
- Machine learning engineer assembling labeled datasets for predictive modeling of record innings taps this automated search to collect examples of high-scoring batsmen and match metadata.
- Digital library curator indexing early Test match articles integrates the workflow to tag content with relevance indicators like ‚Äú300 runs,‚Äù ‚Äúcaptain,‚Äù and ‚ÄúAustralia vs New Zealand‚Äù for easy retrieval.
- QA team at a sports content platform automates fact-checking of record-breaking match details before publication by cross-referencing existing articles against real-time search results.
- Chatbot developer building a cricket trivia assistant calls the API-driven search module on demand to fetch accurate answers about the first 300+ Test innings and its Australian captain.

```
import os
import requests
import json
from datetime import datetime
import time

# Check if we have existing search results in workspace first
print("Checking workspace for existing Test cricket search results...")
print("=" * 70)

workspace_files = []
if os.path.exists('workspace'):
    for file in os.listdir('workspace'):
        if 'test_cricket' in file.lower() and '300' in file:
            workspace_files.append(file)
            print(f"Found existing file: {file}")

if workspace_files:
    print(f"\nFound {len(workspace_files)} existing files. Checking if they contain useful data...")
    # We'll proceed with a fresh search since the previous one failed
else:
    print("No existing Test cricket search files found.")

print("\nProceeding with fresh search with improved error handling...")

# Get SerpAPI key from environment variables
api_key = os.getenv("SERPAPI_API_KEY")

if api_key is None:
    print("Error: Missing API key. Make sure you have SERPAPI_API_KEY in your environment variables.")
else:
    print("API key found, proceeding with search for Test cricket 300+ runs innings before 1973-74...")
    print("Target: Identify Australian cricketer who scored first 300+ runs in Test cricket and captained Australia")
    print("Focus: Australia vs New Zealand Test matches before 1973-74 season")
    print("Improvements: Shorter timeout, better error handling, smaller result sets")
    print("=" * 90)

    # Define focused search queries - reduced number for better reliability
    search_queries = [
        'first Test cricket 300 runs innings Australia New Zealand 1973',
        'Arthur Morris 300 runs Test match Australia captain',
        'Australia New Zealand Test cricket 1973 300 runs record',
        'highest individual Test innings Australia captain before 1974',
        'Test cricket 300 runs Australian batsman captain 1973',
        'Australia cricket captain 300 runs Test match 1972 1973'
    ]

    print(f"Starting focused search with {len(search_queries)} targeted queries...")
    print("Focus: Test cricket 300+ runs innings, Australian captain, pre-1973-74 season")
    print("=" * 90)

    # Store all search results for analysis
    all_results = []
    successful_searches = 0
    failed_searches = 0
    search_errors = []

    # Perform searches with improved error handling
    for i, query in enumerate(search_queries, 1):
        print(f"\nSearch {i}/{len(search_queries)}: {query}")
        print("-" * 80)
        
        # Prepare API request parameters with smaller result set
        params = {
            "q": query,
            "api_key": api_key,
            "engine": "google",
            "google_domain": "google.com",
            "safe": "off",
            "num": 6,  # Reduced for faster processing
            "type": "search"
        }
        
        try:
            # Make API request with shorter timeout
            print(f"Making API request for query {i} (timeout: 15 seconds)...")
            response = requests.get("https://serpapi.com/search.json", params=params, timeout=15)
            
            print(f"Response status: {response.status_code}")
            
            if response.status_code == 200:
                results = response.json()
                
                if results.get("organic_results"):
                    print(f"‚úÖ Found {len(results['organic_results'])} results for search {i}")
                    successful_searches += 1
                    
                    # Process and display key results
                    for j, result in enumerate(results["organic_results"], 1):
                        title = result.get('title', 'No title')
                        link = result.get('link', 'No link')
                        snippet = result.get('snippet', 'No snippet')
                        
                        print(f"\nResult {j}:")
                        print(f"Title: {title[:100]}{'...' if len(title) > 100 else ''}")
                        print(f"Snippet: {snippet[:150]}{'...' if len(snippet) > 150 else ''}")
                        
                        # Store result with search context
                        all_results.append({
                            'search_number': i,
                            'query_text': query,
                            'result_number': j,
                            'title': title,
                            'link': link,
                            'snippet': snippet
                        })
                        
                        # Highlight potentially relevant results for Test cricket
                        combined_text = f"{title.lower()} {snippet.lower()}"
                        key_indicators = ['test', 'cricket', '300', 'runs', 'innings', 'australia', 'new zealand', 'captain', 'record', 'highest']
                        matching_indicators = [term for term in key_indicators if term in combined_text]
                        
                        if len(matching_indicators) >= 4:
                            print(f"üéØ HIGHLY RELEVANT - Contains: {', '.join(matching_indicators)}")
                            
                            # Check for specific indicators
                            if '300' in combined_text and 'runs' in combined_text:
                                print(f"üèè SCORING: Contains 300 runs reference")
                            if 'captain' in combined_text:
                                print(f"üëë LEADERSHIP: Contains captain reference")
                            if any(name in combined_text for name in ['arthur morris', 'morris']):
                                print(f"üë§ PLAYER: Arthur Morris mentioned")
                            if any(date in combined_text for date in ['1973', '1972']):
                                print(f"üìÖ TIMEFRAME: Pre-1973-74 date mentioned")
                        
                        elif len(matching_indicators) >= 2:
                            print(f"‚≠ê POTENTIALLY RELEVANT - Contains: {', '.join(matching_indicators)}")
                        
                        print("-" * 40)
                else:
                    print(f"‚ö†Ô∏è No organic results found for search {i}: '{query}'")
                    all_results.append({
                        'search_number': i,
                        'query_text': query,
                        'result_number': 0,
                        'title': 'No results',
                        'link': 'N/A',
                        'snippet': 'No results found for this query'
                    })
                    
            else:
                error_msg = f"API request failed with status {response.status_code}"
                print(f"‚ùå Error: {error_msg}")
                search_errors.append(f"Query {i}: {error_msg}")
                failed_searches += 1
                
        except requests.exceptions.Timeout:
            error_msg = f"Timeout error during search {i} (15 second limit exceeded)"
            print(f"‚è∞ {error_msg}")
            search_errors.append(f"Query {i}: {error_msg}")
            failed_searches += 1
        except requests.exceptions.RequestException as e:
            error_msg = f"Request error during search {i}: {str(e)}"
            print(f"üåê {error_msg}")
            search_errors.append(f"Query {i}: {error_msg}")
            failed_searches += 1
        except Exception as e:
            error_msg = f"Unexpected error during search {i}: {str(e)}"
            print(f"‚ùå {error_msg}")
            search_errors.append(f"Query {i}: {error_msg}")
            failed_searches += 1
            
        # Add delay between requests to avoid rate limiting
        if i < len(search_queries):
            print(f"\n‚è≥ Waiting 3 seconds before next search...")
            time.sleep(3)
        
        print("\n" + "=" * 90)

    # Save comprehensive search results to workspace
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    results_file = f"workspace/test_cricket_300_runs_search_results_{timestamp}.json"

    # Ensure workspace directory exists
    os.makedirs('workspace', exist_ok=True)

    with open(results_file, 'w', encoding='utf-8') as f:
        json.dump({
            'search_timestamp': datetime.now().isoformat(),
            'search_focus': 'Test cricket 300+ runs innings Australia vs New Zealand before 1973-74 season',
            'search_objective': 'Identify Australian cricketer who scored first 300+ runs and captained Australia',
            'total_queries': len(search_queries),
            'successful_searches': successful_searches,
            'failed_searches': failed_searches,
            'total_results': len(all_results),
            'search_errors': search_errors,
            'queries_executed': search_queries,
            'all_search_results': all_results
        }, f, indent=2, ensure_ascii=False)

    print(f"\n\nüìä COMPREHENSIVE SEARCH SUMMARY:")
    print(f"Total targeted queries executed: {len(search_queries)}")
    print(f"Successful searches: {successful_searches}")
    print(f"Failed searches: {failed_searches}")
    print(f"Total results collected: {len(all_results)}")
    print(f"Search results saved to: {results_file}")
    
    if search_errors:
        print(f"\n‚ö†Ô∏è SEARCH ERRORS ENCOUNTERED:")
        for error in search_errors:
            print(f"  - {error}")

    # Quick analysis if we got any results
    if successful_searches > 0:
        print("\n\nüîç QUICK ANALYSIS OF COLLECTED RESULTS:")
        print("=" * 50)
        
        # Count results by relevance
        cricket_300_count = 0
        captain_count = 0
        morris_count = 0
        date_count = 0
        
        for result in all_results:
            if result['title'] == 'No results':
                continue
                
            combined = f"{result['title'].lower()} {result['snippet'].lower()}"
            
            if '300' in combined and 'runs' in combined:
                cricket_300_count += 1
            if 'captain' in combined:
                captain_count += 1
            if 'morris' in combined:
                morris_count += 1
            if any(date in combined for date in ['1973', '1972']):
                date_count += 1
        
        print(f"Results mentioning 300 runs: {cricket_300_count}")
        print(f"Results mentioning captain: {captain_count}")
        print(f"Results mentioning Morris: {morris_count}")
        print(f"Results with 1972-1973 dates: {date_count}")
        
        # Show most promising results
        print(f"\nüéØ MOST PROMISING RESULTS:")
        promising_count = 0
        for result in all_results:
            if result['title'] == 'No results':
                continue
                
            combined = f"{result['title'].lower()} {result['snippet'].lower()}"
            relevance_score = 0
            
            if '300' in combined: relevance_score += 2
            if 'runs' in combined: relevance_score += 1
            if 'captain' in combined: relevance_score += 2
            if 'morris' in combined: relevance_score += 2
            if 'australia' in combined: relevance_score += 1
            if any(date in combined for date in ['1973', '1972']): relevance_score += 1
            
            if relevance_score >= 4 and promising_count < 3:
                promising_count += 1
                print(f"\n{promising_count}. {result['title']}")
                print(f"   Snippet: {result['snippet'][:200]}...")
                print(f"   Relevance Score: {relevance_score}")
                print(f"   Query: {result['query_text']}")
        
        if promising_count == 0:
            print("No highly relevant results found - may need additional searches")
    
    print(f"\n‚úÖ Search phase completed with {successful_searches} successful searches out of {len(search_queries)} attempts")
    print(f"üìÅ Results saved to: {results_file}")
    print(f"üîç Ready for detailed analysis of Test cricket 300+ runs records!")
```