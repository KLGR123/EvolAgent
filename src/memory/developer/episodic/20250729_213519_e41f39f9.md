### Development Step 2: Analyze Secret Santa Assignments: Map 12 Employees, Their Profiles, Recipients, and 11 Gifts

**Description**: Parse and analyze the attached Word document file data/gaia/2023/validation/cffe0e32-c9a6-4c52-9877-78ceb4aaa9fb.docx to extract information about the Secret Santa gift exchange. Identify all twelve employees, their assigned gift recipients, their profiles with three likes/hobbies each, and the eleven gifts that were actually given. Create a comprehensive mapping of who was supposed to give gifts to whom and which gifts were actually presented.

**Use Cases**:
- HR holiday gift exchange management: automatically parse Word-based signup sheets listing employees, assigned Secret Santa pairings, and individual wish lists to generate a centralized tracker and send personalized reminders.
- Corporate team-building event coordination: extract mentor-mentee assignments and participant profiles from a planning document to automate pairing summaries, gift preferences, and follow-up communications.
- Nonprofit volunteer gift distribution: process volunteer-submitted Word forms containing donor names, recipient profiles, and donated items to create routing lists, label packages, and ensure each beneficiary’s preferences are honored.
- University peer-review assignment automation: parse a course instructor’s Word roster of students, assigned reviewers, and topic interests to produce JSON-formatted schedules, email notifications, and progress dashboards.
- Compliance audit handover logging: extract personnel names, asset assignments, and recipient signatures from Word transfer logs to build an auditable JSON record of equipment handovers and generate summary reports for regulators.
- Market research sampling assignment: convert Word documents detailing respondent IDs, interviewer assignments, and demographic profiles into structured data for quota balancing, field-team dispatching, and survey tracking.
- IT department equipment provisioning: parse Word inventories listing employees, assigned hardware, and software preferences to automatically update the asset management database, trigger deployment workflows, and validate fulfillment.
- Retail loyalty gift fulfillment: process store manager Word files that list VIP customers, their preferred gift items, and shipment assignments to automate order picking lists, packaging labels, and delivery schedules.

```
import os
import json
import re

# First, let's inspect the structure of the saved analysis file
analysis_file = 'workspace/secret_santa_initial_analysis.json'

print("=== INSPECTING SAVED ANALYSIS FILE STRUCTURE ===\n")

if os.path.exists(analysis_file):
    print(f"Analysis file exists: {analysis_file}")
    
    # Load and inspect the structure
    with open(analysis_file, 'r') as f:
        analysis_data = json.load(f)
    
    print("\nTop-level keys in analysis file:")
    for key in analysis_data.keys():
        print(f"  - {key}: {type(analysis_data[key])}")
    
    # Check content structure
    if 'content' in analysis_data:
        content_keys = analysis_data['content'].keys() if isinstance(analysis_data['content'], dict) else "Not a dict"
        print(f"\nContent keys: {content_keys}")
        
        if 'lines' in analysis_data['content']:
            lines = analysis_data['content']['lines']
            print(f"Total lines available: {len(lines)}")
            
        if 'full_text' in analysis_data['content']:
            full_text = analysis_data['content']['full_text']
            print(f"Full text length: {len(full_text)} characters")
else:
    print(f"Analysis file not found: {analysis_file}")
    # We'll work with the content from history
    full_text = """Employees



Harry

Rebecca

Georgette

Micah

Perry

Tyson

Lucy

Jun

Sara

 Miguel

 Fred

 Alex




Gift Assignments



Giftee

Recipient

Harry

Miguel

Rebecca

Micah

Georgette

Lucy

Micah

Jun

Perry

Georgette

Tyson

Fred

Lucy

Alex

Jun

Harry

Sara

Perry

Fred

Rebecca

Miguel

Sara

Alex

Tyson






Profiles



Harry: Fishing, Camping, Wine

Rebecca: Cars, Dogs, Chocolate

Georgette: Yoga, Cooking, Green Energy

Micah: Knitting, Rainy Weather, Books

Perry: Old Movies, Rats, Journaling

Tyson: Historical Fiction Novels, Biking, Parakeets

Lucy: Coffee, Physics, Board Games 

Jun: Woodworking, Barbecue, JavaScript

Sara: Tabletop RPGs, Spas, Music

Miguel: Astronomy, Decorative Washi Tape, Ketchup

Fred: Chemistry, Perl, Cats

Alex: Surfing, Audrey Hepburn, Manga




Gifts:



Galileo Galilei biography

Fishing reel

Raku programming guide

Chisel set

Custom dice

"War and Peace" American film copy

Yarn

"One Piece" graphic novel

"War and Peace" novel

Starbucks gift card

Foam exercise mat"""
    
    lines = [line.strip() for line in full_text.split('\n') if line.strip()]

print("\n=== STRUCTURED DATA EXTRACTION ===\n")

# Get the text content to work with
if os.path.exists(analysis_file):
    with open(analysis_file, 'r') as f:
        analysis_data = json.load(f)
    full_text = analysis_data['content']['full_text']
    lines = analysis_data['content']['lines']
else:
    # Use the text from history as fallback
    lines = [line.strip() for line in full_text.split('\n') if line.strip()]

print(f"Working with {len(lines)} non-empty lines")

# Parse the structured sections
employees = []
gift_assignments = []
profiles = {}
gifts = []

current_section = None
giftee_recipient_mode = False

print("\n=== PARSING SECTIONS ===\n")

for i, line in enumerate(lines):
    print(f"Line {i+1}: '{line}'")
    
    # Identify section headers
    if line == "Employees":
        current_section = "employees"
        print("  → Entering EMPLOYEES section")
        continue
    elif line == "Gift Assignments":
        current_section = "gift_assignments"
        giftee_recipient_mode = False
        print("  → Entering GIFT ASSIGNMENTS section")
        continue
    elif line == "Profiles":
        current_section = "profiles"
        print("  → Entering PROFILES section")
        continue
    elif line == "Gifts:":
        current_section = "gifts"
        print("  → Entering GIFTS section")
        continue
    
    # Process content based on current section
    if current_section == "employees":
        # Skip empty lines and collect employee names
        if line and line not in ["Gift Assignments"]:
            employees.append(line.strip())
            print(f"  → Added employee: {line.strip()}")
    
    elif current_section == "gift_assignments":
        if line == "Giftee":
            giftee_recipient_mode = True
            print("  → Starting giftee-recipient table")
            continue
        elif line == "Recipient":
            continue  # Skip the recipient header
        elif giftee_recipient_mode and line:
            # This is either a giftee or recipient
            if len(gift_assignments) == 0 or len(gift_assignments[-1]) == 2:
                # Start a new assignment pair
                gift_assignments.append([line])
                print(f"  → New assignment - Giftee: {line}")
            else:
                # Complete the current assignment pair
                gift_assignments[-1].append(line)
                giftee = gift_assignments[-1][0]
                recipient = gift_assignments[-1][1]
                print(f"  → Completed assignment - {giftee} → {recipient}")
    
    elif current_section == "profiles":
        if line and ":" in line:
            # Parse profile line: "Name: hobby1, hobby2, hobby3"
            name, hobbies_str = line.split(":", 1)
            name = name.strip()
            hobbies = [hobby.strip() for hobby in hobbies_str.split(",")]
            profiles[name] = hobbies
            print(f"  → Profile for {name}: {hobbies}")
    
    elif current_section == "gifts":
        if line and line != "Gifts:":
            gifts.append(line.strip())
            print(f"  → Added gift: {line.strip()}")

print("\n" + "="*60)
print("EXTRACTION SUMMARY")
print("="*60)

print(f"\nEmployees found: {len(employees)}")
for i, emp in enumerate(employees, 1):
    print(f"  {i:2d}. {emp}")

print(f"\nGift assignments found: {len(gift_assignments)}")
for i, assignment in enumerate(gift_assignments, 1):
    if len(assignment) == 2:
        print(f"  {i:2d}. {assignment[0]} → {assignment[1]}")
    else:
        print(f"  {i:2d}. Incomplete assignment: {assignment}")

print(f"\nProfiles found: {len(profiles)}")
for name, hobbies in profiles.items():
    print(f"  {name}: {', '.join(hobbies)}")

print(f"\nGifts found: {len(gifts)}")
for i, gift in enumerate(gifts, 1):
    print(f"  {i:2d}. {gift}")

# Create the comprehensive mapping structure
secret_santa_data = {
    "employees": employees,
    "gift_assignments": {},
    "profiles": profiles,
    "gifts_given": gifts,
    "analysis": {
        "total_employees": len(employees),
        "total_assignments": len(gift_assignments),
        "total_profiles": len(profiles),
        "total_gifts": len(gifts)
    }
}

# Convert gift assignments list to dictionary for easier lookup
for assignment in gift_assignments:
    if len(assignment) == 2:
        giftee, recipient = assignment
        secret_santa_data["gift_assignments"][giftee] = recipient

print("\n" + "="*60)
print("COMPREHENSIVE SECRET SANTA MAPPING")
print("="*60)

print("\n=== EMPLOYEES (12 total) ===")
for i, employee in enumerate(employees, 1):
    print(f"{i:2d}. {employee}")

print("\n=== GIFT ASSIGNMENTS (Who gives to whom) ===")
for giftee, recipient in secret_santa_data["gift_assignments"].items():
    print(f"{giftee} → {recipient}")

print("\n=== EMPLOYEE PROFILES (3 likes/hobbies each) ===")
for employee in employees:
    if employee in profiles:
        hobbies = profiles[employee]
        print(f"{employee}: {', '.join(hobbies)} ({len(hobbies)} hobbies)")
    else:
        print(f"{employee}: No profile found")

print("\n=== GIFTS ACTUALLY GIVEN (11 total) ===")
for i, gift in enumerate(gifts, 1):
    print(f"{i:2d}. {gift}")

print("\n=== VERIFICATION ===")
print(f"✓ Expected 12 employees: Found {len(employees)}")
print(f"✓ Expected assignments for all: Found {len(secret_santa_data['gift_assignments'])}")
print(f"✓ Expected profiles for all: Found {len(profiles)}")
print(f"✓ Expected 11 gifts given: Found {len(gifts)}")

# Save the structured data
with open('workspace/secret_santa_structured_data.json', 'w') as f:
    json.dump(secret_santa_data, f, indent=2)

print(f"\nStructured data saved to: workspace/secret_santa_structured_data.json")

# Create a readable summary report
with open('workspace/secret_santa_summary_report.txt', 'w') as f:
    f.write("SECRET SANTA GIFT EXCHANGE - COMPREHENSIVE MAPPING\n")
    f.write("="*55 + "\n\n")
    
    f.write("PARTICIPANTS (12 Employees):\n")
    f.write("-" * 30 + "\n")
    for i, employee in enumerate(employees, 1):
        f.write(f"{i:2d}. {employee}\n")
    
    f.write("\nGIFT ASSIGNMENTS (Who was assigned to give gifts to whom):\n")
    f.write("-" * 55 + "\n")
    for giftee, recipient in secret_santa_data["gift_assignments"].items():
        f.write(f"{giftee} → {recipient}\n")
    
    f.write("\nEMPLOYEE PROFILES (3 likes/hobbies each):\n")
    f.write("-" * 40 + "\n")
    for employee in employees:
        if employee in profiles:
            hobbies = profiles[employee]
            f.write(f"{employee}: {', '.join(hobbies)}\n")
    
    f.write("\nGIFTS ACTUALLY GIVEN (11 gifts):\n")
    f.write("-" * 35 + "\n")
    for i, gift in enumerate(gifts, 1):
        f.write(f"{i:2d}. {gift}\n")
    
    f.write("\nSUMMARY STATISTICS:\n")
    f.write("-" * 20 + "\n")
    f.write(f"Total employees: {len(employees)}\n")
    f.write(f"Total gift assignments: {len(secret_santa_data['gift_assignments'])}\n")
    f.write(f"Total profiles: {len(profiles)}\n")
    f.write(f"Total gifts given: {len(gifts)}\n")

print(f"Summary report saved to: workspace/secret_santa_summary_report.txt")

print("\n*** SECRET SANTA ANALYSIS COMPLETE ***")
print("\nAll twelve employees identified with their assigned recipients,")
print("profiles containing three likes/hobbies each, and eleven actual gifts mapped.")
```