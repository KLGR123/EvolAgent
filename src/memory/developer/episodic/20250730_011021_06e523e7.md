### Development Step 1: Identify oldest Blu-Ray title in Seattle movie rental store Excel inventory

**Description**: Parse and analyze the attached Excel file data/gaia/2023/validation/32102e3e-d12a-4209-9163-7b3a104efe5d.xlsx to extract the complete inventory data for the Seattle movie and video game rental store. Identify the data structure including column headers, then filter the inventory to find all Blu-Ray items and determine which one has the oldest date (earliest release or acquisition date). Extract the exact title as it appears in the spreadsheet for the oldest Blu-Ray item.

**Use Cases**:
- Regional video store chain performing periodic inventory audits to identify and retire outdated Blu-Ray titles before stocktaking events
- Film preservation researcher extracting the oldest Blu-Ray release dates from Seattle store records to build a historical acquisition timeline
- Media licensing compliance team automating the detection of the earliest-acquired Blu-Ray titles to ensure renewal contracts are up-to-date
- Marketing division of an entertainment retailer generating nostalgia-focused promotions by locating the oldest Blu-Ray classics in their Seattle inventory
- IT department migrating legacy rental store data to a cloud-based system and validating successful transfer of Blu-Ray item details and acquisition dates
- Independent movie blogger analyzing the first Blu-Ray releases available in local Seattle rental shops to feature in a retrospective review article
- E-commerce reseller scraping spreadsheet data to identify rare, early Blu-Ray stock in the Seattle store for exclusive online listings
- Digital archiving project team prioritizing the digitization of the oldest Blu-Ray titles in the Seattle inventory to safeguard aging physical media

```
import os
import pandas as pd
from openpyxl import load_workbook
import json
from datetime import datetime

# The path to the Excel file to be analyzed
xlsx_path = "data/gaia/2023/validation/32102e3e-d12a-4209-9163-7b3a104efe5d.xlsx"

print("=== SEATTLE RENTAL STORE INVENTORY ANALYSIS ===")
print(f"Analyzing file: {xlsx_path}")

# Check if file exists
if not os.path.exists(xlsx_path):
    print(f"Error: Excel file '{xlsx_path}' does not exist.")
    exit()

print(f"File exists: {xlsx_path}")
file_size = os.path.getsize(xlsx_path)
print(f"File size: {file_size} bytes")

# Load workbook with openpyxl to examine structure and formatting
print("\nLoading workbook with openpyxl to examine structure...")
wb = load_workbook(xlsx_path, data_only=True)  # Use data_only=True to get calculated values

print(f"Number of worksheets: {len(wb.worksheets)}")
print(f"Worksheet names: {[sheet.title for sheet in wb.worksheets]}")

# Examine each worksheet
for sheet_idx, sheet in enumerate(wb.worksheets):
    print(f"\n=== ANALYZING WORKSHEET: {sheet.title} ===")
    
    max_row = sheet.max_row
    max_col = sheet.max_column
    print(f"Sheet dimensions: {max_row} rows x {max_col} columns")
    
    # Get the range of actual data
    min_row = sheet.min_row
    min_col = sheet.min_column
    print(f"Data range: rows {min_row}-{max_row}, columns {min_col}-{max_col}")
    
    print("\n=== FIRST 15 ROWS PREVIEW ===")
    # Display first 15 rows to understand structure
    for row in range(min_row, min(max_row + 1, min_row + 15)):
        row_data = []
        for col in range(min_col, max_col + 1):
            cell = sheet.cell(row=row, column=col)
            cell_value = cell.value if cell.value is not None else ""
            row_data.append(str(cell_value))
        print(f"Row {row}: {row_data}")
    
    print("\n=== COLUMN HEADERS ANALYSIS ===")
    # Examine the first row as potential headers
    headers = []
    for col in range(min_col, max_col + 1):
        cell = sheet.cell(row=min_row, column=col)
        header_value = cell.value if cell.value is not None else f"Col_{col}"
        headers.append(str(header_value))
        print(f"Column {col}: '{header_value}'")
    
    print(f"\nIdentified headers: {headers}")
    
    # Look for inventory-related keywords
    print("\n=== SEARCHING FOR INVENTORY KEYWORDS ===")
    inventory_keywords = ['title', 'format', 'blu-ray', 'bluray', 'dvd', 'date', 'release', 'acquisition', 'year', 'genre', 'price', 'stock']
    
    found_keywords = []
    for row in range(min_row, min(max_row + 1, min_row + 20)):  # Check first 20 rows
        for col in range(min_col, max_col + 1):
            cell = sheet.cell(row=row, column=col)
            if cell.value:
                cell_text = str(cell.value).lower()
                for keyword in inventory_keywords:
                    if keyword in cell_text:
                        found_keywords.append({
                            'row': row,
                            'col': col,
                            'value': cell.value,
                            'keyword': keyword
                        })
                        print(f"Found keyword '{keyword}' in cell ({row}, {col}): '{cell.value}'")
    
    print(f"\nTotal inventory keywords found: {len(found_keywords)}")

# Also load with pandas for easier data manipulation
print("\n" + "="*60)
print("PANDAS DATAFRAME ANALYSIS")
print("="*60)

try:
    # Try to read the Excel file with pandas
    df = pd.read_excel(xlsx_path, sheet_name=None)  # Read all sheets
    
    print(f"Pandas successfully loaded {len(df)} sheet(s)")
    
    for sheet_name, sheet_df in df.items():
        print(f"\n=== PANDAS ANALYSIS: {sheet_name} ===")
        print(f"DataFrame shape: {sheet_df.shape}")
        print(f"Column names: {list(sheet_df.columns)}")
        print(f"Data types:\n{sheet_df.dtypes}")
        
        print("\nFirst 10 rows:")
        print(sheet_df.head(10).to_string(index=False))
        
        print("\nBasic statistics for numeric columns:")
        numeric_cols = sheet_df.select_dtypes(include=['number']).columns
        if len(numeric_cols) > 0:
            print(sheet_df[numeric_cols].describe())
        else:
            print("No numeric columns found")
        
        print("\nMissing values:")
        print(sheet_df.isnull().sum())
        
        # Look specifically for Blu-Ray related data
        print("\n=== SEARCHING FOR BLU-RAY ITEMS ===")
        for col in sheet_df.columns:
            col_data = sheet_df[col].astype(str).str.lower()
            blu_ray_matches = col_data.str.contains('blu', na=False) | col_data.str.contains('ray', na=False)
            if blu_ray_matches.any():
                print(f"Found potential Blu-Ray references in column '{col}':")
                matches = sheet_df[blu_ray_matches][col].head(10)
                for idx, value in matches.items():
                    print(f"  Row {idx}: {value}")
        
        # Look for date columns
        print("\n=== SEARCHING FOR DATE COLUMNS ===")
        date_keywords = ['date', 'release', 'year', 'acquisition', 'added']
        for col in sheet_df.columns:
            col_lower = str(col).lower()
            for keyword in date_keywords:
                if keyword in col_lower:
                    print(f"Found date-related column '{col}':")
                    print(f"  Sample values: {sheet_df[col].head().tolist()}")
                    print(f"  Data type: {sheet_df[col].dtype}")
                    break
        
except Exception as e:
    print(f"Error reading with pandas: {e}")
    print("Will proceed with openpyxl analysis only")

# Save initial analysis
analysis_data = {
    'file_path': xlsx_path,
    'file_size': file_size,
    'worksheets': [sheet.title for sheet in wb.worksheets],
    'analysis_timestamp': datetime.now().isoformat()
}

with open('workspace/rental_store_initial_analysis.json', 'w') as f:
    json.dump(analysis_data, f, indent=2)

print(f"\nInitial analysis saved to: workspace/rental_store_initial_analysis.json")
print("Next step: Extract and filter Blu-Ray items, then find the oldest by date")
```