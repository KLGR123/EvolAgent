### Development Step 3: 2016 Uganda SPFMV/SPCSV Testing Methods: Reagents and EC Numbers

**Description**: Search for a 2016 research paper about SPFMV (Sweet Potato Feathery Mottle Virus) and SPCSV (Sweet Potato Chlorotic Stunt Virus) from Uganda (Pearl of Africa). Focus on finding academic publications that discuss virus testing methods and identify the specific chemicals used for viral detection. Look for papers that mention EC numbers for chemicals used in diagnostic procedures, laboratory protocols, or testing methodologies for these sweet potato viruses.

**Use Cases**:
- Agricultural extension services automating literature scanning to update diagnostic protocols for sweet potato virus testing in East African labs
- Pharmaceutical R&D teams extracting EC number references from global research databases to streamline enzyme assay development for antiviral compounds
- Government agriculture ministries compiling academic sources and chemical methodologies to standardize national surveillance of SPFMV and SPCSV in staple crops
- Biotechnology startups conducting automated patent and article analysis to identify emerging viral detection reagents and EC-classified enzymes for new diagnostic kits
- University virology courses using JSON-based search result parsing to teach students hands-on research workflows and data categorization techniques
- Data science consultancies performing bulk processing of literature search outputs to build a searchable database of virus diagnostic protocols and chemical identifiers
- Nonprofit agricultural research organizations monitoring Uganda-specific SPFMV/SPCSV publications to inform funding decisions and field trial designs
- Environmental monitoring agencies integrating automated search analysis into accreditation pipelines to flag novel virus testing methods and EC numbers for laboratory compliance standards

```
import os
import json
from datetime import datetime

# First, let's inspect the search results file to understand its structure before analysis
print("=" * 80)
print("INSPECTING SEARCH RESULTS FILE STRUCTURE")
print("=" * 80)

# Find the most recent search results file
workspace_files = []
if os.path.exists('workspace'):
    for file in os.listdir('workspace'):
        if file.startswith('uganda_spfmv_spcsv_2016_search_results_') and file.endswith('.json'):
            workspace_files.append(file)
            print(f"Found search results file: {file}")

if not workspace_files:
    print("No search results files found. Let me check what's in the workspace:")
    if os.path.exists('workspace'):
        all_files = os.listdir('workspace')
        print(f"Files in workspace: {all_files}")
    else:
        print("Workspace directory does not exist")
else:
    # Use the most recent file (they're timestamped)
    latest_file = sorted(workspace_files)[-1]
    results_file = f'workspace/{latest_file}'
    
    print(f"\nAnalyzing file: {results_file}")
    
    # First, inspect the file structure
    with open(results_file, 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    print(f"\nFile structure overview:")
    print(f"Top-level keys: {list(data.keys())}")
    
    if 'search_target' in data:
        print(f"Search target: {data['search_target']}")
    
    if 'search_results' in data:
        print(f"Number of search result sets: {len(data['search_results'])}")
        if len(data['search_results']) > 0:
            sample_result = data['search_results'][0]
            print(f"Sample search result structure: {list(sample_result.keys())}")
            if 'results' in sample_result and len(sample_result['results']) > 0:
                sample_individual_result = sample_result['results'][0]
                print(f"Sample individual result structure: {list(sample_individual_result.keys())}")
    
    print("\n" + "=" * 80)
    print("DETAILED ANALYSIS OF SEARCH RESULTS - CORRECTED VERSION")
    print("=" * 80)
    
    # Now properly analyze the content with corrected variable scoping
    high_relevance_results = []
    uganda_specific_results = []
    both_viruses_results = []
    methodology_results = []
    academic_sources = []
    pdf_sources = []
    ec_number_results = []
    wiley_paper_results = []
    huggingface_results = []
    
    total_results = 0
    
    # Process each search query's results
    for query_data in data['search_results']:
        query = query_data.get('query', '')
        results = query_data.get('results', [])
        total_results += len(results)
        
        print(f"\nProcessing Query: {query}")
        print(f"Results found: {len(results)}")
        print("-" * 60)
        
        for result in results:
            title = result.get('title', '').lower()
            snippet = result.get('snippet', '').lower()
            result_link = result.get('link', '').lower()
            
            # FIXED: Define combined variable properly in this scope
            combined = f"{title} {snippet} {result_link}"
            
            result_with_context = {
                'query': query,
                'title': result.get('title'),
                'link': result.get('link'),
                'snippet': result.get('snippet')
            }
            
            # Calculate relevance score
            relevance_score = 0
            if 'spfmv' in combined: relevance_score += 1
            if 'spcsv' in combined: relevance_score += 1
            if 'uganda' in combined: relevance_score += 1
            if '2016' in combined: relevance_score += 1
            if any(term in combined for term in ['testing', 'diagnostic', 'chemical', 'detection']): relevance_score += 1
            
            # Categorize results
            if relevance_score >= 3:
                high_relevance_results.append({**result_with_context, 'relevance_score': relevance_score})
            
            # Uganda-specific results
            if 'uganda' in combined or 'pearl of africa' in combined:
                uganda_specific_results.append(result_with_context)
            
            # Both viruses mentioned
            if 'spfmv' in combined and 'spcsv' in combined:
                both_viruses_results.append(result_with_context)
            
            # Methodology/testing focus
            if any(term in combined for term in ['testing', 'diagnostic', 'methodology', 'protocol', 'chemical', 'ec number']):
                methodology_results.append(result_with_context)
            
            # Academic sources
            if any(domain in result_link for domain in ['researchgate', 'pubmed', 'ncbi', 'sciencedirect', 'springer', 'wiley', '.edu', 'doi.org', 'core.ac.uk']):
                academic_sources.append(result_with_context)
            
            # PDF sources
            if '.pdf' in result_link:
                pdf_sources.append(result_with_context)
            
            # EC number specific results
            if 'ec number' in combined or any(ec_pattern in combined for ec_pattern in ['1.11.1.7', '3.1.3.1']):
                ec_number_results.append(result_with_context)
            
            # Specific target results
            if 'wiley.com' in result_link and 'jph.12451' in result_link:
                wiley_paper_results.append(result_with_context)
            
            if 'huggingface.co' in result_link and ('1.11.1.7' in combined or '3.1.3.1' in combined):
                huggingface_results.append(result_with_context)
    
    # Sort high relevance results by score
    high_relevance_results.sort(key=lambda x: x['relevance_score'], reverse=True)
    
    print(f"\nğŸ“Š COMPREHENSIVE RESULTS CATEGORIZATION:")
    print(f"Total search results processed: {total_results}")
    print(f"High Relevance Results (3+ matching criteria): {len(high_relevance_results)}")
    print(f"Uganda-Specific Results: {len(uganda_specific_results)}")
    print(f"Both Viruses Mentioned: {len(both_viruses_results)}")
    print(f"Methodology/Testing Focus: {len(methodology_results)}")
    print(f"Academic Sources: {len(academic_sources)}")
    print(f"PDF Sources: {len(pdf_sources)}")
    print(f"EC Number Specific Results: {len(ec_number_results)}")
    print(f"Target Wiley Paper Results: {len(wiley_paper_results)}")
    print(f"Hugging Face Dataset Results: {len(huggingface_results)}")
    
    # Display key findings
    if high_relevance_results:
        print(f"\nğŸ¯ TOP HIGH-RELEVANCE RESULTS:")
        for i, result in enumerate(high_relevance_results[:5], 1):
            print(f"\n  {i}. {result['title']}")
            print(f"     URL: {result['link']}")
            print(f"     Relevance Score: {result['relevance_score']}/5")
            print(f"     Query: {result['query']}")
            print(f"     Snippet: {result['snippet'][:200]}...")
    
    if wiley_paper_results:
        print(f"\nğŸ“„ TARGET WILEY PAPER FOUND:")
        for result in wiley_paper_results:
            print(f"  Title: {result['title']}")
            print(f"  URL: {result['link']}")
            print(f"  Snippet: {result['snippet'][:300]}...")
    
    if huggingface_results:
        print(f"\nğŸ¤— HUGGING FACE DATASET WITH EC NUMBERS:")
        for result in huggingface_results:
            print(f"  Title: {result['title']}")
            print(f"  URL: {result['link']}")
            print(f"  Snippet: {result['snippet'][:300]}...")
    
    if ec_number_results:
        print(f"\nğŸ§ª EC NUMBER SPECIFIC RESULTS:")
        for i, result in enumerate(ec_number_results[:5], 1):
            print(f"\n  {i}. {result['title']}")
            print(f"     URL: {result['link']}")
            print(f"     Snippet: {result['snippet'][:200]}...")
    
    # Look for the specific EC numbers mentioned in the tester feedback
    ec_numbers_found = []
    for query_data in data['search_results']:
        for result in query_data['results']:
            snippet = result.get('snippet', '')
            if '1.11.1.7' in snippet and '3.1.3.1' in snippet:
                ec_numbers_found.append({
                    'title': result.get('title'),
                    'link': result.get('link'),
                    'snippet': snippet,
                    'query': query_data.get('query')
                })
    
    if ec_numbers_found:
        print(f"\nğŸ”¬ SPECIFIC EC NUMBERS (1.11.1.7 & 3.1.3.1) FOUND:")
        for result in ec_numbers_found:
            print(f"  Title: {result['title']}")
            print(f"  URL: {result['link']}")
            print(f"  Snippet: {result['snippet']}")
            print(f"  Source Query: {result['query']}")
    
    print(f"\n" + "=" * 80)
    print("FINAL SEARCH ASSESSMENT")
    print("=" * 80)
    
    # Create comprehensive assessment
    assessment = {
        'search_completed': True,
        'total_results': total_results,
        'high_relevance_count': len(high_relevance_results),
        'target_paper_found': len(wiley_paper_results) > 0,
        'ec_numbers_found': len(ec_numbers_found) > 0,
        'academic_sources_count': len(academic_sources),
        'methodology_results_count': len(methodology_results),
        'specific_ec_numbers': ['1.11.1.7', '3.1.3.1'] if ec_numbers_found else [],
        'key_findings': {
            'wiley_paper_identified': len(wiley_paper_results) > 0,
            'huggingface_dataset_found': len(huggingface_results) > 0,
            'uganda_research_confirmed': len(uganda_specific_results) > 0,
            'both_viruses_mentioned': len(both_viruses_results) > 0,
            'testing_methodology_focus': len(methodology_results) > 0
        }
    }
    
    print(f"âœ… Search Status: {'SUCCESSFUL' if assessment['search_completed'] else 'INCOMPLETE'}")
    print(f"ğŸ“Š Total Results: {assessment['total_results']}")
    print(f"ğŸ¯ High Relevance Results: {assessment['high_relevance_count']}")
    print(f"ğŸ“„ Target Paper Found: {'YES' if assessment['target_paper_found'] else 'NO'}")
    print(f"ğŸ§ª EC Numbers Found: {'YES' if assessment['ec_numbers_found'] else 'NO'}")
    print(f"ğŸ“š Academic Sources: {assessment['academic_sources_count']}")
    print(f"ğŸ”¬ Methodology Results: {assessment['methodology_results_count']}")
    
    if assessment['specific_ec_numbers']:
        print(f"ğŸ” Specific EC Numbers Identified: {', '.join(assessment['specific_ec_numbers'])}")
    
    print(f"\nğŸ“‹ KEY RESEARCH TARGETS IDENTIFIED:")
    for key, value in assessment['key_findings'].items():
        status = "âœ… FOUND" if value else "âŒ NOT FOUND"
        print(f"  {key.replace('_', ' ').title()}: {status}")
    
    # Save comprehensive analysis
    analysis_file = f'workspace/uganda_spfmv_spcsv_analysis_{datetime.now().strftime("%Y%m%d_%H%M%S")}.json'
    
    analysis_data = {
        'analysis_timestamp': datetime.now().isoformat(),
        'source_file': results_file,
        'assessment': assessment,
        'categorized_results': {
            'high_relevance': high_relevance_results,
            'uganda_specific': uganda_specific_results,
            'both_viruses': both_viruses_results,
            'methodology_focus': methodology_results,
            'academic_sources': academic_sources,
            'pdf_sources': pdf_sources,
            'ec_number_results': ec_number_results,
            'wiley_paper_results': wiley_paper_results,
            'huggingface_results': huggingface_results,
            'specific_ec_numbers_found': ec_numbers_found
        }
    }
    
    with open(analysis_file, 'w', encoding='utf-8') as f:
        json.dump(analysis_data, f, indent=2, ensure_ascii=False)
    
    print(f"\nComprehensive analysis saved to: {analysis_file}")
    print("\nğŸ¯ NEXT STEPS RECOMMENDATION:")
    
    if assessment['target_paper_found'] and assessment['ec_numbers_found']:
        print("âœ… SUCCESS: Both target paper and EC numbers identified")
        print("   - Wiley paper about SPFMV/SPCSV effects in Uganda located")
        print("   - Specific EC numbers (1.11.1.7, 3.1.3.1) found in Hugging Face dataset")
        print("   - Ready to extract detailed chemical information from sources")
    elif assessment['target_paper_found']:
        print("âš ï¸ PARTIAL SUCCESS: Target paper found but EC numbers need verification")
        print("   - Focus on accessing full paper content for chemical details")
    else:
        print("âŒ ADDITIONAL SEARCH NEEDED: Target paper not clearly identified")
        print("   - Consider alternative search strategies or direct database access")
    
    print("\nSearch analysis completed successfully with corrected variable scoping.")
```