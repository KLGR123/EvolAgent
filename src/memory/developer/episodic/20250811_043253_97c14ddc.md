### Development Step 4: Title: Extract Unique Food Items and Identify Non-Duplicates from Excel Inventory Data

**Description**: Parse and analyze the attached Excel file data/gaia/2023/validation/9b54f9d9-35ee-4a14-b62f-d130ea00317f/food_duplicates.xls to extract all food items listed in the spreadsheet. Identify the complete inventory of food names and examine for any duplicates or variations of the same food item appearing under different names. Create a comprehensive list of all unique food items and identify which single food item appears only once without any duplicate entries or alternative naming variations.

**Use Cases**:
- Restaurant chain menu standardization to identify duplicate or variant food items across multiple locations for consistent branding and inventory management
- Food safety compliance audits to detect mislabeled or ambiguously named ingredients in supplier spreadsheets
- Nutrition database consolidation by extracting and unifying food item names from diverse Excel sources, eliminating duplicates and synonyms
- Automated quality control in food manufacturing to ensure unique labeling of products and prevent redundant SKU entries
- Academic research in food science analyzing dietary surveys to accurately count unique food items consumed by study participants
- Retail grocery inventory optimization by merging supplier lists and removing duplicate or synonym product entries for efficient stock management
- Regulatory compliance checks for import/export food documentation to ensure all listed items are uniquely identified and not duplicated under alternative names
- Culinary content curation for recipe websites, ensuring ingredient lists are free from redundant or synonym entries for improved user searchability

```
import os
import json
import pandas as pd
from collections import Counter

# Load the Excel file to examine the remaining 5 unique items in context
xls_path = "data/gaia/2023/validation/9b54f9d9-35ee-4a14-b62f-d130ea00317f/food_duplicates.xls"
df = pd.read_excel(xls_path)

print("=== FINAL ANALYSIS: EXAMINING THE LAST 5 UNIQUE ITEMS ===")
print(f"Analyzing file: {xls_path}")

# The 5 remaining unique items from previous analysis
remaining_items = ['boba', 'goat meat', 'mutton', 'tapioca', 'turtle soup']
print(f"\nRemaining 5 unique items to analyze: {remaining_items}")

# Display the complete dataset again to see these items in context
print("\n=== COMPLETE DATASET FOR CONTEXT ===")
print(df.to_string(index=False))

# Let's examine each of the 5 remaining items more carefully
print("\n=== DETAILED ANALYSIS OF REMAINING 5 ITEMS ===")

# Extract all food items including column headers
all_food_items = []
for col in df.columns:
    food_values = [col] + df[col].dropna().tolist()
    for item in food_values:
        item_str = str(item).strip().lower()
        if item_str:
            all_food_items.append(item_str)

print(f"\nTotal food items in dataset: {len(all_food_items)}")

# Check if any of the 5 items might have additional relationships
print("\nAnalyzing each remaining item:")

for item in remaining_items:
    print(f"\n--- {item.upper()} ---")
    
    # Count occurrences
    count = all_food_items.count(item)
    print(f"Occurrences in dataset: {count}")
    
    # Look for potential relationships
    if item == 'boba':
        print("Analysis: Boba is bubble tea pearls, typically tapioca-based")
        print("Potential relationship: Could be related to 'tapioca' since boba is made from tapioca")
    elif item == 'goat meat':
        print("Analysis: Meat from goats")
        print("Note: Different from mutton (sheep meat)")
    elif item == 'mutton':
        print("Analysis: Meat from sheep")
        print("Note: Different from goat meat")
    elif item == 'tapioca':
        print("Analysis: Starch extracted from cassava root")
        print("Potential relationship: Boba pearls are made from tapioca starch")
    elif item == 'turtle soup':
        print("Analysis: Soup made from turtle meat")
        print("Note: Distinct dish, no obvious synonyms")

# Test the potential boba-tapioca relationship
print("\n=== TESTING BOBA-TAPIOCA RELATIONSHIP ===")
print("Boba (bubble tea pearls) are made from tapioca starch.")
print("This could be considered a semantic relationship.")

# Create final synonym dictionary including boba-tapioca
final_food_synonyms = {
    # All previous relationships plus:
    'tapioca': ['boba'],  # Boba is made from tapioca
    
    # Keep all existing relationships from expanded analysis
    'zucchini': ['courgette'],
    'eggplant': ['aubergine'],
    'bell pepper': ['capsicum'],
    'beet': ['beetroot'],
    'cilantro': ['coriander'],
    'arugula': ['rocket'],
    'broccoli rabe': ['rapini'],
    'chickpea': ['garbanzo bean'],
    'avocado': ['alligator pear'],
    'beef': ['cow meat'],
    'veal': ['calf meat'],
    'pigeon': ['squab'],
    'foie gras': ['fatty goose liver'],
    'crawdad': ['mudbug'],
    'clam': ['geoduck'],
    'rice krispies': ['puffed rice'],
    'congee': ['rice porridge'],
    'cotton candy': ['candy floss'],
    'confectioner\'s sugar': ['icing sugar'],
    'jelly donut': ['jam doughnut'],
    'cupcake': ['fairy cake'],
    'candy': ['bonbon'],
    'soda': ['pop'],
    'coffee': ['java'],
    'dried cranberries': ['craisins'],
    'golden raisin': ['sultana'],
    'sandwich': ['hoagie'],
    'fries': ['chips'],
    'angel hair pasta': ['capellini'],
    'soy curds': ['tofu'],
    'fleur de sel': ['salt'],
    'hot wings': ['buffalo wings'],
    'mac and cheese': ['kraft dinner'],
    'pancake': ['flapjack'],
    'rasher': ['bacon strip'],
    'hand pies': ['pasties'],
    'deer meat': ['venison'],
    'stomach': ['tripe'],
    'sweetbread': ['calf thymus'],
    'cottage cheese': ['farmer\'s cheese'],
    'relish': ['pickle'],
    'peas': ['sugar snaps'],
    'squash': ['pumpkin'],
    'nectar': ['agave'],
    'shish kebab': ['skewer'],
    'granola': ['oat cereal'],
    'lizardfish': ['bombay duck']
}

print(f"\nFinal synonym groups: {len(final_food_synonyms)}")

# Create reverse mapping
synonym_groups = {}
for main_term, synonyms in final_food_synonyms.items():
    group = [main_term] + synonyms
    for term in group:
        synonym_groups[term] = tuple(sorted(group))

# Group items by semantic equivalence
semantic_groups = {}
ungrouped_items = []

for item in all_food_items:
    if item in synonym_groups:
        group_key = synonym_groups[item]
        if group_key not in semantic_groups:
            semantic_groups[group_key] = []
        semantic_groups[group_key].append(item)
    else:
        ungrouped_items.append(item)

# Analyze groups
groups_with_duplicates = []
groups_without_duplicates = []

for group_key, items in semantic_groups.items():
    unique_items = list(set(items))
    if len(unique_items) > 1:
        groups_with_duplicates.append((group_key, unique_items))
    else:
        groups_without_duplicates.append((group_key, unique_items))

# Count ungrouped items
ungrouped_counter = Counter(ungrouped_items)
ungrouped_appearing_once = [item for item, count in ungrouped_counter.items() if count == 1]

# Find truly unique items
true_unique_items = ungrouped_appearing_once + [items[0] for _, items in groups_without_duplicates]

print(f"\n=== FINAL RESULTS ===")
print(f"Groups with semantic duplicates: {len(groups_with_duplicates)}")
print(f"Items appearing only once: {len(true_unique_items)}")

print(f"\nFinal unique items:")
for item in sorted(true_unique_items):
    print(f"  - {item}")

# Check if boba-tapioca relationship was applied
if 'boba' in synonym_groups and 'tapioca' in synonym_groups:
    boba_group = synonym_groups['boba']
    tapioca_group = synonym_groups['tapioca']
    if boba_group == tapioca_group:
        print(f"\n✓ Boba-tapioca relationship successfully applied: {list(boba_group)}")
    else:
        print(f"\n✗ Boba-tapioca relationship not applied correctly")
else:
    print(f"\n? Boba-tapioca relationship status unclear")

# Save final analysis
final_analysis = {
    'total_items': len(all_food_items),
    'final_unique_items_count': len(true_unique_items),
    'final_unique_items': sorted(true_unique_items),
    'semantic_duplicates_count': len(groups_with_duplicates),
    'boba_tapioca_relationship_applied': 'boba' in synonym_groups and 'tapioca' in synonym_groups
}

os.makedirs('workspace', exist_ok=True)
with open('workspace/final_unique_analysis.json', 'w') as f:
    json.dump(final_analysis, f, indent=2)

print(f"\nFinal analysis saved to: workspace/final_unique_analysis.json")

if len(true_unique_items) == 1:
    print(f"\n*** FINAL ANSWER: The single food item that appears only once is: '{true_unique_items[0]}' ***")
else:
    print(f"\n*** Found {len(true_unique_items)} items appearing only once ***")
    print("Remaining items to analyze further:")
    for item in sorted(true_unique_items):
        print(f"  - {item}")
```