### Development Step 6: Determine Missing Gift-Giver by Cross-Referencing Gifts and Recipient Interests

**Description**: Determine which employee did not give a gift by comparing the list of twelve employees who were assigned to give gifts against the eleven gifts that were actually given. Cross-reference each actual gift with its giver based on the recipient's profile interests, then identify which of the twelve assigned gift-givers is missing from the actual gift exchange list.

**Use Cases**:
- Classroom peer-review submission tracking and non-submitter detection by matching review content to student topic assignments
- HR asset return audit for onboarding/offboarding, identifying employees who failed to return assigned laptops or phones by matching serial numbers in return logs to employee records
- Conference peer-review management, cross-referencing paper reviews with reviewer expertise keywords to flag reviewers who didn’t submit their assigned evaluations
- Volunteer event check-in verification, matching shift activity logs to volunteer role profiles to detect volunteers who missed their scheduled time slots
- Retail gift-card distribution monitoring, correlating redemption metadata with sales associate IDs to identify associates who didn’t distribute their allocated gift cards
- Charity sponsorship donation tracking, analyzing donation notes against sponsored recipient profiles to pinpoint sponsors who haven’t fulfilled their pledges
- Manufacturing quality-control inspection audit, comparing inspector assignments with inspection report details and specialization keywords to uncover skipped inspection tasks

```
import os
import json

print('=== LOADING AND ANALYZING SECRET SANTA DATA (CORRECTED) ===')
print('Based on the file inspection, secret_santa_structured_data.json contains the complete dataset.')
print('Loading the structured data for gift exchange analysis...')
print()

# Load the structured secret santa data
with open('workspace/secret_santa_structured_data.json', 'r', encoding='utf-8') as f:
    santa_data = json.load(f)

# Extract the key components
employees = santa_data['employees']
gift_assignments = santa_data['gift_assignments'] 
profiles = santa_data['profiles']
gifts_given = santa_data['gifts_given']
analysis_summary = santa_data['analysis']

print('=== DATASET OVERVIEW ===')
print(f'Total employees assigned to give gifts: {len(employees)}')
print(f'Total gift assignments: {len(gift_assignments)}')
print(f'Total employee profiles: {len(profiles)}')
print(f'Total gifts actually given: {len(gifts_given)}')
print()

print('=== TWELVE EMPLOYEES ASSIGNED TO GIVE GIFTS ===')
for i, employee in enumerate(employees, 1):
    print(f'{i:2d}. {employee}')
print()

print('=== ELEVEN GIFTS ACTUALLY GIVEN ===')
for i, gift in enumerate(gifts_given, 1):
    gift_preview = gift[:80] + '...' if len(gift) > 80 else gift
    print(f'{i:2d}. {gift_preview}')
print()

print('=== EMPLOYEE PROFILES (for gift matching) ===')
for employee, profile in profiles.items():
    if isinstance(profile, list):
        profile_str = ', '.join(profile)
    else:
        profile_str = str(profile)
    print(f'{employee}: {profile_str}')
print()

print('=== GIFT ASSIGNMENTS (Employee -> Recipient) ===')
for giver, recipient in gift_assignments.items():
    print(f'{giver} -> {recipient}')
print()

# Now analyze: match each gift to its giver based on recipient profiles
print('=== MATCHING GIFTS TO GIVERS ===')
print('Cross-referencing each gift with recipient profiles to identify the giver...')
print()

gift_to_giver_matches = []

for i, gift in enumerate(gifts_given, 1):
    print(f'GIFT {i}: {gift}')
    print('Checking which recipient profile matches this gift...')
    
    # Check each recipient's profile to see if this gift matches their interests
    potential_matches = []
    
    for employee, profile in profiles.items():
        # Handle profile as list (corrected from previous error)
        if isinstance(profile, list):
            profile_interests = [interest.lower() for interest in profile]
        else:
            profile_interests = [str(profile).lower()]
        
        # Check if this gift seems relevant to this person's profile
        gift_lower = gift.lower()
        
        # Look for keyword matches between gift and profile interests
        overlap_count = 0
        matching_words = []
        
        # Check each profile interest against the gift
        for interest in profile_interests:
            interest_words = interest.split()
            gift_words = gift_lower.split()
            
            # Check for direct matches or partial matches
            for interest_word in interest_words:
                for gift_word in gift_words:
                    if interest_word in gift_word or gift_word in interest_word:
                        if len(interest_word) > 2 and len(gift_word) > 2:  # Avoid tiny words
                            overlap_count += 1
                            matching_words.append(f'{interest_word}<->{gift_word}')
        
        # Also check for broader category matches
        for interest in profile_interests:
            if 'fishing' in interest and 'fishing' in gift_lower:
                overlap_count += 3
                matching_words.append('fishing-exact-match')
            elif 'coffee' in interest and 'starbucks' in gift_lower:
                overlap_count += 3
                matching_words.append('coffee-starbucks-match')
            elif 'yoga' in interest and 'exercise' in gift_lower:
                overlap_count += 2
                matching_words.append('yoga-exercise-match')
            elif 'knitting' in interest and 'yarn' in gift_lower:
                overlap_count += 3
                matching_words.append('knitting-yarn-match')
            elif 'woodworking' in interest and 'chisel' in gift_lower:
                overlap_count += 3
                matching_words.append('woodworking-chisel-match')
            elif 'astronomy' in interest and 'galileo' in gift_lower:
                overlap_count += 3
                matching_words.append('astronomy-galileo-match')
            elif 'tabletop rpgs' in interest and 'dice' in gift_lower:
                overlap_count += 3
                matching_words.append('rpg-dice-match')
            elif 'manga' in interest and ('manga' in gift_lower or 'piece' in gift_lower):
                overlap_count += 2
                matching_words.append('manga-match')
            elif 'old movies' in interest and 'film' in gift_lower:
                overlap_count += 2
                matching_words.append('movies-film-match')
            elif 'historical fiction' in interest and 'war and peace' in gift_lower:
                overlap_count += 3
                matching_words.append('historical-fiction-match')
            elif 'programming' in gift_lower or 'raku' in gift_lower:
                if 'perl' in interest or 'javascript' in interest:
                    overlap_count += 2
                    matching_words.append('programming-match')
        
        if overlap_count > 0:
            potential_matches.append((employee, matching_words, overlap_count))
    
    # Sort by overlap count (best match first)
    potential_matches.sort(key=lambda x: x[2], reverse=True)
    
    if potential_matches:
        best_match = potential_matches[0]
        recipient = best_match[0]
        matching_words = best_match[1]
        score = best_match[2]
        
        print(f'  BEST MATCH: {recipient} (score: {score}, matches: {matching_words})')
        
        # Find who was assigned to give a gift to this recipient
        giver = None
        for assigned_giver, assigned_recipient in gift_assignments.items():
            if assigned_recipient == recipient:
                giver = assigned_giver
                break
        
        if giver:
            print(f'  GIVER: {giver} was assigned to give gift to {recipient}')
            gift_to_giver_matches.append((gift, recipient, giver))
        else:
            print(f'  ERROR: No one was assigned to give gift to {recipient}')
    else:
        print(f'  WARNING: No clear profile match found for this gift')
    
    print()

# Summary of gift-giver matches
print('=== SUMMARY: GIFT-GIVER MATCHES ===')
actual_givers = set()
for i, (gift, recipient, giver) in enumerate(gift_to_giver_matches, 1):
    gift_preview = gift[:60] + '...' if len(gift) > 60 else gift
    print(f'{i:2d}. {giver} gave "{gift_preview}" to {recipient}')
    actual_givers.add(giver)

print()
print('=== IDENTIFYING THE MISSING GIFT-GIVER ===')
print(f'Employees assigned to give gifts ({len(employees)}): {sorted(employees)}')
print(f'Employees who actually gave gifts ({len(actual_givers)}): {sorted(actual_givers)}')
print()

missing_givers = set(employees) - actual_givers

if len(missing_givers) == 1:
    missing_giver = list(missing_givers)[0]
    print(f'*** ANSWER: {missing_giver} did not give a gift ***')
    
    # Show details about this employee
    assigned_recipient = gift_assignments.get(missing_giver, 'Unknown')
    print(f'\n{missing_giver} was assigned to give a gift to: {assigned_recipient}')
    if assigned_recipient in profiles:
        recipient_profile = profiles[assigned_recipient]
        if isinstance(recipient_profile, list):
            profile_str = ', '.join(recipient_profile)
        else:
            profile_str = str(recipient_profile)
        print(f'{assigned_recipient}\'s interests: {profile_str}')
else:
    print(f'ERROR: Found {len(missing_givers)} missing givers: {missing_givers}')
    print('Expected exactly 1 missing giver.')
    print('\nDebugging - All employees vs actual givers:')
    for emp in sorted(employees):
        status = 'GAVE GIFT' if emp in actual_givers else 'DID NOT GIVE GIFT'
        print(f'  {emp}: {status}')

print('\n=== ANALYSIS COMPLETE ===')

# Save results to workspace
results = {
    'analysis_type': 'Secret Santa Missing Gift-Giver',
    'employees_assigned': employees,
    'gifts_given_count': len(gifts_given),
    'gift_giver_matches': [(gift, recipient, giver) for gift, recipient, giver in gift_to_giver_matches],
    'actual_givers': sorted(list(actual_givers)),
    'missing_giver': list(missing_givers)[0] if len(missing_givers) == 1 else None,
    'missing_givers_all': sorted(list(missing_givers))
}

with open('workspace/gift_exchange_analysis_results.json', 'w') as f:
    json.dump(results, f, indent=2)

print('Results saved to: workspace/gift_exchange_analysis_results.json')
```