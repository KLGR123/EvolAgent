### Development Step 2: Identify Steam Locomotives and Calculate Total Wheels from North American Railroad Museum Excel Data

**Description**: Parse and analyze the attached Excel file data/gaia/2023/validation/54612da3-fd56-4941-80f4-5eb82330de25.xlsx to extract locomotive data from the North American railroad museum collection. Identify all steam locomotives in the collection by examining locomotive types, wheel configurations, or other identifying characteristics, then calculate the total number of wheels for all steam locomotives listed.

**Use Cases**:
- Heritage railway museum inventory digitization and wheel count verification for annual preservation audits
- Steam locomotive restoration workshop workload estimation and parts ordering based on total wheel count calculations
- Transportation engineering research study on historical locomotive designs with automated extraction of wheel configuration statistics
- Insurance valuation and risk assessment of steam locomotive collections for underwriters requiring precise wheel count data
- Real-time exhibit dashboard integration for museum visitors displaying locomotive wheel configurations and total counts
- Regulatory compliance reporting and safety audit automation for steam engines needing wheel count verification for certification
- National railway archive digital cataloging and metadata enrichment using automated locomotive type classification and wheel calculation
- Heritage excursion service scheduling and resource planning with automated wheel count metrics to allocate maintenance crews

```
import os
import pandas as pd
import json
import re

print("=== STEAM LOCOMOTIVE WHEEL COUNT CALCULATION ===\n")

# Load the Excel file and extract steam locomotive data
xlsx_path = "data/gaia/2023/validation/54612da3-fd56-4941-80f4-5eb82330de25.xlsx"

print(f"Loading Excel file: {xlsx_path}")
df = pd.read_excel(xlsx_path)

print(f"\nDataFrame shape: {df.shape}")
print(f"Column names: {list(df.columns)}")

print("\n=== COMPLETE LOCOMOTIVE DATABASE ===\n") 
print(df.to_string())

# Clean the data by removing category header rows (Steam, Diesel) and empty rows
print("\n=== IDENTIFYING STEAM LOCOMOTIVES ===\n")
print("Removing category header rows and empty rows...")

# Remove rows where Number column contains 'Steam' or 'Diesel' (these are category headers)
clean_df = df[~df['Number'].isin(['Steam', 'Diesel'])].copy()

# Remove rows with missing locomotive numbers or wheel configurations
clean_df = clean_df.dropna(subset=['Number', 'Type/Wheel Configuration'])

print(f"\nCleaned DataFrame shape: {clean_df.shape}")
print("\nCleaned locomotive data:")
print(clean_df.to_string())

# Based on the data structure, steam locomotives are those with wheel configuration patterns
# Steam locomotives have wheel configurations like 0-4-0, 4-4-0, 2-6-0, 2-8-0, 2-6-4, 2-8-4
# Diesel locomotives have model designations like NW2, F3, PA, GP15, GP30, SW1, RS3, F7

def is_steam_locomotive(type_config):
    """Determine if locomotive is steam based on wheel configuration pattern"""
    if pd.isna(type_config):
        return False
    
    # Steam locomotives have wheel configuration patterns like X-Y-Z (numbers with dashes)
    wheel_config_pattern = re.compile(r'^\d+-\d+-\d+$|^\d+-\d+$')
    return bool(wheel_config_pattern.match(str(type_config)))

def calculate_wheels_from_configuration(wheel_config):
    """Calculate total wheels from wheel configuration string"""
    if pd.isna(wheel_config):
        return 0
    
    # Extract numbers from wheel configuration (e.g., "2-8-4" -> [2, 8, 4])
    numbers = re.findall(r'\d+', str(wheel_config))
    
    if not numbers:
        return 0
    
    # Sum all the wheel numbers
    total_wheels = sum(int(num) for num in numbers)
    return total_wheels

# Identify steam locomotives
steam_locomotives = clean_df[clean_df['Type/Wheel Configuration'].apply(is_steam_locomotive)].copy()

print(f"\n=== STEAM LOCOMOTIVES IDENTIFIED ===\n")
print(f"Total steam locomotives found: {len(steam_locomotives)}")
print("\nSteam locomotive details:")
for idx, row in steam_locomotives.iterrows():
    print(f"  Locomotive #{row['Number']} - Wheel Configuration: {row['Type/Wheel Configuration']} - Status: {row['Operating Status']}")

# Calculate wheels for each steam locomotive
print("\n=== WHEEL COUNT CALCULATIONS ===\n")

steam_locomotives['Wheel_Count'] = steam_locomotives['Type/Wheel Configuration'].apply(calculate_wheels_from_configuration)

total_wheels = 0
for idx, row in steam_locomotives.iterrows():
    wheel_config = row['Type/Wheel Configuration']
    wheel_count = row['Wheel_Count']
    total_wheels += wheel_count
    
    print(f"Locomotive #{row['Number']} ({wheel_config}):")
    print(f"  Wheel calculation: {wheel_config} = {' + '.join(re.findall(r'\d+', wheel_config))} = {wheel_count} wheels")
    print(f"  Running total: {total_wheels} wheels\n")

print("=== FINAL RESULTS ===\n")
print(f"Steam locomotives in collection: {len(steam_locomotives)}")
print(f"Steam locomotive wheel configurations:")
for idx, row in steam_locomotives.iterrows():
    print(f"  - #{row['Number']}: {row['Type/Wheel Configuration']} ({row['Wheel_Count']} wheels)")

print(f"\nTOTAL WHEELS FOR ALL STEAM LOCOMOTIVES: {total_wheels}")

# Save detailed results
results = {
    'analysis_summary': {
        'total_locomotives_in_database': len(clean_df),
        'steam_locomotives_count': len(steam_locomotives),
        'diesel_locomotives_count': len(clean_df) - len(steam_locomotives),
        'total_wheels_all_steam_locomotives': int(total_wheels)
    },
    'steam_locomotive_details': [],
    'wheel_calculations': []
}

# Add steam locomotive details to results
for idx, row in steam_locomotives.iterrows():
    locomotive_data = {
        'number': row['Number'],
        'wheel_configuration': row['Type/Wheel Configuration'],
        'wheel_count': int(row['Wheel_Count']),
        'operating_status': row['Operating Status'],
        'location': row['Excursion/Location']
    }
    results['steam_locomotive_details'].append(locomotive_data)
    
    # Add calculation breakdown
    wheel_config = row['Type/Wheel Configuration']
    numbers = re.findall(r'\d+', wheel_config)
    calculation_breakdown = {
        'locomotive_number': row['Number'],
        'wheel_configuration': wheel_config,
        'calculation': f"{' + '.join(numbers)} = {row['Wheel_Count']}",
        'individual_numbers': [int(num) for num in numbers],
        'total_wheels': int(row['Wheel_Count'])
    }
    results['wheel_calculations'].append(calculation_breakdown)

# Save results to JSON
with open('workspace/steam_locomotive_wheel_analysis.json', 'w') as f:
    json.dump(results, f, indent=2)

print(f"\nDetailed analysis saved to: workspace/steam_locomotive_wheel_analysis.json")

# Verify our identification logic by showing what we classified as non-steam
non_steam_locomotives = clean_df[~clean_df['Type/Wheel Configuration'].apply(is_steam_locomotive)].copy()
print(f"\n=== VERIFICATION - NON-STEAM LOCOMOTIVES ===\n")
print(f"Non-steam locomotives identified: {len(non_steam_locomotives)}")
for idx, row in non_steam_locomotives.iterrows():
    print(f"  Locomotive #{row['Number']} - Type: {row['Type/Wheel Configuration']} (Classified as Diesel/Other)")

print(f"\n=== SUMMARY ===\n")
print(f"✓ Steam locomotives identified: {len(steam_locomotives)}")
print(f"✓ Diesel/Other locomotives identified: {len(non_steam_locomotives)}")
print(f"✓ Total wheels calculated for all steam locomotives: {total_wheels}")
```