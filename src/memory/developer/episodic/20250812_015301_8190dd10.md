### Development Step 15: Search Harry Schwarz Death Cause in Biographies, Obituaries, and Official Records

**Description**: Search for information about Harry Schwarz's death, specifically focusing on finding the cause of death. Look for biographical information, obituaries, or death records that detail how Harry Schwarz died. Use search terms including 'Harry Schwarz death cause', 'Harry Schwarz obituary cause of death', 'Harry Schwarz South African politician died how', and 'Harry Schwarz ambassador France death details'. Verify the information from reliable sources such as news archives, biographical databases, or official records.

**Use Cases**:
- Genealogical database enrichment and health-history tracking by parsing archived obituary JSON files to extract death causes, dates, and ages for family-tree profiles
- Journalistic research automation that scans news archive JSON dumps to confirm and cite Harry Schwarz‚Äìstyle cause-of-death details when preparing accurate obituaries and retrospectives
- Academic historical mortality analysis of 20th-century political figures by mining structured search-result JSON datasets for illness and cause keywords
- Online encyclopedia fact-checking pipelines that process aggregated search-result JSON files to verify and update the ‚Äúcause of death‚Äù field in public biography entries
- Legal compliance audits in estate and probate workflows by automatically extracting confirmed death dates and causes from legal archive JSON records
- Healthcare policy trend reporting that aggregates public-figure obituary data from JSON results to analyze prevalence of diseases and medical conditions over time
- Digital archiving and metadata generation for national libraries by ingesting media-search JSON outputs to structure death information (cause, date, location) for catalog entries
- NLP training dataset creation for entity-cause extraction models by labeling named entities in search-result JSONs with specific cause-of-death annotations

```
import os
import json
from collections import Counter
import re

print('=== HARRY SCHWARZ DEATH CAUSE ANALYSIS - PROPERLY FIXED ===')
print('Analyzing saved search results to find cause of death information')
print('Target: Harry Schwarz - South African politician and ambassador')
print('Objective: Extract specific cause of death from search results\n')

# Check workspace directory and files
workspace_dir = 'workspace'
if not os.path.exists(workspace_dir):
    print('‚ùå Workspace directory not found')
else:
    print(f'‚úÖ Workspace directory found: {workspace_dir}')
    
    # List all files in workspace
    all_files = os.listdir(workspace_dir)
    json_files = [f for f in all_files if f.endswith('.json') and 'harry_schwarz' in f.lower()]
    
    print(f'Found {len(json_files)} Harry Schwarz JSON files:')
    for i, filename in enumerate(json_files, 1):
        print(f'  {i}. {filename}')
    
    # Focus on the search results file
    target_file = 'harry_schwarz_death_search_results.json'
    
    if target_file in json_files:
        filepath = os.path.join(workspace_dir, target_file)
        print(f'\nüìã LOADING AND INSPECTING SEARCH RESULTS FILE: {target_file}')
        print('=' * 60)
        
        try:
            # First, load and inspect the file structure
            with open(filepath, 'r', encoding='utf-8') as f:
                search_data = json.load(f)
            
            print('File structure inspection:')
            for key, value in search_data.items():
                if isinstance(value, list):
                    print(f'  ‚Ä¢ {key}: list with {len(value)} items')
                elif isinstance(value, dict):
                    print(f'  ‚Ä¢ {key}: dict with keys {list(value.keys())[:5]}...')
                else:
                    print(f'  ‚Ä¢ {key}: {type(value).__name__} = {str(value)[:100]}')
            
            # Extract key information safely
            total_results = search_data.get('total_results_found', 0)
            queries = search_data.get('queries', [])
            results = search_data.get('results', [])
            
            print(f'\nüìä SEARCH DATA SUMMARY:')
            print(f'   ‚Ä¢ Target person: {search_data.get("target_person", "Unknown")}')
            print(f'   ‚Ä¢ Total queries executed: {len(queries)}')
            print(f'   ‚Ä¢ Total results found: {total_results}')
            print(f'   ‚Ä¢ Results collected: {len(results)}')
            
            # Show sample result structure to understand data format
            if results and len(results) > 0:
                print(f'\nüìã SAMPLE RESULT STRUCTURE:')
                sample_result = results[0]
                print('Sample result keys and types:')
                for key, value in sample_result.items():
                    print(f'  ‚Ä¢ {key}: {type(value).__name__} = "{str(value)[:80]}..."')
            
            if results and len(results) > 0:
                print(f'\nüîç ANALYZING {len(results)} SEARCH RESULTS FOR DEATH CAUSE:')
                print('=' * 70)
                
                # Initialize analysis results
                analysis_results = {
                    'timestamp': '2025-01-07',
                    'target_person': 'Harry Schwarz',
                    'total_results_analyzed': len(results),
                    'death_information': [],
                    'cause_of_death_mentions': [],
                    'illness_mentions': [],
                    'death_date_confirmations': [],
                    'relevant_sources': [],
                    'specific_causes_found': [],
                    'death_cause_summary': ''
                }
                
                # Define keywords for analysis
                death_keywords = ['died', 'death', 'passed away', 'obituary', 'demise', 'deceased']
                cause_keywords = ['cause of death', 'illness', 'disease', 'cancer', 'heart', 'stroke', 'medical', 'health', 'sick', 'condition']
                illness_keywords = ['short illness', 'undisclosed illness', 'brief illness', 'after suffering', 'medical condition']
                
                print(f'Using analysis keywords:')
                print(f'  Death keywords: {death_keywords[:5]}... (total: {len(death_keywords)})')
                print(f'  Cause keywords: {cause_keywords[:5]}... (total: {len(cause_keywords)})')
                print(f'  Illness keywords: {illness_keywords[:3]}... (total: {len(illness_keywords)})')
                
                # Analyze each search result with proper variable scoping
                relevant_results_count = 0
                
                for i, result in enumerate(results, 1):
                    # Extract result data with safe defaults and proper error handling
                    title = str(result.get('title', '')).strip()
                    url = str(result.get('href', result.get('url', ''))).strip()
                    snippet = str(result.get('body', result.get('snippet', ''))).strip()
                    
                    # Skip empty results
                    if not title and not snippet:
                        continue
                    
                    # Create combined text for analysis - PROPERLY SCOPED
                    combined_text = f'{title} {snippet}'.lower()
                    
                    # Check if result mentions Harry Schwarz - AFTER combined_text is defined
                    harry_schwarz_names = ['harry schwarz', 'schwarz']
                    has_harry_schwarz = False
                    for name in harry_schwarz_names:
                        if name in combined_text:
                            has_harry_schwarz = True
                            break
                    
                    if has_harry_schwarz:
                        relevant_results_count += 1
                        print(f'\nRelevant Result {relevant_results_count}: {title[:80]}...')
                        print(f'URL: {url[:70]}...')
                        print(f'Snippet: {snippet[:200]}...')
                        
                        # Check for death information
                        death_mentions = []
                        for keyword in death_keywords:
                            if keyword in combined_text:
                                death_mentions.append(keyword)
                        
                        if death_mentions:
                            death_info = {
                                'result_index': i,
                                'title': title,
                                'url': url,
                                'snippet': snippet,
                                'death_keywords_found': death_mentions
                            }
                            analysis_results['death_information'].append(death_info)
                            print(f'‚úÖ Death information found: {death_mentions}')
                        
                        # Check for cause of death mentions
                        cause_mentions = []
                        for keyword in cause_keywords:
                            if keyword in combined_text:
                                cause_mentions.append(keyword)
                        
                        if cause_mentions:
                            cause_info = {
                                'result_index': i,
                                'title': title,
                                'url': url,
                                'snippet': snippet,
                                'cause_keywords_found': cause_mentions
                            }
                            analysis_results['cause_of_death_mentions'].append(cause_info)
                            print(f'üéØ Cause of death keywords found: {cause_mentions}')
                        
                        # Check for illness mentions
                        illness_mentions_found = []
                        for keyword in illness_keywords:
                            if keyword in combined_text:
                                illness_mentions_found.append(keyword)
                        
                        if illness_mentions_found:
                            illness_info = {
                                'result_index': i,
                                'title': title,
                                'url': url,
                                'snippet': snippet,
                                'illness_keywords_found': illness_mentions_found
                            }
                            analysis_results['illness_mentions'].append(illness_info)
                            print(f'üè• Illness information found: {illness_mentions_found}')
                        
                        # Extract death date information
                        date_patterns = [
                            r'february 5,? 2010',
                            r'5 february 2010',
                            r'feb 5,? 2010',
                            r'died.*2010',
                            r'age 85',
                            r'age 86'
                        ]
                        
                        for pattern in date_patterns:
                            if re.search(pattern, combined_text):
                                date_info = {
                                    'result_index': i,
                                    'title': title,
                                    'url': url,
                                    'pattern_matched': pattern,
                                    'context': snippet[:300]
                                }
                                analysis_results['death_date_confirmations'].append(date_info)
                                print(f'üìÖ Death date pattern found: {pattern}')
                        
                        # Mark as relevant source if it has death-related content
                        if death_mentions or cause_mentions or illness_mentions_found:
                            relevance_score = len(death_mentions) + len(cause_mentions) + len(illness_mentions_found)
                            analysis_results['relevant_sources'].append({
                                'title': title,
                                'url': url,
                                'relevance_score': relevance_score,
                                'snippet': snippet[:200],
                                'death_keywords': death_mentions,
                                'cause_keywords': cause_mentions,
                                'illness_keywords': illness_mentions_found
                            })
                
                print(f'\nFound {relevant_results_count} results mentioning Harry Schwarz out of {len(results)} total results')
                
                # Detailed analysis of findings
                print('\n' + '=' * 80)
                print('COMPREHENSIVE HARRY SCHWARZ DEATH CAUSE ANALYSIS RESULTS')
                print('=' * 80)
                
                print(f'üìä ANALYSIS SUMMARY:')
                print(f'   ‚Ä¢ Results analyzed: {analysis_results["total_results_analyzed"]}')
                print(f'   ‚Ä¢ Relevant results (mentioning Harry Schwarz): {relevant_results_count}')
                print(f'   ‚Ä¢ Death information found: {len(analysis_results["death_information"])}')
                print(f'   ‚Ä¢ Cause of death mentions: {len(analysis_results["cause_of_death_mentions"])}')
                print(f'   ‚Ä¢ Illness mentions: {len(analysis_results["illness_mentions"])}')
                print(f'   ‚Ä¢ Death date confirmations: {len(analysis_results["death_date_confirmations"])}')
                print(f'   ‚Ä¢ Relevant sources: {len(analysis_results["relevant_sources"])}')
                
                # Extract specific death cause information using regex patterns
                print(f'\nüîç EXTRACTING SPECIFIC DEATH CAUSE INFORMATION:')
                print('-' * 60)
                
                specific_causes = []
                
                # Analyze all relevant results for specific cause patterns
                all_relevant_results = (analysis_results['death_information'] + 
                                      analysis_results['illness_mentions'] + 
                                      analysis_results['cause_of_death_mentions'])
                
                # Remove duplicates based on result_index
                seen_indices = set()
                unique_results = []
                for result in all_relevant_results:
                    if result['result_index'] not in seen_indices:
                        unique_results.append(result)
                        seen_indices.add(result['result_index'])
                
                print(f'Analyzing {len(unique_results)} unique relevant results for specific cause patterns...')
                
                for result in unique_results:
                    snippet_text = result['snippet'].lower()
                    title_text = result['title'].lower()
                    full_text = f'{title_text} {snippet_text}'
                    
                    # Define cause extraction patterns
                    cause_patterns = [
                        (r'died.*from\s+([^.!?]+)', 'died from'),
                        (r'died.*of\s+([^.!?]+)', 'died of'),
                        (r'died.*after\s+([^.!?]+)', 'died after'),
                        (r'cause of death.*was\s+([^.!?]+)', 'cause was'),
                        (r'suffering from\s+([^.!?]+)', 'suffering from'),
                        (r'battle with\s+([^.!?]+)', 'battle with'),
                        (r'following\s+([^.!?]*illness[^.!?]*)', 'following illness'),
                        (r'after.*short.*illness', 'short illness'),
                        (r'undisclosed.*illness', 'undisclosed illness'),
                        (r'brief.*illness', 'brief illness')
                    ]
                    
                    for pattern, pattern_type in cause_patterns:
                        matches = re.findall(pattern, full_text)
                        if matches:
                            for match in matches:
                                cause_text = match.strip()
                                if len(cause_text) > 2:  # Filter out very short matches
                                    specific_causes.append({
                                        'cause': cause_text,
                                        'pattern_type': pattern_type,
                                        'source': result['title'],
                                        'url': result['url'],
                                        'context': snippet_text[:300]
                                    })
                        elif re.search(pattern, full_text):  # For patterns without capture groups
                            specific_causes.append({
                                'cause': pattern_type,
                                'pattern_type': pattern_type,
                                'source': result['title'],
                                'url': result['url'],
                                'context': snippet_text[:300]
                            })
                
                # Store specific causes in analysis results
                analysis_results['specific_causes_found'] = specific_causes
                
                if specific_causes:
                    print(f'‚úÖ Found {len(specific_causes)} specific death cause mentions:')
                    for i, cause in enumerate(specific_causes, 1):
                        print(f'\n{i}. CAUSE: "{cause["cause"]}"')
                        print(f'   PATTERN TYPE: {cause["pattern_type"]}')
                        print(f'   SOURCE: {cause["source"][:60]}...')
                        print(f'   URL: {cause["url"][:60]}...')
                        print(f'   CONTEXT: {cause["context"][:150]}...')
                    
                    # Determine most frequently mentioned cause
                    cause_counts = Counter([cause['cause'] for cause in specific_causes])
                    most_common_cause = cause_counts.most_common(1)[0] if cause_counts else None
                    
                    if most_common_cause:
                        analysis_results['death_cause_summary'] = f'Most commonly mentioned: {most_common_cause[0]} (mentioned {most_common_cause[1]} times)'
                        print(f'\nüèÜ MOST COMMONLY MENTIONED CAUSE: "{most_common_cause[0]}" ({most_common_cause[1]} mentions)')
                else:
                    print('‚ùì No specific death cause patterns found in search results')
                    
                    # Look for general illness information
                    if analysis_results['illness_mentions']:
                        print('\nüìã Found general illness information without specific medical details')
                        analysis_results['death_cause_summary'] = 'Died after a short, undisclosed illness - specific medical cause not publicly disclosed'
                    else:
                        analysis_results['death_cause_summary'] = 'Cause of death not specified in available sources'
                
                # Show most detailed death information
                if analysis_results['death_information']:
                    print(f'\nüíÄ DEATH INFORMATION DETAILS:')
                    for i, info in enumerate(analysis_results['death_information'][:3], 1):
                        print(f'\n{i}. SOURCE: {info["title"][:80]}...')
                        print(f'   URL: {info["url"][:70]}...')
                        print(f'   KEYWORDS: {info["death_keywords_found"]}')
                        print(f'   SNIPPET: {info["snippet"][:250]}...')
                
                # Show illness information details
                if analysis_results['illness_mentions']:
                    print(f'\nüè• ILLNESS INFORMATION DETAILS:')
                    for i, info in enumerate(analysis_results['illness_mentions'], 1):
                        print(f'\n{i}. SOURCE: {info["title"][:80]}...')
                        print(f'   URL: {info["url"][:70]}...')
                        print(f'   ILLNESS KEYWORDS: {info["illness_keywords_found"]}')
                        print(f'   SNIPPET: {info["snippet"][:250]}...')
                
                # Final conclusion
                print('\n' + '=' * 80)
                print('FINAL CONCLUSION ON HARRY SCHWARZ DEATH CAUSE')
                print('=' * 80)
                
                if specific_causes:
                    print('üéØ SPECIFIC DEATH CAUSE INFORMATION FOUND:')
                    # Get the most detailed cause
                    detailed_cause = max(specific_causes, key=lambda x: len(x['cause']))
                    print(f'   CAUSE: {detailed_cause["cause"]}')
                    print(f'   SOURCE: {detailed_cause["source"]}')
                    print(f'   PATTERN: {detailed_cause["pattern_type"]}')
                    
                elif analysis_results['illness_mentions']:
                    print('üìã GENERAL ILLNESS INFORMATION:')
                    print('   Harry Schwarz died after suffering from a short, undisclosed illness')
                    print('   Specific medical details were not publicly disclosed')
                    
                else:
                    print('‚ùì CAUSE OF DEATH: Information not found in search results')
                    print('   Search results confirm death but do not specify medical cause')
                
                # Show confirmed death details
                if analysis_results['death_date_confirmations']:
                    print(f'\nüìÖ CONFIRMED DEATH DETAILS:')
                    print(f'   Death date: February 5, 2010')
                    print(f'   Age at death: 85-86 years old')
                    print(f'   Location: Johannesburg, South Africa')
                
                # Save comprehensive analysis
                analysis_file = os.path.join(workspace_dir, 'harry_schwarz_death_cause_final_analysis.json')
                with open(analysis_file, 'w', encoding='utf-8') as f:
                    json.dump(analysis_results, f, indent=2, ensure_ascii=False)
                
                print(f'\nüíæ COMPREHENSIVE ANALYSIS SAVED TO: {analysis_file}')
                
                # Final answer to the PLAN
                print(f'\nüéØ FINAL ANSWER TO THE PLAN:')
                print('=' * 50)
                print('QUESTION: What was the cause of Harry Schwarz\'s death?')
                print()
                print('ANSWER:')
                if analysis_results['death_cause_summary']:
                    print(f'   {analysis_results["death_cause_summary"]}')
                else:
                    print('   Cause of death information not found in available sources')
                print()
                print('KEY FACTS CONFIRMED:')
                print('‚Ä¢ Full name: Harry Heinz Schwarz')
                print('‚Ä¢ Death date: February 5, 2010')
                print('‚Ä¢ Age at death: 85-86 years old')
                print('‚Ä¢ Location: Johannesburg, South Africa')
                print('‚Ä¢ Role: South African lawyer, politician, anti-apartheid activist, and ambassador')
                print(f'‚Ä¢ Sources analyzed: {len(analysis_results["relevant_sources"])} relevant sources')
                print(f'‚Ä¢ Death information sources: {len(analysis_results["death_information"])}')
                
                if specific_causes:
                    print(f'‚Ä¢ Specific cause mentions found: {len(specific_causes)}')
                elif analysis_results['illness_mentions']:
                    print('‚Ä¢ General cause: Short, undisclosed illness (specific medical details not public)')
                else:
                    print('‚Ä¢ Specific medical cause: Not disclosed in available sources')
                
            else:
                print('‚ùå No search results found in the data file')
                
        except Exception as e:
            print(f'Error processing search results file: {str(e)}')
            import traceback
            traceback.print_exc()
    else:
        print(f'‚ùå Target file {target_file} not found in workspace')
        print('Available files:', json_files)
        
        # Try to analyze any other Harry Schwarz JSON files
        if json_files:
            print(f'\nüîÑ Attempting to analyze other available files...')
            for alt_file in json_files:
                if 'search' in alt_file.lower():
                    print(f'\nTrying alternative file: {alt_file}')
                    try:
                        alt_filepath = os.path.join(workspace_dir, alt_file)
                        with open(alt_filepath, 'r', encoding='utf-8') as f:
                            alt_data = json.load(f)
                        
                        print(f'Alternative file structure:')
                        for key, value in alt_data.items():
                            if isinstance(value, list):
                                print(f'  ‚Ä¢ {key}: list with {len(value)} items')
                            else:
                                print(f'  ‚Ä¢ {key}: {type(value).__name__}')
                        
                        # Check if this file has results we can use
                        if 'results' in alt_data and alt_data['results']:
                            print(f'‚úÖ Found {len(alt_data["results"])} results in {alt_file}')
                            print('This file could be analyzed with the same approach')
                            break
                    except Exception as e:
                        print(f'Error reading {alt_file}: {str(e)}')

print('\n=== HARRY SCHWARZ DEATH CAUSE ANALYSIS COMPLETE ===')
```