### Development Step 2: Extract and Categorize Fast-Food Menu Sales from Excel, Prepare Food-Only Sales Totals

**Description**: Parse and analyze the attached Excel file data/gaia/2023/validation/7bd855d8-463d-4ed5-93ca-5fe35145f733.xlsx to extract all sales data for the fast-food chain menu items. Identify the structure of the spreadsheet including column headers, data organization, and categorize menu items to distinguish between food items and drinks. Extract sales figures for each item and prepare the data for calculating total food sales excluding beverages.

**Use Cases**:
- Multi-location franchise performance benchmarking: aggregate and compare food vs beverage sales across outlets to identify top-performing restaurants and underperforming regions
- Inventory procurement optimization for supply chain teams: parse POS export spreadsheets to compute accurate demand for burgers, salads, fries, etc., excluding beverages to streamline restocking orders
- Financial auditing and compliance reporting for hospitality accountants: automatically extract and categorize sales figures from daily sales logs to generate audit trails and tax reports focusing on taxable food items
- Menu engineering and dynamic pricing analysis for marketing managers: analyze historical sales volume per menu category to adjust pricing, promotions, and product placement for maximizing food item revenue excluding drinks
- Demand forecasting and supply planning for operations teams: ingest weekly Excel sales exports, aggregate item-level food sales excluding beverages, and feed into forecasting models for ingredient ordering
- Loyalty program ROI assessment for CRM platforms: extract item-level sales data by location to measure uplift in food purchases during targeted promotions or discount campaigns, excluding beverage sales
- Business intelligence dashboard integration for executive reporting: transform raw Excel sales data into structured JSON and text summaries for real-time ingestion into BI tools to visualize food-only revenue trends across all outlets
- Competitive benchmarking and market analysis for consultancy firms: use categorized sales data to compare menu performance against industry benchmarks and advise clients on menu mix optimization

```
import os
import pandas as pd
from openpyxl import load_workbook
import json

# The path to the Excel file to be analyzed
xlsx_path = "data/gaia/2023/validation/7bd855d8-463d-4ed5-93ca-5fe35145f733.xlsx"

print("=== COMPLETE FAST-FOOD CHAIN SALES DATA EXTRACTION ===")
print(f"Analyzing file: {xlsx_path}")

# Load the Excel file with pandas for complete data extraction
print("\nLoading complete dataset with pandas...")
df = pd.read_excel(xlsx_path)

print(f"Dataset shape: {df.shape}")
print(f"Column names: {list(df.columns)}")

# Display the complete dataset
print("\n=== COMPLETE DATASET ===")
print(df.to_string(index=False))

# Save complete data to workspace for reference
with open('workspace/complete_sales_data.txt', 'w') as f:
    f.write("=== FAST-FOOD CHAIN COMPLETE SALES DATA ===\n")
    f.write(f"Dataset shape: {df.shape}\n")
    f.write(f"Column names: {list(df.columns)}\n\n")
    f.write("Complete dataset:\n")
    f.write(df.to_string(index=False))
    f.write("\n\n")

print(f"\nComplete dataset saved to: workspace/complete_sales_data.txt")

# Analyze the data structure and categorize menu items
print("\n=== MENU ITEM CATEGORIZATION ===")

# Based on the column names, categorize items
columns = list(df.columns)
print(f"All columns: {columns}")

# Exclude the Location column and categorize the rest
menu_columns = [col for col in columns if col != 'Location']
print(f"Menu item columns: {menu_columns}")

# Categorize menu items (food vs beverages)
food_items = ['Burgers', 'Hot Dogs', 'Salads', 'Fries', 'Ice Cream']
beverage_items = ['Soda']

# Verify categorization matches actual columns
actual_food_items = [item for item in food_items if item in menu_columns]
actual_beverage_items = [item for item in beverage_items if item in menu_columns]

print(f"\nFood items identified: {actual_food_items}")
print(f"Beverage items identified: {actual_beverage_items}")
print(f"Other items (if any): {[item for item in menu_columns if item not in food_items and item not in beverage_items]}")

# Extract sales data for each location
print("\n=== SALES DATA BY LOCATION ===")
for index, row in df.iterrows():
    location = row['Location']
    print(f"\nLocation: {location}")
    
    total_food_sales = 0
    total_beverage_sales = 0
    
    print("  Food sales:")
    for item in actual_food_items:
        sales = row[item]
        total_food_sales += sales
        print(f"    {item}: ${sales:,.2f}")
    
    print("  Beverage sales:")
    for item in actual_beverage_items:
        sales = row[item]
        total_beverage_sales += sales
        print(f"    {item}: ${sales:,.2f}")
    
    print(f"  TOTAL FOOD SALES (excluding beverages): ${total_food_sales:,.2f}")
    print(f"  Total beverage sales: ${total_beverage_sales:,.2f}")
    print(f"  Grand total (all items): ${total_food_sales + total_beverage_sales:,.2f}")

# Calculate overall totals across all locations
print("\n" + "="*60)
print("SUMMARY: TOTAL SALES ACROSS ALL LOCATIONS")
print("="*60)

# Calculate total food sales (excluding beverages)
total_food_sales_all = df[actual_food_items].sum().sum()
total_beverage_sales_all = df[actual_beverage_items].sum().sum()
grand_total_all = total_food_sales_all + total_beverage_sales_all

print(f"\nFood items totals across all locations:")
for item in actual_food_items:
    item_total = df[item].sum()
    print(f"  {item}: ${item_total:,.2f}")

print(f"\nBeverage items totals across all locations:")
for item in actual_beverage_items:
    item_total = df[item].sum()
    print(f"  {item}: ${item_total:,.2f}")

print(f"\n*** FINAL ANSWER ***")
print(f"TOTAL FOOD SALES (excluding beverages): ${total_food_sales_all:,.2f}")
print(f"Total beverage sales: ${total_beverage_sales_all:,.2f}")
print(f"Grand total (all items): ${grand_total_all:,.2f}")

# Create detailed analysis report
analysis_report = {
    'dataset_info': {
        'file_path': xlsx_path,
        'shape': df.shape,
        'columns': list(df.columns)
    },
    'categorization': {
        'food_items': actual_food_items,
        'beverage_items': actual_beverage_items
    },
    'sales_summary': {
        'total_food_sales': float(total_food_sales_all),
        'total_beverage_sales': float(total_beverage_sales_all),
        'grand_total': float(grand_total_all)
    },
    'individual_item_totals': {
        item: float(df[item].sum()) for item in menu_columns
    },
    'location_breakdown': []
}

# Add location-specific breakdowns
for index, row in df.iterrows():
    location_data = {
        'location': row['Location'],
        'food_sales': float(sum(row[item] for item in actual_food_items)),
        'beverage_sales': float(sum(row[item] for item in actual_beverage_items)),
        'item_breakdown': {item: float(row[item]) for item in menu_columns}
    }
    analysis_report['location_breakdown'].append(location_data)

# Save comprehensive analysis
with open('workspace/fast_food_sales_analysis.json', 'w') as f:
    json.dump(analysis_report, f, indent=2)

print(f"\nComprehensive analysis saved to: workspace/fast_food_sales_analysis.json")

# Also save a summary report
with open('workspace/sales_summary.txt', 'w') as f:
    f.write("FAST-FOOD CHAIN SALES ANALYSIS SUMMARY\n")
    f.write("="*50 + "\n\n")
    f.write(f"Dataset: {os.path.basename(xlsx_path)}\n")
    f.write(f"Locations analyzed: {len(df)}\n")
    f.write(f"Menu items: {len(menu_columns)}\n\n")
    
    f.write("CATEGORIZATION:\n")
    f.write(f"Food items: {', '.join(actual_food_items)}\n")
    f.write(f"Beverage items: {', '.join(actual_beverage_items)}\n\n")
    
    f.write("FINAL RESULTS:\n")
    f.write(f"Total Food Sales (excluding beverages): ${total_food_sales_all:,.2f}\n")
    f.write(f"Total Beverage Sales: ${total_beverage_sales_all:,.2f}\n")
    f.write(f"Grand Total (all items): ${grand_total_all:,.2f}\n")

print(f"Sales summary saved to: workspace/sales_summary.txt")
print("\n*** ANALYSIS COMPLETE ***")
print(f"The total food sales excluding beverages is: ${total_food_sales_all:,.2f}")
```