### Development Step 1: Extract Secret Santa Details: Participants, Assignments, Profiles (Hobbies), and Actual Gifts Given

**Description**: Parse and analyze the attached Word document file data/gaia/2023/validation/cffe0e32-c9a6-4c52-9877-78ceb4aaa9fb.docx to extract information about the Secret Santa gift exchange. Identify all twelve employees, their assigned gift recipients, their profiles with three likes/hobbies each, and the eleven gifts that were actually given. Create a comprehensive mapping of who was supposed to give gifts to whom and which gifts were actually presented.

**Use Cases**:
- HR teams automating the extraction of employee names, gift assignments, and hobby profiles from internal Word documents to streamline annual Secret Santa coordination
- Corporate event planners parsing Word-based attendee lists and preference forms to match participants with breakout sessions and networking activities
- Non-profit volunteer coordinators extracting volunteer names, skill sets, and task assignments from .docx rosters to ensure accurate role distribution for community projects
- Academic conference organizers parsing speaker bios, talk titles, and time slots from Word program files to auto-generate the online schedule and digital proceedings
- Legal departments automating the processing of contract parties, signature dates, and clause summaries from Word agreements to feed compliance tracking systems
- Market research teams extracting respondent demographics, rating scales, and open-ended feedback from Word survey reports for downstream statistical analysis
- Product managers parsing feature request lists, priority levels, and submitter details from Word tracking documents to populate agile ticketing tools
- Real estate agencies extracting client contact information, property wish lists, and viewing schedules from Word inquiry forms to automate CRM entries and follow-up reminders

```
import os
from langchain_community.document_loaders import Docx2txtLoader
import json

# The path to the Word document to be parsed
docx_path = "data/gaia/2023/validation/cffe0e32-c9a6-4c52-9877-78ceb4aaa9fb.docx"

print("=== SECRET SANTA GIFT EXCHANGE ANALYSIS ===\n")
print(f"Analyzing Word document: {docx_path}")

# Check if file exists
if not os.path.exists(docx_path):
    print(f"Error: Word document '{docx_path}' does not exist.")
    exit()

print(f"File exists: {docx_path}")
file_size = os.path.getsize(docx_path)
print(f"File size: {file_size} bytes")

# Validate file format
if not docx_path.lower().endswith('.docx'):
    print(f"Error: File must be a .docx file. Got: {docx_path}")
    exit()

print("\n=== LOADING AND PARSING WORD DOCUMENT ===\n")

# Load and parse the Word document using LangChain
loader = Docx2txtLoader(docx_path)
documents = loader.load()

if not documents:
    print("No content found in the Word document.")
    exit()

print(f"Successfully loaded {len(documents)} document section(s)")

# Extract and combine text content from all document sections
full_text = "\n\n".join([doc.page_content for doc in documents])

if not full_text.strip():
    print("The Word document appears to be empty.")
    exit()

print(f"Total extracted text length: {len(full_text)} characters")

print("\n=== DOCUMENT CONTENT ===\n")
print(full_text)

print("\n" + "="*80)
print("INITIAL CONTENT ANALYSIS")
print("="*80)

# Split content into lines for easier analysis
lines = full_text.split('\n')
lines = [line.strip() for line in lines if line.strip()]  # Remove empty lines

print(f"\nTotal non-empty lines: {len(lines)}")
print("\n=== FIRST 20 LINES ===\n")
for i, line in enumerate(lines[:20], 1):
    print(f"{i:2d}. {line}")

print("\n=== SEARCHING FOR SECRET SANTA KEYWORDS ===\n")

# Define keywords to search for
secret_santa_keywords = [
    'secret santa', 'gift', 'employee', 'recipient', 'exchange', 
    'like', 'hobby', 'hobbies', 'profile', 'assigned', 'given', 'present'
]

keyword_matches = {}
for keyword in secret_santa_keywords:
    matches = []
    for i, line in enumerate(lines):
        if keyword.lower() in line.lower():
            matches.append({
                'line_number': i + 1,
                'content': line
            })
    if matches:
        keyword_matches[keyword] = matches
        print(f"Keyword '{keyword}' found in {len(matches)} line(s):")
        for match in matches[:5]:  # Show first 5 matches
            print(f"  Line {match['line_number']}: {match['content']}")
        if len(matches) > 5:
            print(f"  ... and {len(matches) - 5} more")
        print()

print("\n=== LOOKING FOR EMPLOYEE NAMES AND PATTERNS ===\n")

# Look for patterns that might indicate employee names or assignments
employee_patterns = []
gift_patterns = []
profile_patterns = []

for i, line in enumerate(lines):
    line_lower = line.lower()
    
    # Look for patterns like "Employee:", "Name:", or numbered items
    if any(marker in line_lower for marker in ['employee:', 'name:', 'person:']):
        employee_patterns.append({
            'line_number': i + 1,
            'content': line,
            'type': 'employee_marker'
        })
        print(f"Employee pattern found at line {i + 1}: {line}")
    
    # Look for assignment patterns like "assigned to", "gives to", "recipient:"
    if any(marker in line_lower for marker in ['assigned to', 'gives to', 'recipient:', 'giving to']):
        employee_patterns.append({
            'line_number': i + 1,
            'content': line,
            'type': 'assignment_pattern'
        })
        print(f"Assignment pattern found at line {i + 1}: {line}")
    
    # Look for gift patterns
    if any(marker in line_lower for marker in ['gift:', 'present:', 'gave:', 'received:']):
        gift_patterns.append({
            'line_number': i + 1,
            'content': line
        })
        print(f"Gift pattern found at line {i + 1}: {line}")
    
    # Look for profile/hobby patterns
    if any(marker in line_lower for marker in ['likes:', 'hobbies:', 'interests:', 'enjoys:']):
        profile_patterns.append({
            'line_number': i + 1,
            'content': line
        })
        print(f"Profile pattern found at line {i + 1}: {line}")

print(f"\nFound {len(employee_patterns)} employee-related patterns")
print(f"Found {len(gift_patterns)} gift-related patterns")
print(f"Found {len(profile_patterns)} profile-related patterns")

# Look for numbered lists or bullet points
print("\n=== LOOKING FOR NUMBERED LISTS OR STRUCTURED DATA ===\n")

numbered_lines = []
bullet_lines = []

for i, line in enumerate(lines):
    # Check for numbered items (1., 2., etc.)
    if len(line) > 2 and line[0].isdigit() and line[1] in ['.', ')', ':']:
        numbered_lines.append({
            'line_number': i + 1,
            'content': line
        })
        print(f"Numbered item at line {i + 1}: {line}")
    
    # Check for bullet points
    if line.startswith(('-', '*', '•', '○')):
        bullet_lines.append({
            'line_number': i + 1,
            'content': line
        })
        print(f"Bullet point at line {i + 1}: {line}")

print(f"\nFound {len(numbered_lines)} numbered items")
print(f"Found {len(bullet_lines)} bullet points")

# Save initial analysis
initial_analysis = {
    'file_info': {
        'filename': os.path.basename(docx_path),
        'file_size': file_size,
        'total_text_length': len(full_text),
        'total_lines': len(lines)
    },
    'content': {
        'full_text': full_text,
        'lines': lines
    },
    'patterns_found': {
        'keyword_matches': keyword_matches,
        'employee_patterns': employee_patterns,
        'gift_patterns': gift_patterns,
        'profile_patterns': profile_patterns,
        'numbered_lines': numbered_lines,
        'bullet_lines': bullet_lines
    }
}

with open('workspace/secret_santa_initial_analysis.json', 'w') as f:
    json.dump(initial_analysis, f, indent=2)

print(f"\nInitial analysis saved to: workspace/secret_santa_initial_analysis.json")
print("\nNext step: Extract and structure the employee data, assignments, and gifts")
```