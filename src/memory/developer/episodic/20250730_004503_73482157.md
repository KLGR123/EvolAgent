### Development Step 1: Extract Full-House Rentals with Swimming Amenities on Seahorse Island

**Description**: Parse and analyze the attached PDF file data/gaia/2023/validation/366e2f2b-8632-4ef2-81eb-bc3877489217.pdf to extract information about all accommodations in Seahorse Island. Focus on identifying properties that offer full house rentals and have swimming amenities (pools, beach access, or water features). Extract details including accommodation names, property types, amenities, availability status, and any family-friendly features to enable comparison of options suitable for a family seeking a full house with swimming facilities.

**Use Cases**:
- Real estate agents consolidating Seahorse Island property PDFs to present families with full-house rentals that include private pools and beachfront access
- Vacation rental marketplaces automating ingestion of host-submitted PDF brochures to update listings of island villas with water features and real-time availability
- Travel agencies extracting family-friendly full-house options with swimming amenities from sealed PDF catalogs to craft customized holiday itineraries
- Hospitality consulting firms benchmarking pool-equipped full-house rentals on Seahorse Island by parsing competitor PDF offerings to identify amenity trends and pricing strategies
- Insurance underwriters assessing water-related risk factors in full-house accommodations on Seahorse Island by extracting property layouts and swimming amenity details from regulatory PDFs
- Local tourism boards generating interactive online guides by extracting names, availability, and amenity details of full-house rentals with pools from official PDF reports
- Event planners organizing offshore corporate retreats by automatically filtering PDF portfolios for large island rentals with beach access and private pools suitable for team-building

```
from langchain_community.document_loaders import PyPDFLoader
import os
import json

# The path to the PDF file to be parsed
pdf_path = "data/gaia/2023/validation/366e2f2b-8632-4ef2-81eb-bc3877489217.pdf"

print("=== SEAHORSE ISLAND ACCOMMODATIONS ANALYSIS ===")
print(f"Analyzing PDF file: {pdf_path}")

# Check if file exists
if not os.path.exists(pdf_path):
    print(f"Error: PDF file '{pdf_path}' does not exist.")
    exit()

print(f"File exists: {pdf_path}")
file_size = os.path.getsize(pdf_path)
print(f"File size: {file_size} bytes")

# Load and split PDF into pages using LangChain
print("\nLoading PDF with LangChain PyPDFLoader...")
loader = PyPDFLoader(pdf_path)
pages = loader.load_and_split()

print(f"PDF successfully loaded!")
print(f"Total pages: {len(pages)}")

if len(pages) == 0:
    print("No pages found in this PDF file.")
    exit()

# Since we need to analyze accommodations, let's examine the full content first
# Check content size to determine if we need to process in chunks
full_content = "\n".join([page.page_content for page in pages])
content_length = len(full_content)

print(f"Total content length: {content_length} characters")

# If content is reasonable size, process it all; otherwise process page by page
if content_length > 100000:
    print(f"Content is large ({content_length} characters). Processing page by page...")
    
    # Process each page individually to find accommodation information
    accommodation_info = []
    
    for i, page in enumerate(pages, 1):
        print(f"\n=== PAGE {i} CONTENT ===")
        page_content = page.page_content
        print(f"Page {i} length: {len(page_content)} characters")
        
        # Show first 1000 characters of each page to understand structure
        preview_content = page_content[:1000] + ("..." if len(page_content) > 1000 else "")
        print(f"Page {i} preview:\n{preview_content}")
        
        # Look for accommodation-related keywords
        accommodation_keywords = ['accommodation', 'hotel', 'house', 'villa', 'rental', 'property', 'resort', 'lodge', 'inn']
        swimming_keywords = ['pool', 'swimming', 'beach', 'water', 'spa', 'aquatic']
        
        found_accommodations = any(keyword.lower() in page_content.lower() for keyword in accommodation_keywords)
        found_swimming = any(keyword.lower() in page_content.lower() for keyword in swimming_keywords)
        
        if found_accommodations or found_swimming:
            print(f"*** Page {i} contains accommodation/swimming content ***")
            accommodation_info.append({
                'page_number': i,
                'content': page_content,
                'has_accommodations': found_accommodations,
                'has_swimming': found_swimming
            })
    
    print(f"\nFound {len(accommodation_info)} pages with relevant content")
    
else:
    print("Content size is manageable. Processing full document...")
    
    # Display the full content
    print("\n=== FULL PDF CONTENT ===")
    print(full_content)
    print("=== END OF PDF CONTENT ===")

# Save the raw content to workspace for further analysis
with open('workspace/seahorse_island_accommodations_raw.txt', 'w', encoding='utf-8') as f:
    f.write(full_content)

print(f"\nRaw PDF content saved to: workspace/seahorse_island_accommodations_raw.txt")

# Initial content analysis
print("\n=== INITIAL CONTENT ANALYSIS ===")

# Count occurrences of key terms
accommodation_terms = {
    'accommodation': full_content.lower().count('accommodation'),
    'hotel': full_content.lower().count('hotel'),
    'house': full_content.lower().count('house'),
    'villa': full_content.lower().count('villa'),
    'rental': full_content.lower().count('rental'),
    'property': full_content.lower().count('property'),
    'resort': full_content.lower().count('resort')
}

swimming_terms = {
    'pool': full_content.lower().count('pool'),
    'swimming': full_content.lower().count('swimming'),
    'beach': full_content.lower().count('beach'),
    'water': full_content.lower().count('water'),
    'spa': full_content.lower().count('spa')
}

print("Accommodation-related term frequencies:")
for term, count in accommodation_terms.items():
    if count > 0:
        print(f"  {term}: {count}")

print("\nSwimming/water-related term frequencies:")
for term, count in swimming_terms.items():
    if count > 0:
        print(f"  {term}: {count}")

# Look for structured patterns that might indicate property listings
import re

# Look for potential property names (capitalized words that might be names)
print("\n=== SEARCHING FOR PROPERTY PATTERNS ===")

# Find lines that might contain property information
lines = full_content.split('\n')
print(f"Total lines in document: {len(lines)}")

# Look for lines with key accommodation indicators
relevant_lines = []
for i, line in enumerate(lines):
    line_lower = line.lower()
    if any(term in line_lower for term in ['house', 'villa', 'rental', 'pool', 'beach', 'accommodation']):
        relevant_lines.append((i, line.strip()))

print(f"\nFound {len(relevant_lines)} lines with accommodation/amenity keywords:")
for line_num, line in relevant_lines[:20]:  # Show first 20 relevant lines
    print(f"Line {line_num}: {line}")

if len(relevant_lines) > 20:
    print(f"... and {len(relevant_lines) - 20} more lines")

# Save initial analysis
analysis_data = {
    'pdf_path': pdf_path,
    'file_size': file_size,
    'total_pages': len(pages),
    'content_length': content_length,
    'accommodation_terms': accommodation_terms,
    'swimming_terms': swimming_terms,
    'relevant_lines_count': len(relevant_lines),
    'analysis_timestamp': str(pd.Timestamp.now() if 'pd' in globals() else 'timestamp_unavailable')
}

with open('workspace/initial_analysis.json', 'w') as f:
    json.dump(analysis_data, f, indent=2)

print(f"\nInitial analysis saved to: workspace/initial_analysis.json")
print("\nNext step: Extract and structure accommodation details with focus on full houses and swimming amenities")
```