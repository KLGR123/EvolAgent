### Development Step 24: Search for 2011 Bulgarian Census Data on Tertiary Education Completion by Gender

**Description**: Search for the 2011 Bulgarian census data on tertiary education completion by gender. Look for official census results from Bulgaria's National Statistical Institute or other authoritative sources that provide the specific breakdown of men and women who completed tertiary education in 2011.

**Use Cases**:
- Government policy planning and educational equity assessment: the Ministry of Education automates extraction of 2011 Bulgarian tertiary completion by gender to identify regional disparities and allocate targeted scholarship funds.
- Academic gender studies research: a university sociologist compiles precise male and female tertiary graduation figures for comparative analysis with other EU countries in a peer-reviewed journal.
- Corporate HR benchmarking and talent pipeline analysis: a multinational firm integrates Bulgarian census education data into its talent analytics platform to tailor leadership development programs by gender.
- NGO program design for women’s empowerment: a nonprofit uses the extracted statistics on female tertiary graduates in 2011 to measure baseline literacy and craft vocational training initiatives.
- Data journalism and interactive storytelling: a news outlet’s data team automates ingestion of gender-disaggregated education figures to power a live dashboard on Bulgaria’s progress toward gender parity in higher education.
- EdTech market opportunity assessment: a learning-platform startup analyzes the 2011 tertiary completion rates by gender to forecast potential demand for gender-specific online courses in Bulgaria.
- Historical data archiving in digital libraries: a cultural heritage institution extracts and structures 2011 census education breakdowns for long-term preservation and open data portals.
- Public sector performance reporting: a government data analyst automates the generation of quarterly reports on historical tertiary attainment by gender to monitor progress against EU 2020 education benchmarks.

```
import os
import json
from bs4 import BeautifulSoup
import re
import time

print("=== BULGARIAN 2011 CENSUS TERTIARY EDUCATION BY GENDER - BULLETPROOF EXTRACTION ===")
print("Strategy: Zero scoping issues, explicit variable handling throughout\n")

# Check workspace
workspace_path = 'workspace'
if not os.path.exists(workspace_path):
    print("No workspace directory found")
    exit()

# Get all files with explicit handling
all_files = os.listdir(workspace_path)
print(f"Total files in workspace: {len(all_files)}")

# Find HTML files with explicit loop
html_files_list = []
for filename in all_files:
    if filename.endswith('.html'):
        html_files_list.append(filename)

print(f"HTML files found: {len(html_files_list)}")

# Find Bulgarian Demographics files with explicit loop
bulgarian_demographics_files = []
for html_filename in html_files_list:
    if 'Demographics_of_Bulgaria' in html_filename:
        bulgarian_demographics_files.append(html_filename)
        print(f"  Found: {html_filename}")

if len(bulgarian_demographics_files) == 0:
    print("No Bulgarian Demographics files found")
    exit()

# Use the first file
target_file = bulgarian_demographics_files[0]
print(f"\n=== ANALYZING: {target_file} ===")

# Read file content
filepath = os.path.join(workspace_path, target_file)
with open(filepath, 'r', encoding='utf-8') as f:
    html_content = f.read()

print(f"File size: {len(html_content):,} characters")

# Parse HTML
soup = BeautifulSoup(html_content, 'html.parser')
page_title = soup.find('title')
if page_title:
    print(f"Page title: {page_title.get_text().strip()}")

# Extract text content
all_text = soup.get_text()
print(f"Text content: {len(all_text):,} characters")

# Search for education data with completely explicit handling
print("\n=== SEARCHING FOR EDUCATION DATA ===")

# Find all education-related sections
education_sections = []

# Look for education section headers
education_header_pattern = r'Education\[edit\]'
education_header_matches = re.finditer(education_header_pattern, all_text)

for header_match in education_header_matches:
    section_start = header_match.start()
    # Find next section (look for next [edit] or end of text)
    next_section_pattern = r'\[edit\]'
    next_section_matches = re.finditer(next_section_pattern, all_text[section_start + 100:])
    
    section_end = len(all_text)
    for next_match in next_section_matches:
        section_end = section_start + 100 + next_match.start()
        break
    
    education_section_text = all_text[section_start:section_end]
    education_sections.append(education_section_text)
    print(f"Found education section: {len(education_section_text)} characters")

# Search for tertiary education mentions with gender data
tertiary_education_data = []

# Pattern: tertiary education followed by gender breakdown
tertiary_pattern = r'tertiary education[^.]{0,500}'
tertiary_matches = re.finditer(tertiary_pattern, all_text, re.IGNORECASE | re.DOTALL)

for tertiary_match in tertiary_matches:
    match_text = tertiary_match.group()
    match_start_pos = tertiary_match.start()
    match_end_pos = tertiary_match.end()
    
    # Get broader context
    context_start = max(0, match_start_pos - 300)
    context_end = min(len(all_text), match_end_pos + 300)
    broader_context = all_text[context_start:context_end]
    
    # Check if this context contains gender information
    has_male = 'male' in broader_context.lower()
    has_female = 'female' in broader_context.lower()
    has_men = 'men' in broader_context.lower()
    has_women = 'women' in broader_context.lower()
    has_gender = has_male or has_female or has_men or has_women
    
    # Check for 2011 reference
    has_2011 = '2011' in broader_context
    
    # Check for Bulgaria reference
    has_bulgaria = 'bulgaria' in broader_context.lower() or 'bulgarian' in broader_context.lower()
    
    if has_gender:
        tertiary_data = {
            'match_text': match_text,
            'context': broader_context,
            'has_gender': has_gender,
            'has_2011': has_2011,
            'has_bulgaria': has_bulgaria
        }
        tertiary_education_data.append(tertiary_data)

print(f"Tertiary education matches with gender data: {len(tertiary_education_data)}")

# Extract specific statistics from the matches
statistical_findings = []

for data_item in tertiary_education_data:
    context_text = data_item['context']
    
    # Look for numerical patterns in the context
    # Pattern 1: "male: X years" or "female: X years"
    gender_years_pattern = r'(male|female):\s*(\d+)\s*years?'
    gender_years_matches = re.finditer(gender_years_pattern, context_text, re.IGNORECASE)
    
    for gy_match in gender_years_matches:
        gender = gy_match.group(1)
        years = gy_match.group(2)
        
        statistical_finding = {
            'type': 'years_of_education',
            'gender': gender,
            'value': years,
            'unit': 'years',
            'context': context_text
        }
        statistical_findings.append(statistical_finding)
    
    # Pattern 2: "male: X%" or "female: X%"
    gender_percent_pattern = r'(male|female):\s*(\d+\.?\d*)\s*%'
    gender_percent_matches = re.finditer(gender_percent_pattern, context_text, re.IGNORECASE)
    
    for gp_match in gender_percent_matches:
        gender = gp_match.group(1)
        percentage = gp_match.group(2)
        
        statistical_finding = {
            'type': 'percentage_statistic',
            'gender': gender,
            'value': percentage,
            'unit': 'percent',
            'context': context_text
        }
        statistical_findings.append(statistical_finding)
    
    # Pattern 3: "total: X" followed by gender breakdown
    total_pattern = r'total:\s*(\d+\.?\d*)\s*(%|years?)'
    total_matches = re.finditer(total_pattern, context_text, re.IGNORECASE)
    
    for total_match in total_matches:
        total_value = total_match.group(1)
        total_unit = total_match.group(2)
        
        statistical_finding = {
            'type': 'total_statistic',
            'gender': 'total',
            'value': total_value,
            'unit': total_unit,
            'context': context_text
        }
        statistical_findings.append(statistical_finding)

print(f"Statistical findings extracted: {len(statistical_findings)}")

# Display findings
if len(statistical_findings) > 0:
    print("\n=== STATISTICAL FINDINGS ===")
    for i in range(len(statistical_findings)):
        finding = statistical_findings[i]
        finding_number = i + 1
        
        print(f"\nFinding {finding_number}:")
        print(f"  Type: {finding['type']}")
        print(f"  Gender: {finding['gender']}")
        print(f"  Value: {finding['value']} {finding['unit']}")
        
        # Show relevant context snippet
        context_snippet = finding['context'][:200] + '...' if len(finding['context']) > 200 else finding['context']
        print(f"  Context: {context_snippet}")

# Look for 2011 census specific data
print("\n=== SEARCHING FOR 2011 CENSUS DATA ===")

census_2011_findings = []

# Search for 2011 census references
census_pattern = r'2011[^.]{0,500}census[^.]{0,500}'
census_matches = re.finditer(census_pattern, all_text, re.IGNORECASE | re.DOTALL)

for census_match in census_matches:
    census_text = census_match.group()
    census_start = census_match.start()
    census_end = census_match.end()
    
    # Get extended context
    extended_start = max(0, census_start - 400)
    extended_end = min(len(all_text), census_end + 400)
    extended_context = all_text[extended_start:extended_end]
    
    # Check if this mentions education
    mentions_education = ('education' in extended_context.lower() or 
                         'tertiary' in extended_context.lower() or
                         'university' in extended_context.lower())
    
    if mentions_education:
        census_finding = {
            'census_text': census_text,
            'extended_context': extended_context,
            'mentions_education': mentions_education
        }
        census_2011_findings.append(census_finding)

print(f"2011 census references with education: {len(census_2011_findings)}")

for i in range(len(census_2011_findings)):
    census_item = census_2011_findings[i]
    item_number = i + 1
    
    print(f"\nCensus Finding {item_number}:")
    census_preview = census_item['census_text'][:150] + '...' if len(census_item['census_text']) > 150 else census_item['census_text']
    print(f"  Census text: {census_preview}")
    
    context_preview = census_item['extended_context'][:300] + '...' if len(census_item['extended_context']) > 300 else census_item['extended_context']
    print(f"  Context: {context_preview}")

# Compile comprehensive results
comprehensive_results = {
    'objective': 'Bulgarian 2011 census tertiary education completion by gender',
    'analysis_timestamp': time.strftime('%Y-%m-%d %H:%M:%S'),
    'source_file': target_file,
    'education_sections_found': len(education_sections),
    'tertiary_education_matches': len(tertiary_education_data),
    'statistical_findings': len(statistical_findings),
    'census_2011_findings': len(census_2011_findings),
    'detailed_data': {
        'tertiary_education_data': tertiary_education_data,
        'statistical_findings': statistical_findings,
        'census_2011_findings': census_2011_findings
    }
}

# Save results
results_filename = 'bulgarian_census_tertiary_education_comprehensive_final.json'
results_filepath = os.path.join(workspace_path, results_filename)

with open(results_filepath, 'w', encoding='utf-8') as f:
    json.dump(comprehensive_results, f, indent=2, ensure_ascii=False)

print(f"\n=== COMPREHENSIVE RESULTS SAVED ===")
print(f"Results file: {results_filename}")
print(f"Education sections: {comprehensive_results['education_sections_found']}")
print(f"Tertiary education matches: {comprehensive_results['tertiary_education_matches']}")
print(f"Statistical findings: {comprehensive_results['statistical_findings']}")
print(f"2011 census findings: {comprehensive_results['census_2011_findings']}")

# Summary of key data found
print("\n=== KEY DATA SUMMARY ===")

# Group statistical findings by type
years_data = []
percentage_data = []
total_data = []

for finding in statistical_findings:
    if finding['type'] == 'years_of_education':
        years_data.append(finding)
    elif finding['type'] == 'percentage_statistic':
        percentage_data.append(finding)
    elif finding['type'] == 'total_statistic':
        total_data.append(finding)

if len(years_data) > 0:
    print("\nYears of Education by Gender:")
    for years_item in years_data:
        print(f"  {years_item['gender']}: {years_item['value']} {years_item['unit']}")

if len(percentage_data) > 0:
    print("\nPercentage Statistics by Gender:")
    for percent_item in percentage_data:
        print(f"  {percent_item['gender']}: {percent_item['value']}%")

if len(total_data) > 0:
    print("\nTotal Statistics:")
    for total_item in total_data:
        print(f"  {total_item['gender']}: {total_item['value']} {total_item['unit']}")

print("\n=== ANALYSIS COMPLETE ===")
print("Bulgarian 2011 census tertiary education by gender data extraction completed.")
print(f"All findings saved to: {results_filename}")
```