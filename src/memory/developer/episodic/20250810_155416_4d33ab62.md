### Development Step 5: Tracing Surrey Lodge’s Victorian Roots, Temperance Hall to Rotating Stage, WWII Damage and Burnley Move

**Description**: Conduct a comprehensive web search to identify Surrey Lodge in South London and trace its historical development during the Victorian era. Focus on finding information about: (1) the original organization that developed Surrey Lodge, (2) its transformation into a temperance hall, (3) the installation of the UK's first rotating stage in 1935, (4) World War II bomb damage, and (5) the company's relocation to Burnley. Use search terms like 'Surrey Lodge South London Victorian era temperance hall', 'first rotating stage UK 1935 temperance hall', 'Surrey Lodge bomb damage World War II Burnley', and 'Victorian temperance organization Surrey Lodge founder'.

**Use Cases**:
- Heritage conservation consultants conducting a detailed war damage assessment report on Surrey Lodge’s WWII bombing for restoration grant applications
- Academic theatre historians verifying archival evidence of the UK’s first rotating stage installation in 1935 at a former temperance hall
- Local council urban planners compiling a development dossier on Victorian-era Surrey Lodge origins to inform South London revitalization projects
- Museum curators preparing an exhibition on the temperance movement by tracing the founding organization and transformation of Surrey Lodge
- Genealogists researching a family-run company’s relocation timeline from Surrey Lodge in London to Burnley after World War II
- Property lawyers assembling historical title documentation and land use changes for legal disputes over Surrey Lodge site redevelopment
- Documentary filmmakers gathering chronological milestones and expert sources for a film segment on South London social venues and their evolution

```
from ddgs import DDGS
import os
import json
import time
from collections import Counter

print('=== SURREY LODGE SOUTH LONDON HISTORICAL RESEARCH - FRESH SEARCH APPROACH ===')
print('Objective: Trace Surrey Lodge Victorian era development using public search API')
print('Focus: Original organization, temperance hall, 1935 rotating stage, WWII damage, Burnley relocation\n')

# Ensure workspace directory exists
os.makedirs('workspace', exist_ok=True)

# Initialize comprehensive research results
research_results = {
    'timestamp': time.strftime('%Y-%m-%d %H:%M:%S'),
    'objective': 'Identify Surrey Lodge South London and trace Victorian era historical development',
    'focus_areas': [
        'Original organization that developed Surrey Lodge',
        'Transformation into temperance hall',
        'Installation of UK first rotating stage in 1935', 
        'World War II bomb damage',
        'Company relocation to Burnley'
    ],
    'search_queries': [],
    'search_results': [],
    'historical_evidence': {},
    'timeline_information': [],
    'analysis_summary': {}
}

print('TARGET HISTORICAL ELEMENTS:')
for i, area in enumerate(research_results['focus_areas'], 1):
    print(f'  {i}. {area}')

# Define comprehensive search queries for Surrey Lodge research
search_queries = [
    'Surrey Lodge South London Victorian era temperance hall history',
    'Surrey Lodge temperance hall first rotating stage UK 1935',
    'Surrey Lodge South London bomb damage World War II Burnley relocation',
    'Victorian temperance organization Surrey Lodge founder South London',
    '"Surrey Lodge" temperance hall rotating stage 1935 theatre',
    'Surrey Lodge South London historical development Victorian temperance movement',
    '"first rotating stage" UK 1935 temperance hall Surrey Lodge',
    'Surrey Lodge bomb damage WWII company moved Burnley Lancashire',
    'Victorian temperance hall Surrey Lodge South London organization founder',
    'Surrey Lodge theatre rotating stage 1935 temperance movement history'
]

print(f'\nExecuting {len(search_queries)} targeted searches using public search API:')
for i, query in enumerate(search_queries, 1):
    print(f'  {i}. {query}')

# Initialize search engine
searcher = DDGS(timeout=15)

print('\n=== PHASE 1: SYSTEMATIC SEARCH EXECUTION ===') 
print('=' * 80)

# Execute searches with comprehensive analysis
for i, query in enumerate(search_queries, 1):
    print(f'\nSearch {i}/{len(search_queries)}: {query}')
    print('-' * 70)
    
    try:
        # Execute search with multiple backend fallbacks
        results = searcher.text(
            query, 
            max_results=10, 
            page=1, 
            backend=["google", "duckduckgo", "bing", "yahoo"], 
            safesearch="off", 
            region="en-us"
        )
        
        if results:
            print(f'Found {len(results)} results')
            
            # Analyze each result for Surrey Lodge historical information
            query_findings = {
                'query': query,
                'search_number': i,
                'results_count': len(results),
                'relevant_results': [],
                'historical_indicators': [],
                'timeline_references': []
            }
            
            # Define key terms for relevance analysis
            key_terms = {
                'surrey lodge': 10,
                'south london': 8,
                'temperance': 8,
                'temperance hall': 10,
                'victorian': 6,
                'rotating stage': 10,
                '1935': 8,
                'first rotating stage': 12,
                'bomb damage': 8,
                'world war': 6,
                'wwii': 6,
                'burnley': 8,
                'relocation': 6,
                'theatre': 5,
                'organization': 5,
                'founder': 6,
                'developed': 4,
                'transformation': 5,
                'installation': 5,
                'company': 4
            }
            
            # Analyze each search result
            for j, result in enumerate(results, 1):
                title = result.get('title', '').lower()
                body = result.get('body', '').lower()
                url = result.get('href', '')
                
                # Combine title and body for analysis
                full_text = f"{title} {body}"
                
                # Calculate relevance score
                relevance_score = 0
                found_terms = []
                
                for term, weight in key_terms.items():
                    if term in full_text:
                        found_terms.append(term)
                        relevance_score += weight
                
                # Check for historical indicators
                historical_indicators = []
                
                if 'surrey lodge' in full_text:
                    historical_indicators.append('Surrey Lodge confirmed')
                
                if 'temperance hall' in full_text or ('temperance' in full_text and 'hall' in full_text):
                    historical_indicators.append('Temperance hall connection found')
                
                if 'rotating stage' in full_text:
                    historical_indicators.append('Rotating stage reference found')
                    if '1935' in full_text:
                        historical_indicators.append('1935 rotating stage date confirmed')
                
                if any(term in full_text for term in ['bomb damage', 'bombed', 'war damage', 'blitz']):
                    historical_indicators.append('WWII damage reference found')
                
                if 'burnley' in full_text:
                    historical_indicators.append('Burnley connection found')
                
                # Store relevant results (score >= 5 or has historical indicators)
                if relevance_score >= 5 or len(historical_indicators) > 0:
                    relevant_result = {
                        'result_number': j,
                        'title': result.get('title', ''),
                        'body': result.get('body', ''),
                        'url': url,
                        'relevance_score': relevance_score,
                        'found_terms': found_terms,
                        'historical_indicators': historical_indicators
                    }
                    
                    query_findings['relevant_results'].append(relevant_result)
                    query_findings['historical_indicators'].extend(historical_indicators)
                    
                    print(f'  📋 Result {j}: Score {relevance_score}, Indicators: {", ".join(historical_indicators)}')
                    print(f'      Title: {result.get("title", "")[:100]}...')
                    
                    # Look for timeline information
                    if any(term in full_text for term in ['1935', 'victorian', 'war', 'bomb', 'founded', 'established']):
                        timeline_text = f"{result.get('title', '')} - {result.get('body', '')[:200]}"
                        query_findings['timeline_references'].append(timeline_text)
            
            # Show query summary
            total_relevant = len(query_findings['relevant_results'])
            unique_indicators = len(set(query_findings['historical_indicators']))
            
            print(f'\n📊 Query Summary:')
            print(f'   • Relevant results: {total_relevant}/{len(results)}')
            print(f'   • Historical indicators: {unique_indicators}')
            print(f'   • Timeline references: {len(query_findings["timeline_references"])}')
            
            if query_findings['historical_indicators']:
                indicator_counts = Counter(query_findings['historical_indicators'])
                print(f'   • Top indicators: {", ".join([f"{ind}({count})" for ind, count in indicator_counts.most_common(3)])}')
            
            # Store query findings
            research_results['search_results'].append(query_findings)
            research_results['search_queries'].append(query)
            
        else:
            print('❌ No results found')
            research_results['search_queries'].append(query)
    
    except Exception as e:
        print(f'❌ Search error: {str(e)}')
    
    # Rate limiting
    time.sleep(2)

print('\n' + '=' * 80)
print('PHASE 2: COMPREHENSIVE EVIDENCE ANALYSIS')
print('=' * 80)

total_searches = len(research_results['search_results'])
print(f'Completed searches: {total_searches}')

if research_results['search_results']:
    # Compile all evidence across searches
    all_relevant_results = []
    all_historical_indicators = []
    all_timeline_references = []
    
    for search_data in research_results['search_results']:
        all_relevant_results.extend(search_data['relevant_results'])
        all_historical_indicators.extend(search_data['historical_indicators'])
        all_timeline_references.extend(search_data['timeline_references'])
    
    print(f'\n📊 OVERALL RESEARCH STATISTICS:')
    print(f'   • Total relevant results: {len(all_relevant_results)}')
    print(f'   • Historical indicators found: {len(all_historical_indicators)}')
    print(f'   • Timeline references: {len(all_timeline_references)}')
    
    # Analyze evidence frequency
    indicator_counts = Counter(all_historical_indicators)
    
    print('\n📈 HISTORICAL EVIDENCE FREQUENCY:')
    print('-' * 45)
    for indicator, count in indicator_counts.most_common():
        print(f'  • {indicator}: {count} mentions')
    
    # Focus area evidence analysis
    evidence_analysis = {
        'surrey_lodge_identified': 'Surrey Lodge confirmed' in all_historical_indicators,
        'temperance_hall_connection': 'Temperance hall connection found' in all_historical_indicators,
        'rotating_stage_1935': ('Rotating stage reference found' in all_historical_indicators and 
                               '1935 rotating stage date confirmed' in all_historical_indicators),
        'wwii_damage_confirmed': 'WWII damage reference found' in all_historical_indicators,
        'burnley_relocation': 'Burnley connection found' in all_historical_indicators
    }
    
    research_results['historical_evidence'] = evidence_analysis
    
    print('\n🔍 FOCUS AREA EVIDENCE ANALYSIS:')
    print('-' * 45)
    for area, confirmed in evidence_analysis.items():
        status = '✅' if confirmed else '❌'
        print(f'{status} {area.replace("_", " ").title()}: {confirmed}')
    
    # Calculate research success rate
    confirmed_count = sum(evidence_analysis.values())
    success_percentage = (confirmed_count / len(evidence_analysis)) * 100
    
    print(f'\n📈 RESEARCH SUCCESS RATE: {success_percentage:.1f}% ({confirmed_count}/{len(evidence_analysis)} areas confirmed)')
    research_results['analysis_summary']['success_percentage'] = success_percentage
    
    # Identify top findings by relevance
    all_relevant_results.sort(key=lambda x: x['relevance_score'], reverse=True)
    
    print('\n🎯 TOP HIGH-RELEVANCE FINDINGS:')
    print('-' * 50)
    
    for i, result in enumerate(all_relevant_results[:5], 1):
        print(f'\n{i}. Score: {result["relevance_score"]} | Query: {result.get("query", "N/A")}')
        print(f'   Title: {result["title"][:120]}...')
        print(f'   URL: {result["url"]}')
        print(f'   Terms: {", ".join(result["found_terms"][:6])}')
        print(f'   Evidence: {", ".join(result["historical_indicators"])}')
        if result.get('body'):
            print(f'   Content: {result["body"][:150]}...')
    
    # Compile unique timeline information
    unique_timeline = list(set(all_timeline_references))
    research_results['timeline_information'] = unique_timeline[:10]
    
    if unique_timeline:
        print('\n📅 HISTORICAL TIMELINE REFERENCES:')
        print('-' * 50)
        for i, timeline_ref in enumerate(unique_timeline[:6], 1):
            print(f'{i}. {timeline_ref[:250]}...')
    
else:
    print('❌ No search results collected')

# Save comprehensive research results
results_file = os.path.join('workspace', 'surrey_lodge_comprehensive_research.json')
with open(results_file, 'w', encoding='utf-8') as f:
    json.dump(research_results, f, indent=2, ensure_ascii=False)

print(f'\n💾 COMPREHENSIVE RESEARCH SAVED TO: {results_file}')

# Create detailed research report
report_content = f'''SURREY LODGE SOUTH LONDON HISTORICAL RESEARCH
COMPREHENSIVE ANALYSIS REPORT
Generated: {research_results["timestamp"]}

RESEARCH OBJECTIVE:
Trace Surrey Lodge historical development during Victorian era focusing on:
'''

for area in research_results['focus_areas']:
    report_content += f'• {area}\n'

report_content += f'''
SEARCH EXECUTION:
• Queries executed: {len(research_results["search_queries"])}
• Successful searches: {len(research_results["search_results"])}
• Total relevant results: {len(all_relevant_results) if research_results["search_results"] else 0}
'''

if research_results.get('analysis_summary', {}).get('success_percentage'):
    report_content += f'• Research success rate: {research_results["analysis_summary"]["success_percentage"]:.1f}%\n'

report_content += f'''\nEVIDENCE ANALYSIS:\n'''

if research_results.get('historical_evidence'):
    for area, confirmed in research_results['historical_evidence'].items():
        status = 'CONFIRMED' if confirmed else 'NOT FOUND'
        report_content += f'• {area.replace("_", " ").title()}: {status}\n'

report_content += f'''\nTOP FINDINGS:\n'''

if research_results['search_results']:
    for i, result in enumerate(all_relevant_results[:5], 1):
        report_content += f'''{i}. {result["title"]}
   URL: {result["url"]}
   Relevance Score: {result["relevance_score"]}
   Evidence: {", ".join(result["historical_indicators"])}
   Content: {result.get("body", "")[:200]}...

'''

report_content += f'''TIMELINE INFORMATION:\n'''

for i, timeline_ref in enumerate(research_results.get('timeline_information', [])[:5], 1):
    report_content += f'{i}. {timeline_ref[:300]}...\n\n'

report_content += f'''FILES GENERATED:
• surrey_lodge_comprehensive_research.json - Complete research data
• surrey_lodge_detailed_report.txt - This detailed report

CONCLUSIONS:
'''

if research_results.get('analysis_summary', {}).get('success_percentage', 0) >= 60:
    report_content += 'Research successful - multiple historical elements confirmed\n'
elif research_results.get('analysis_summary', {}).get('success_percentage', 0) >= 30:
    report_content += 'Partial success - some historical elements identified\n'
else:
    report_content += 'Limited success - further targeted research recommended\n'

report_content += f'''\nRECOMMENDATIONS:
1. Follow up on high-relevance URLs for detailed historical information
2. Cross-reference findings with historical archives and databases
3. Research specific Victorian temperance organizations mentioned
4. Investigate theatre history sources for rotating stage details
5. Examine local South London historical records
'''

# Save detailed report
report_file = os.path.join('workspace', 'surrey_lodge_detailed_report.txt')
with open(report_file, 'w', encoding='utf-8') as f:
    f.write(report_content)

print(f'📋 DETAILED REPORT SAVED TO: {report_file}')

print('\n' + '=' * 90)
print('SURREY LODGE SOUTH LONDON HISTORICAL RESEARCH COMPLETE')
print('=' * 90)

if research_results.get('analysis_summary', {}).get('success_percentage', 0) >= 50:
    print('✅ RESEARCH SUCCESSFUL - Historical elements identified')
elif research_results.get('analysis_summary', {}).get('success_percentage', 0) >= 25:
    print('⚠️ PARTIAL SUCCESS - Some elements found, further investigation recommended')
else:
    print('❌ LIMITED SUCCESS - Alternative research approaches needed')

print('\n📊 FINAL RESEARCH STATISTICS:')
print(f'   • Search queries executed: {len(research_results["search_queries"])}')
print(f'   • Successful searches: {len(research_results["search_results"])}')
print(f'   • Relevant results found: {len(all_relevant_results) if research_results["search_results"] else 0}')
print(f'   • Historical indicators: {len(set(all_historical_indicators)) if research_results["search_results"] else 0}')
print(f'   • Timeline references: {len(research_results.get("timeline_information", []))}')

if research_results.get('historical_evidence'):
    confirmed_areas = [area.replace('_', ' ').title() for area, confirmed in research_results['historical_evidence'].items() if confirmed]
    if confirmed_areas:
        print('\n🎯 CONFIRMED HISTORICAL ELEMENTS:')
        for area in confirmed_areas:
            print(f'   ✅ {area}')

print('\n📋 NEXT STEPS: Review detailed report and follow up on high-relevance URLs for specific historical details')
print('=== SURREY LODGE COMPREHENSIVE HISTORICAL RESEARCH COMPLETE ===')
```