### Development Step 57: Extract 2011 Bulgarian census tertiary education completion numbers by gender from Census2011final_en.pdf

**Description**: Extract the specific tertiary education completion data by gender from the downloaded Census2011final_en.pdf file in the workspace. Parse the document to locate the section containing tertiary education graduates by educational-qualification degree and sex, then extract the exact numbers of men and women who completed tertiary education according to the 2011 Bulgarian census.

**Use Cases**:
- Government education policy analysis for the Bulgarian Ministry of Education to identify gender gaps in tertiary graduation rates and allocate resources accordingly
- Academic demographic research on higher education attainment trends by sex across Bulgarian regions for journal publication
- NGO gender equity reporting to automate the extraction of male and female tertiary graduate counts for annual impact assessments
- Evaluation of scholarship and grant program outcomes by comparing pre- and post-intervention tertiary completion figures for men and women
- Market intelligence for edTech firms to tailor course offerings based on the ratio of male versus female university graduates in Bulgaria
- Data journalism and interactive dashboard creation to visualize regional differences in tertiary education completion by gender
- International development benchmarking for organizations like UNESCO to compare Bulgaria‚Äôs gender parity in higher education with other countries

```
import os
from langchain_community.document_loaders import PyPDFLoader

# Use the correct PDF file path found in the previous step
pdf_path = "workspace_e0c10771-d627-4fd7-9694-05348e54ee36/census_2011_Census2011final_en.pdf"
print(f"Loading PDF file: {pdf_path}")
print(f"File size: {os.path.getsize(pdf_path)} bytes ({os.path.getsize(pdf_path)/1024/1024:.2f} MB)")

# Load and examine the PDF structure
print("\nLoading PDF with LangChain PyPDFLoader...")
loader = PyPDFLoader(pdf_path)
pages = loader.load_and_split()

print(f"Total pages in PDF: {len(pages)}")

if len(pages) == 0:
    print("ERROR: No pages found in PDF")
else:
    print("\n=== SEARCHING FOR TERTIARY EDUCATION DATA BY GENDER ===")
    
    # Enhanced search for education-related content
    education_keywords = ['tertiary', 'higher education', 'university', 'degree', 'graduate', 'qualification', 'educational attainment', 'education level', 'completed education']
    gender_keywords = ['men', 'women', 'male', 'female', 'sex', 'gender', 'by sex', 'by gender']
    numerical_patterns = ['total', 'number', 'persons', 'population']
    
    relevant_pages = []
    
    for i, page in enumerate(pages):
        content = page.page_content.lower()
        original_content = page.page_content
        
        # Check if page contains education, gender, and numerical data
        has_education = False
        has_gender = False
        has_numbers = False
        has_numerical_context = False
        
        # Check education keywords
        for keyword in education_keywords:
            if keyword in content:
                has_education = True
                break
                
        # Check gender keywords
        for keyword in gender_keywords:
            if keyword in content:
                has_gender = True
                break
                
        # Check for numbers
        for char in original_content:
            if char.isdigit():
                has_numbers = True
                break
                
        # Check numerical patterns
        for pattern in numerical_patterns:
            if pattern in content:
                has_numerical_context = True
                break
        
        # Score the relevance of each page
        relevance_score = 0
        if has_education: 
            relevance_score += 2
        if has_gender: 
            relevance_score += 2  
        if has_numbers: 
            relevance_score += 1
        if has_numerical_context: 
            relevance_score += 1
        
        if relevance_score >= 3:  # Minimum threshold for relevance
            relevant_pages.append((i, relevance_score))
            print(f"\nüìÑ Page {i+1} (relevance score: {relevance_score})")
            
            # Show keywords found
            found_edu = []
            found_gender = []
            for kw in education_keywords:
                if kw in content:
                    found_edu.append(kw)
            for kw in gender_keywords:
                if kw in content:
                    found_gender.append(kw)
                    
            print(f"  Education keywords: {found_edu}")
            print(f"  Gender keywords: {found_gender}")
            
            # Show a preview of the page content
            preview = original_content[:400].replace('\n', ' ').strip()
            print(f"  Preview: {preview}...")
    
    # Sort by relevance score (highest first)
    relevant_pages.sort(key=lambda x: x[1], reverse=True)
    print(f"\nFound {len(relevant_pages)} potentially relevant pages")
    
    # Examine the most relevant pages in detail
    if relevant_pages:
        print("\n=== DETAILED EXAMINATION OF MOST RELEVANT PAGES ===")
        
        for page_idx, score in relevant_pages[:3]:  # Examine top 3 most relevant pages
            print(f"\n{'='*60}")
            print(f"PAGE {page_idx+1} (Relevance Score: {score})")
            print(f"{'='*60}")
            content = pages[page_idx].page_content
            print(content)
            print(f"{'='*60}")
            
            # Look for specific patterns that might indicate tertiary education data
            lines = content.split('\n')
            for line_num, line in enumerate(lines, 1):
                line_lower = line.lower()
                if ('tertiary' in line_lower or 'higher' in line_lower or 'university' in line_lower) and any(char.isdigit() for char in line):
                    print(f"\n*** POTENTIAL TERTIARY EDUCATION DATA (Line {line_num}): {line.strip()} ***")
    else:
        print("\n‚ö†Ô∏è No highly relevant pages found. Searching with broader criteria...")
        
        # Broader search for any education-related content
        for i, page in enumerate(pages[:30]):  # Check first 30 pages
            content = page.page_content.lower()
            education_terms = ['education', 'qualification', 'attainment', 'level']
            has_education_term = False
            for term in education_terms:
                if term in content:
                    has_education_term = True
                    break
                    
            if has_education_term:
                print(f"\nPage {i+1} contains education-related content:")
                preview = page.page_content[:300].replace('\n', ' ').strip()
                print(f"Preview: {preview}...")
                
                # Check for tables or structured data
                if '|' in page.page_content or 'table' in content:
                    print("  ‚Ü≥ This page appears to contain tabular data")

print("\n=== PDF ANALYSIS COMPLETE ===")
```