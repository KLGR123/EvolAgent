### Development Step 6: ASEAN Capitals Distance Matrix and Farthest Pair Identification via Haversine Formula

**Description**: Calculate the geographical distances between all possible pairs of ASEAN capital cities using the coordinate data from workspace/asean_complete_coordinates.json. Apply the haversine formula to compute great circle distances between each pair of capitals, then identify which two countries have the maximum distance between their capital cities. Create a comprehensive distance matrix showing all pairwise distances and determine the two ASEAN member countries whose capitals are geographically furthest apart.

**Use Cases**:
- Logistics route optimization for freight companies calculating the shortest shipping legs between ASEAN capitals to minimize transit time and fuel costs
- Government travel coordination for foreign affairs offices scheduling official visits and arranging the most efficient travel routes between member-state capitals
- Travel agency itinerary planning for multi-city Southeast Asia tours, using capital-to-capital distances to design balanced schedules and pricing models
- Emergency response modeling for disaster relief organizations estimating rapid deployment times between ASEAN capitals during regional crises
- Airline network analysis for carriers evaluating the feasibility and demand of direct flights connecting underserved ASEAN capitals
- Retail distribution strategy for consumer goods companies determining optimal warehouse locations based on proximity to multiple ASEAN capitals
- Sports event logistics planning for regional tournaments, coordinating team travel and accommodation by assessing inter-capital distances
- Environmental impact studies for researchers mapping pollutant dispersion corridors between capitals to inform cross-border air quality policies

```
import json
import math

# Load the ASEAN coordinates data that was previously analyzed
coordinates_file = 'workspace/asean_complete_coordinates.json'

print("=== LOADING ASEAN COORDINATE DATA ===")
with open(coordinates_file, 'r', encoding='utf-8') as f:
    data = json.load(f)

# Extract the countries_data list which contains all coordinate information
countries_data = data['countries_data']
print(f"Loaded coordinate data for {len(countries_data)} ASEAN countries")

# Display all countries and their capitals with coordinates
print("\n=== ASEAN CAPITALS COORDINATE SUMMARY ===")
for i, country in enumerate(countries_data, 1):
    print(f"{i:2d}. {country['country']:15} - {country['capital']:20} ({country['latitude']:8.5f}, {country['longitude']:9.5f})")

# Define haversine formula function to calculate great circle distances
def haversine_distance(lat1, lon1, lat2, lon2):
    """
    Calculate the great circle distance between two points on Earth
    using the haversine formula.
    
    Parameters:
    lat1, lon1: latitude and longitude of first point (in decimal degrees)
    lat2, lon2: latitude and longitude of second point (in decimal degrees)
    
    Returns:
    distance in kilometers
    """
    # Convert decimal degrees to radians
    lat1_rad = math.radians(lat1)
    lon1_rad = math.radians(lon1)
    lat2_rad = math.radians(lat2)
    lon2_rad = math.radians(lon2)
    
    # Haversine formula calculation
    dlat = lat2_rad - lat1_rad
    dlon = lon2_rad - lon1_rad
    
    a = math.sin(dlat/2)**2 + math.cos(lat1_rad) * math.cos(lat2_rad) * math.sin(dlon/2)**2
    c = 2 * math.asin(math.sqrt(a))
    
    # Earth's radius in kilometers (mean radius)
    earth_radius_km = 6371.0
    
    # Calculate the distance
    distance = earth_radius_km * c
    
    return distance

print("\n=== CALCULATING ALL PAIRWISE DISTANCES ===")
print("Using Haversine formula to compute great circle distances between all ASEAN capital pairs...")

# Create distance matrix - list to store all distance calculations
distance_matrix = []
max_distance = 0
max_distance_pair = None

# Calculate distances between all pairs of capitals
for i in range(len(countries_data)):
    for j in range(i + 1, len(countries_data)):  # Only calculate upper triangle to avoid duplicates
        country1 = countries_data[i]
        country2 = countries_data[j]
        
        # Extract coordinates
        lat1, lon1 = country1['latitude'], country1['longitude']
        lat2, lon2 = country2['latitude'], country2['longitude']
        
        # Calculate distance using haversine formula
        distance = haversine_distance(lat1, lon1, lat2, lon2)
        
        # Store the distance calculation
        distance_info = {
            'country1': country1['country'],
            'capital1': country1['capital'],
            'coordinates1': (lat1, lon1),
            'country2': country2['country'],
            'capital2': country2['capital'],
            'coordinates2': (lat2, lon2),
            'distance_km': distance
        }
        
        distance_matrix.append(distance_info)
        
        # Track maximum distance
        if distance > max_distance:
            max_distance = distance
            max_distance_pair = distance_info
        
        # Print each calculation for verification
        print(f"{country1['country']:15} - {country2['country']:15}: {distance:7.1f} km")

# Sort distance matrix by distance (descending order)
distance_matrix_sorted = sorted(distance_matrix, key=lambda x: x['distance_km'], reverse=True)

print(f"\n=== DISTANCE CALCULATION COMPLETE ===")
print(f"Total pairs calculated: {len(distance_matrix)}")
print(f"Expected pairs for {len(countries_data)} countries: {len(countries_data) * (len(countries_data) - 1) // 2}")

print("\n=== TOP 10 LONGEST DISTANCES ===")
for i, dist_info in enumerate(distance_matrix_sorted[:10], 1):
    print(f"{i:2d}. {dist_info['country1']:15} - {dist_info['country2']:15}: {dist_info['distance_km']:7.1f} km")
    print(f"    {dist_info['capital1']} to {dist_info['capital2']}")

print("\n=== MAXIMUM DISTANCE IDENTIFICATION ===")
print(f"The two ASEAN countries with capitals furthest apart:")
print(f"Country 1: {max_distance_pair['country1']} (Capital: {max_distance_pair['capital1']})")
print(f"Country 2: {max_distance_pair['country2']} (Capital: {max_distance_pair['capital2']})")
print(f"Maximum Distance: {max_distance:.1f} kilometers")
print(f"Coordinates: {max_distance_pair['capital1']} {max_distance_pair['coordinates1']} to {max_distance_pair['capital2']} {max_distance_pair['coordinates2']}")

# Create comprehensive distance matrix in tabular format
print("\n=== COMPLETE DISTANCE MATRIX (All Pairwise Distances) ===")
print("Showing all {0} unique pairs sorted by distance:\n".format(len(distance_matrix)))

# Display full sorted matrix
for i, dist_info in enumerate(distance_matrix_sorted, 1):
    print(f"{i:2d}. {dist_info['country1']:15} - {dist_info['country2']:15}: {dist_info['distance_km']:7.1f} km")

# Save comprehensive results to workspace
results = {
    'analysis_summary': {
        'total_countries': len(countries_data),
        'total_pairs_calculated': len(distance_matrix),
        'calculation_method': 'Haversine formula for great circle distance',
        'earth_radius_used': 6371.0,
        'units': 'kilometers'
    },
    'maximum_distance': {
        'distance_km': max_distance,
        'country1': max_distance_pair['country1'],
        'capital1': max_distance_pair['capital1'],
        'coordinates1': max_distance_pair['coordinates1'],
        'country2': max_distance_pair['country2'], 
        'capital2': max_distance_pair['capital2'],
        'coordinates2': max_distance_pair['coordinates2']
    },
    'complete_distance_matrix': distance_matrix_sorted,
    'asean_countries_included': [country['country'] for country in countries_data]
}

with open('workspace/asean_distance_matrix_complete.json', 'w') as f:
    json.dump(results, f, indent=2)

print(f"\n=== RESULTS SAVED ===")
print(f"Complete analysis saved to: workspace/asean_distance_matrix_complete.json")
print(f"\n=== FINAL ANSWER ===")
print(f"The two ASEAN member countries whose capitals are geographically furthest apart are:")
print(f"**{max_distance_pair['country1']}** and **{max_distance_pair['country2']}**")
print(f"Distance between {max_distance_pair['capital1']} and {max_distance_pair['capital2']}: {max_distance:.1f} km")
```