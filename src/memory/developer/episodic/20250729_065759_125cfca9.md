### Development Step 2: Analyze Excel vendor data to compute revenue-to-rent ratios and extract lowest-earning vendor type

**Description**: Parse and analyze the attached Excel file data/gaia/2023/validation/076c8171-9b3b-49b9-a477-244d2a532826.xlsx to extract vendor data including monthly revenue, rent payments, and type information. Calculate the revenue-to-rent ratio for each vendor to identify which vendor makes the least money relative to their rent payments, then extract the corresponding type value for that vendor.

**Use Cases**:
- Shopping mall tenant performance evaluation and lease renegotiation planning for property management teams
- Coworking space profitability review to adjust membership tiers based on revenue-to-rent ratios of member companies
- Government small business support analysis to identify high rent-burdened vendors for targeted subsidy or tax relief programs
- Franchise operations monitoring to pinpoint underperforming restaurant outlets by comparing monthly sales against franchise fees/rent
- Real estate investment portfolio analysis to rank retail locations by revenue-to-rent efficiency for acquisition or divestment decisions
- Academic urban economics research processing vendor data across city districts to study rent stress among micro-enterprises
- Event and marketplace planning for pop-up vendor selection by evaluating past performance relative to stall rental costs
- Microfinance portfolio risk assessment to predict borrower strain by comparing vendor income streams against rent obligations

```
import os
import pandas as pd
from openpyxl import load_workbook
import json

# The path to the Excel file to be analyzed
xlsx_path = "data/gaia/2023/validation/076c8171-9b3b-49b9-a477-244d2a532826.xlsx"

print("=== DETAILED VENDOR DATA EXTRACTION - HEADER INVESTIGATION ===")
print(f"Re-analyzing file: {xlsx_path}")

# First, let's inspect the previous analysis to understand what we found
analysis_file = 'workspace/vendor_analysis_initial.json'
if os.path.exists(analysis_file):
    print(f"\nInspecting previous analysis: {analysis_file}")
    with open(analysis_file, 'r') as f:
        prev_analysis = json.load(f)
    print(f"Previous analysis keys: {list(prev_analysis.keys())}")
    print(f"File size from previous: {prev_analysis.get('file_size', 'Unknown')} bytes")
    print(f"Worksheets: {prev_analysis.get('worksheets', [])}")
else:
    print("No previous analysis file found")

# Load workbook with openpyxl to examine cell-by-cell
print("\n=== CELL-BY-CELL EXAMINATION FOR PROPER HEADERS ===")
wb = load_workbook(xlsx_path, data_only=True)
sheet = wb.active

print(f"Sheet name: {sheet.title}")
print(f"Dimensions: {sheet.max_row} rows x {sheet.max_column} columns")

# Examine first 10 rows thoroughly to find proper headers
print("\n=== RAW CELL CONTENT ANALYSIS (First 10 rows) ===")
for row in range(1, min(11, sheet.max_row + 1)):
    print(f"\nRow {row}:")
    row_values = []
    for col in range(1, sheet.max_column + 1):
        cell = sheet.cell(row=row, column=col)
        cell_value = cell.value if cell.value is not None else ""
        row_values.append(cell_value)
        print(f"  Column {col}: '{cell_value}' (type: {type(cell_value)})")
    print(f"  Complete row: {row_values}")

# Try different header row possibilities
print("\n=== TESTING DIFFERENT HEADER ROW POSSIBILITIES ===")

possible_headers = []
for potential_header_row in range(1, min(6, sheet.max_row + 1)):
    print(f"\n--- Testing Row {potential_header_row} as headers ---")
    headers = []
    for col in range(1, sheet.max_column + 1):
        cell = sheet.cell(row=potential_header_row, column=col)
        header_value = cell.value if cell.value is not None else f"Col_{col}"
        headers.append(str(header_value))
    
    print(f"Headers from row {potential_header_row}: {headers}")
    
    # Check for vendor-related keywords
    vendor_keywords = ['vendor', 'revenue', 'rent', 'type', 'payment', 'monthly', 'income', 'cost', 'name', 'id']
    keyword_matches = []
    
    for i, header in enumerate(headers):
        header_lower = str(header).lower()
        for keyword in vendor_keywords:
            if keyword in header_lower:
                keyword_matches.append({
                    'column': i + 1,
                    'header': header,
                    'keyword': keyword
                })
                print(f"  Found '{keyword}' in column {i + 1}: '{header}'")
    
    possible_headers.append({
        'row': potential_header_row,
        'headers': headers,
        'keyword_matches': keyword_matches,
        'score': len(keyword_matches)
    })

# Find the best header row
best_header_row = max(possible_headers, key=lambda x: x['score'])
print(f"\n=== BEST HEADER ROW IDENTIFIED ===")
print(f"Row {best_header_row['row']} has the most vendor-related keywords ({best_header_row['score']} matches)")
print(f"Headers: {best_header_row['headers']}")
print(f"Keyword matches: {best_header_row['keyword_matches']}")

# Now try to load with pandas using the identified header row
print("\n=== LOADING DATA WITH CORRECT HEADER ROW ===")

try:
    # Load with pandas, specifying the header row
    df = pd.read_excel(xlsx_path, header=best_header_row['row'] - 1)  # pandas uses 0-based indexing
    
    print(f"Successfully loaded data with header row {best_header_row['row']}")
    print(f"DataFrame shape: {df.shape}")
    print(f"Column names: {list(df.columns)}")
    
    # Clean up column names (remove extra spaces, etc.)
    df.columns = [str(col).strip() for col in df.columns]
    print(f"Cleaned column names: {list(df.columns)}")
    
    print("\n=== COMPLETE DATAFRAME CONTENT ===")
    print(df.to_string(index=False))
    
    print("\n=== DATA TYPES ANALYSIS ===")
    print(df.dtypes)
    
    print("\n=== MISSING VALUES CHECK ===")
    print(df.isnull().sum())
    
    # Now identify the specific columns we need
    print("\n=== VENDOR DATA COLUMN IDENTIFICATION ===")
    
    # Look for revenue columns
    revenue_cols = [col for col in df.columns if any(keyword in str(col).lower() for keyword in ['revenue', 'income', 'sales', 'earning'])]
    print(f"Revenue columns found: {revenue_cols}")
    
    # Look for rent columns  
    rent_cols = [col for col in df.columns if any(keyword in str(col).lower() for keyword in ['rent', 'payment', 'cost'])]
    print(f"Rent columns found: {rent_cols}")
    
    # Look for type columns
    type_cols = [col for col in df.columns if any(keyword in str(col).lower() for keyword in ['type', 'category', 'kind'])]
    print(f"Type columns found: {type_cols}")
    
    # Look for vendor identifier columns
    vendor_cols = [col for col in df.columns if any(keyword in str(col).lower() for keyword in ['vendor', 'name', 'id'])]
    print(f"Vendor identifier columns found: {vendor_cols}")
    
    # Save the properly loaded dataframe for next step
    df.to_csv('workspace/vendor_data_extracted.csv', index=False)
    print(f"\nExtracted vendor data saved to: workspace/vendor_data_extracted.csv")
    
    # Create detailed column analysis
    column_analysis = {
        'dataframe_shape': df.shape,
        'column_names': list(df.columns),
        'header_row_used': best_header_row['row'],
        'identified_columns': {
            'revenue': revenue_cols,
            'rent': rent_cols, 
            'type': type_cols,
            'vendor': vendor_cols
        },
        'data_types': df.dtypes.to_dict(),
        'missing_values': df.isnull().sum().to_dict()
    }
    
    with open('workspace/vendor_column_analysis.json', 'w') as f:
        json.dump(column_analysis, f, indent=2, default=str)
    
    print(f"Column analysis saved to: workspace/vendor_column_analysis.json")
    
except Exception as e:
    print(f"Error loading with pandas using header row {best_header_row['row']}: {e}")
    print("Falling back to manual row analysis...")
    
    # Manual analysis of data rows
    print("\n=== MANUAL DATA EXTRACTION ===")
    headers = best_header_row['headers']
    
    data_rows = []
    for row in range(best_header_row['row'] + 1, sheet.max_row + 1):
        row_data = {}
        for col in range(1, sheet.max_column + 1):
            cell = sheet.cell(row=row, column=col)
            cell_value = cell.value if cell.value is not None else ""
            header = headers[col-1] if col-1 < len(headers) else f"Col_{col}"
            row_data[header] = cell_value
        data_rows.append(row_data)
        
        if len(data_rows) <= 10:  # Show first 10 rows
            print(f"Row {row}: {row_data}")
    
    print(f"\nExtracted {len(data_rows)} data rows manually")

print("\n=== NEXT STEP: REVENUE-TO-RENT RATIO CALCULATION ===")
print("Data structure identified. Ready to calculate ratios and find vendor with least money relative to rent.")
```