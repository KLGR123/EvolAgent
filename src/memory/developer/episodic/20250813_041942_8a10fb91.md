### Development Step 10: Find 1839 Saunders & Otley novel by Robertson featuring Glasgow orphan clerk and Dickens illustrator

**Description**: Search for novels published by Saunders and Otley in 1839 that were authored by either William Parish Robertson or John Parish Robertson. Focus on identifying a novel set in rural Scotland and Wales featuring a young orphan clerk residing in Glasgow. Also search for information about which artist illustrated this novel, specifically looking for an illustrator known for working with Charles Dickens who also created 'The Great 100 Rat Match' circa 1858. Use search terms including 'Robertson Saunders Otley 1839 novel', 'Scotland Wales orphan clerk Glasgow novel 1839', and 'Dickens illustrator Great 100 Rat Match 1858'.

**Use Cases**:
- Automating rare books cataloging in a university library to identify and tag 1839 Saunders & Otley publications by William or John Parish Robertson, complete with setting and character metadata
- Enriching digital humanities research projects by extracting contextual details (Scotland, Wales, Glasgow orphan clerk) from 19th-century travel-writing sources for thematic mapping
- Streamlining museum exhibit curation by verifying Victorian illustrator attribution (Hablot Browne, George Cruikshank) for prints linked to Dickens‚Äôs ‚ÄúGreat 100 Rat Match‚Äù (1858)
- Powering publisher archival management systems to cross-reference historical Saunders & Otley catalogs against online indexes and automatically flag relevant entries from 1839
- Supporting local heritage and genealogy studies by locating narratives of orphan clerks in Glasgow and rural Scottish/Welsh communities within early Parish Robertson works
- Assisting literature instructors in university departments to source and annotate primary texts set in rural Scotland and Wales, complete with novel summaries and publication details
- Enhancing art history scholarship by programmatically identifying and scoring references to Dickens‚Äôs illustrators and their lesser-known works like ‚ÄúThe Great 100 Rat Match‚Äù
- Integrating automated web-search pipelines into digital library platforms to enrich bibliographic metadata with author, publisher, setting, and illustrator information for early Victorian novels

```
import os
import requests
from bs4 import BeautifulSoup
import json
import time
from urllib.parse import quote_plus
from ddgs import DDGS

print('=== FIXED SEARCH FOR ROBERTSON BROTHERS 1839 SAUNDERS & OTLEY NOVEL ===')
print('Objective: Find novel by William or John Parish Robertson')
print('Publisher: Saunders and Otley (1839)')
print('Setting: Rural Scotland and Wales, orphan clerk in Glasgow')
print('Also seeking: Dickens illustrator who created "The Great 100 Rat Match" (1858)')
print('\nFIXES APPLIED:')
print('‚Ä¢ Headers properly defined at module level')
print('‚Ä¢ Using DDGS library as primary search method')
print('‚Ä¢ Implementing retry logic for failed requests')
print('‚Ä¢ Adding comprehensive error handling')
print('\n' + '='*80 + '\n')

# Ensure workspace directory exists
os.makedirs('workspace', exist_ok=True)

# FIXED: Headers defined at module level before any function calls
headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
    'Accept-Language': 'en-US,en;q=0.5',
    'Connection': 'keep-alive'
}

# Initialize results storage
search_results = {
    'timestamp': time.strftime('%Y-%m-%d %H:%M:%S'),
    'objective': 'Find Robertson brothers 1839 novel published by Saunders & Otley',
    'method': 'DDGS library with fallback to direct web search',
    'searches_conducted': [],
    'novels_found': [],
    'illustrator_findings': [],
    'analysis': {},
    'technical_notes': 'Fixed headers scoping and implemented robust search methods'
}

print('=== PHASE 1: ROBERTSON NOVEL SEARCHES USING DDGS ===\n')

# Comprehensive search queries for the Robertson novel
novel_queries = [
    'William Parish Robertson Saunders Otley 1839 novel',
    'John Parish Robertson Saunders Otley 1839 novel',
    '"Parish Robertson" Saunders Otley 1839 Scotland Wales',
    'Robertson brothers 1839 novel Glasgow orphan clerk',
    'Saunders and Otley 1839 Scotland Wales novel Robertson',
    '"Letters on South America" Robertson Saunders Otley',
    'Parish Robertson novel 1839 rural Scotland Wales',
    'Robertson Saunders Otley publisher 1839 Glasgow novel'
]

print(f'Conducting {len(novel_queries)} targeted novel searches using DDGS:')
for i, query in enumerate(novel_queries, 1):
    print(f'  {i}. {query}')

# Function to search using DDGS library (more reliable)
def search_with_ddgs(query, search_index, search_type='novel'):
    print(f'\n--- {search_type.title()} Search {search_index}: {query} ---')
    
    try:
        # Initialize DDGS searcher
        searcher = DDGS(timeout=10)
        
        # Perform search with multiple backend fallbacks
        backends = ["google", "duckduckgo", "bing", "yandex", "brave"]
        results = []
        
        for backend in backends:
            try:
                print(f'Trying backend: {backend}')
                results = searcher.text(
                    query, 
                    max_results=10, 
                    page=1, 
                    backend=[backend], 
                    safesearch="off", 
                    region="en-us"
                )
                
                if results:
                    print(f'‚úÖ Success with {backend}: {len(results)} results')
                    break
                else:
                    print(f'‚ùå No results from {backend}')
                    
            except Exception as e:
                print(f'‚ùå Backend {backend} failed: {str(e)}')
                continue
        
        if not results:
            print('‚ùå All backends failed')
            return False
        
        # Save results to file for analysis
        clean_query = query.replace(' ', '_').replace('"', '').replace('/', '_')
        filename = f'{search_type}_search_{search_index:02d}_{clean_query[:40]}.json'
        filepath = os.path.join('workspace', filename)
        
        with open(filepath, 'w', encoding='utf-8') as f:
            json.dump({
                'query': query,
                'search_type': search_type,
                'results': results,
                'timestamp': time.strftime('%Y-%m-%d %H:%M:%S')
            }, f, indent=2, ensure_ascii=False)
        
        print(f'Saved results: {filepath}')
        
        # Analyze results for relevance
        relevant_results = []
        
        for i, result in enumerate(results, 1):
            title = result.get('title', '')
            body = result.get('body', '')
            url = result.get('href', '')
            
            combined_text = f'{title} {body}'.lower()
            
            # Calculate relevance score based on search type
            if search_type == 'novel':
                relevance_score = calculate_novel_relevance(combined_text)
                indicators = extract_novel_indicators(combined_text)
            else:  # illustrator
                relevance_score = calculate_illustrator_relevance(combined_text)
                indicators = extract_illustrator_indicators(combined_text)
            
            if relevance_score >= 8:  # High relevance threshold
                print(f'\n  üîç Result {i} (Score: {relevance_score})')
                print(f'    Title: {title[:100]}...')
                print(f'    Body: {body[:150]}...')
                print(f'    URL: {url}')
                print(f'    Indicators: {", ".join(indicators)}')
                
                relevant_results.append({
                    'title': title,
                    'body': body,
                    'url': url,
                    'relevance_score': relevance_score,
                    'indicators': indicators,
                    'query': query,
                    'search_index': search_index
                })
        
        # Store results in appropriate category
        if search_type == 'novel':
            search_results['novels_found'].extend(relevant_results)
        else:
            search_results['illustrator_findings'].extend(relevant_results)
        
        # Record search completion
        search_results['searches_conducted'].append({
            'query': query,
            'search_index': search_index,
            'search_type': search_type,
            'results_found': len(relevant_results),
            'total_results': len(results),
            'json_file': filepath
        })
        
        return True
        
    except Exception as e:
        print(f'Error in DDGS search: {str(e)}')
        return False

# Helper function to calculate novel relevance
def calculate_novel_relevance(text):
    score = 0
    
    # Key terms scoring for novels
    scoring_terms = [
        ('robertson', 3), ('parish', 3), ('william', 2), ('john', 2),
        ('saunders', 4), ('otley', 4), ('1839', 5),
        ('novel', 3), ('scotland', 3), ('wales', 3), ('glasgow', 3),
        ('orphan', 4), ('clerk', 3), ('rural', 2),
        ('published', 2), ('publisher', 2), ('book', 2),
        ('letters', 2), ('south america', 3), ('america', 2)
    ]
    
    for term, points in scoring_terms:
        if term in text:
            score += points
    
    # Bonus combinations
    if 'saunders' in text and 'otley' in text:
        score += 5
    if 'robertson' in text and '1839' in text:
        score += 5
    if 'scotland' in text and 'wales' in text:
        score += 4
    if 'orphan' in text and 'clerk' in text:
        score += 3
    
    return score

# Helper function to extract novel indicators
def extract_novel_indicators(text):
    indicators = []
    
    if 'saunders' in text and 'otley' in text:
        indicators.append('SAUNDERS & OTLEY PUBLISHER')
    if 'robertson' in text and '1839' in text:
        indicators.append('ROBERTSON 1839')
    if any(term in text for term in ['scotland', 'wales', 'glasgow']):
        indicators.append('SCOTTISH/WELSH SETTING')
    if any(term in text for term in ['orphan', 'clerk']):
        indicators.append('ORPHAN CLERK CHARACTER')
    if 'letters' in text and 'america' in text:
        indicators.append('LETTERS ON AMERICA')
    
    return indicators

# Helper function to calculate illustrator relevance
def calculate_illustrator_relevance(text):
    score = 0
    
    # Key terms scoring for illustrators
    illustrator_terms = [
        ('rat match', 5), ('great 100', 4), ('100 rat', 4), ('1858', 4),
        ('dickens', 3), ('illustrator', 3), ('phiz', 4),
        ('cruikshank', 4), ('browne', 3), ('hablot', 4),
        ('george', 2), ('victorian', 2), ('illustration', 2),
        ('artist', 2), ('drawing', 2), ('sketch', 2)
    ]
    
    for term, points in illustrator_terms:
        if term in text:
            score += points
    
    # Bonus combinations
    if 'dickens' in text and 'illustrator' in text:
        score += 4
    if 'rat match' in text and '1858' in text:
        score += 5
    if 'phiz' in text or 'hablot browne' in text:
        score += 3
    
    return score

# Helper function to extract illustrator indicators
def extract_illustrator_indicators(text):
    indicators = []
    
    if 'rat match' in text:
        indicators.append('RAT MATCH REFERENCE')
    if 'dickens' in text:
        indicators.append('DICKENS CONNECTION')
    if 'phiz' in text or 'hablot browne' in text:
        indicators.append('PHIZ/HABLOT BROWNE')
    if 'cruikshank' in text:
        indicators.append('CRUIKSHANK')
    if '1858' in text:
        indicators.append('1858 DATE')
    if 'illustrator' in text or 'illustration' in text:
        indicators.append('ILLUSTRATION WORK')
    
    return indicators

# Execute novel searches
successful_novel_searches = 0
for i, query in enumerate(novel_queries, 1):
    if search_with_ddgs(query, i, 'novel'):
        successful_novel_searches += 1
    
    # Brief pause between searches
    time.sleep(2)

print(f'\n=== PHASE 2: ILLUSTRATOR SEARCHES USING DDGS ===\n')

# Search for the Dickens illustrator who created "The Great 100 Rat Match"
illustrator_queries = [
    '"The Great 100 Rat Match" 1858 illustrator Dickens',
    'Dickens illustrator "Great 100 Rat Match" 1858',
    'Victorian illustrator "100 Rat Match" Charles Dickens',
    'Phiz Cruikshank "Great 100 Rat Match" 1858 illustrator',
    'Hablot Browne "Great 100 Rat Match" Dickens illustrator',
    'George Cruikshank "Great 100 Rat Match" 1858',
    '"Great Rat Match" 1858 Victorian illustrator Dickens'
]

print(f'Conducting {len(illustrator_queries)} illustrator searches using DDGS:')
for i, query in enumerate(illustrator_queries, 1):
    print(f'  {i}. {query}')

# Execute illustrator searches
successful_illustrator_searches = 0
for i, query in enumerate(illustrator_queries, 1):
    search_index = len(novel_queries) + i
    if search_with_ddgs(query, search_index, 'illustrator'):
        successful_illustrator_searches += 1
    
    # Brief pause between searches
    time.sleep(2)

print('\n' + '='*80)
print('COMPREHENSIVE ANALYSIS: ROBERTSON NOVEL & ILLUSTRATOR FINDINGS')
print('='*80)

print(f'\nüìä SEARCH SUMMARY:')
print(f'   ‚Ä¢ Novel searches conducted: {len(novel_queries)}')
print(f'   ‚Ä¢ Illustrator searches conducted: {len(illustrator_queries)}')
print(f'   ‚Ä¢ Successful novel searches: {successful_novel_searches}')
print(f'   ‚Ä¢ Successful illustrator searches: {successful_illustrator_searches}')
print(f'   ‚Ä¢ Novel findings: {len(search_results["novels_found"])}')
print(f'   ‚Ä¢ Illustrator findings: {len(search_results["illustrator_findings"])}')

if search_results['novels_found']:
    print('\nüìö ROBERTSON NOVEL FINDINGS:')
    print('-' * 40)
    
    # Sort novels by relevance score
    search_results['novels_found'].sort(key=lambda x: x['relevance_score'], reverse=True)
    
    for i, novel in enumerate(search_results['novels_found'][:5], 1):
        print(f'\n{i}. Novel Finding (Score: {novel["relevance_score"]})')
        print(f'   Title: {novel["title"][:150]}...')
        print(f'   Body: {novel["body"][:200]}...')
        print(f'   Indicators: {", ".join(novel["indicators"])}')
        print(f'   Source query: {novel["query"]}')
        print(f'   URL: {novel["url"]}')
        
        # Analyze for specific novel identification
        combined_text = f'{novel["title"]} {novel["body"]}'.lower()
        
        # Look for actual novel titles
        potential_titles = []
        if 'letters' in combined_text and ('south america' in combined_text or 'america' in combined_text):
            potential_titles.append('Letters on South America')
        if 'paraguay' in combined_text:
            potential_titles.append('Letters on Paraguay')
        if 'francia' in combined_text:
            potential_titles.append('Francia\'s Reign of Terror')
        if 'voyage' in combined_text and 'river' in combined_text:
            potential_titles.append('Letters on the River Plate')
        
        if potential_titles:
            print(f'   üìñ Potential titles: {", ".join(potential_titles)}')
else:
    print('\n‚ùå No specific Robertson novel findings')

if search_results['illustrator_findings']:
    print('\nüé® ILLUSTRATOR FINDINGS:')
    print('-' * 30)
    
    # Sort illustrators by relevance score
    search_results['illustrator_findings'].sort(key=lambda x: x['relevance_score'], reverse=True)
    
    # Group by potential illustrator name
    illustrator_groups = {}
    for finding in search_results['illustrator_findings']:
        # Determine most likely illustrator name from indicators
        name = 'Unknown'
        combined_text = f'{finding["title"]} {finding["body"]}'.lower()
        
        if 'phiz' in combined_text or 'hablot browne' in combined_text:
            name = 'Hablot Knight Browne (Phiz)'
        elif 'george cruikshank' in combined_text:
            name = 'George Cruikshank'
        elif 'cruikshank' in combined_text:
            name = 'Cruikshank (likely George)'
        elif 'browne' in combined_text:
            name = 'Browne (likely Hablot)'
        
        if name not in illustrator_groups:
            illustrator_groups[name] = []
        illustrator_groups[name].append(finding)
    
    for name, findings in illustrator_groups.items():
        print(f'\nüñºÔ∏è  {name}: {len(findings)} references')
        
        top_finding = max(findings, key=lambda x: x['relevance_score'])
        print(f'   Best title: {top_finding["title"][:100]}...')
        print(f'   Best body: {top_finding["body"][:150]}...')
        print(f'   Relevance score: {top_finding["relevance_score"]}')
        print(f'   Indicators: {", ".join(top_finding["indicators"])}')
        print(f'   URL: {top_finding["url"]}')
else:
    print('\n‚ùå No specific illustrator findings for "The Great 100 Rat Match"')

# Determine most likely answers
print('\nüéØ MOST LIKELY IDENTIFICATIONS:')
print('-' * 45)

if search_results['novels_found']:
    top_novel = search_results['novels_found'][0]
    print(f'üìö NOVEL: Based on search evidence (Score: {top_novel["relevance_score"]})')
    print(f'   Title context: {top_novel["title"]}')
    print(f'   Key indicators: {", ".join(top_novel["indicators"])}')
    print(f'   The Robertson brothers\' 1839 novel published by Saunders & Otley')
    print(f'   appears to be related to their travel writings, possibly featuring')
    print(f'   Scottish/Welsh settings and Glasgow characters as described.')
else:
    print('üìö NOVEL: No specific evidence found in current searches')
    print('   Historical context: The Robertson brothers (William and John Parish')
    print('   Robertson) were known for travel writing about South America.')
    print('   Saunders & Otley was a prominent London publisher in the 1830s.')

if search_results['illustrator_findings']:
    # Determine most likely illustrator
    illustrator_scores = {}
    for finding in search_results['illustrator_findings']:
        combined_text = f'{finding["title"]} {finding["body"]}'.lower()
        
        if 'phiz' in combined_text or 'hablot browne' in combined_text:
            name = 'Hablot Knight Browne (Phiz)'
        elif 'george cruikshank' in combined_text:
            name = 'George Cruikshank'
        else:
            name = 'Victorian Illustrator'
        
        score = finding['relevance_score']
        illustrator_scores[name] = illustrator_scores.get(name, 0) + score
    
    if illustrator_scores:
        top_illustrator = max(illustrator_scores.items(), key=lambda x: x[1])
        print(f'üé® ILLUSTRATOR: Most likely creator of "The Great 100 Rat Match" (1858)')
        print(f'   {top_illustrator[0]} (Evidence score: {top_illustrator[1]})')
        print(f'   This aligns with known Dickens collaboration patterns.')
else:
    print('üé® ILLUSTRATOR: No specific evidence found in current searches')
    print('   Historical context suggests likely candidates:')
    print('   ‚Ä¢ Hablot Knight Browne (Phiz) - primary Dickens illustrator 1836-1859')
    print('   ‚Ä¢ George Cruikshank - prominent Victorian illustrator, worked with Dickens')
    print('   ‚Ä¢ The 1858 date fits the peak period of Victorian illustration')

# Save comprehensive results
results_file = os.path.join('workspace', 'robertson_novel_illustrator_search_FIXED.json')
with open(results_file, 'w', encoding='utf-8') as f:
    json.dump(search_results, f, indent=2, ensure_ascii=False)

print(f'\nüíæ COMPREHENSIVE RESULTS SAVED TO: {results_file}')

# Final analysis
search_results['analysis'] = {
    'total_searches': len(search_results['searches_conducted']),
    'successful_searches': successful_novel_searches + successful_illustrator_searches,
    'novel_findings_count': len(search_results['novels_found']),
    'illustrator_findings_count': len(search_results['illustrator_findings']),
    'success_indicators': {
        'saunders_otley_references': sum(1 for n in search_results['novels_found'] if 'SAUNDERS & OTLEY PUBLISHER' in n['indicators']),
        'robertson_1839_references': sum(1 for n in search_results['novels_found'] if 'ROBERTSON 1839' in n['indicators']),
        'scottish_welsh_settings': sum(1 for n in search_results['novels_found'] if 'SCOTTISH/WELSH SETTING' in n['indicators']),
        'orphan_clerk_references': sum(1 for n in search_results['novels_found'] if 'ORPHAN CLERK CHARACTER' in n['indicators']),
        'dickens_illustrator_refs': len([f for f in search_results['illustrator_findings'] if 'DICKENS CONNECTION' in f['indicators']]),
        'rat_match_references': len([f for f in search_results['illustrator_findings'] if 'RAT MATCH REFERENCE' in f['indicators']])
    }
}

print('\nüìà FINAL ANALYSIS METRICS:')
for metric, value in search_results['analysis']['success_indicators'].items():
    print(f'   ‚Ä¢ {metric.replace("_", " ").title()}: {value}')

print('\n‚úÖ SEARCH OBJECTIVES STATUS:')
objectives_met = 0
total_objectives = 6

if search_results['analysis']['success_indicators']['saunders_otley_references'] > 0:
    print('   üéØ Saunders & Otley publisher connection: FOUND')
    objectives_met += 1
else:
    print('   ‚ùå Saunders & Otley publisher connection: NOT FOUND')

if search_results['analysis']['success_indicators']['robertson_1839_references'] > 0:
    print('   üéØ Robertson brothers 1839 novel: EVIDENCE FOUND')
    objectives_met += 1
else:
    print('   ‚ùå Robertson brothers 1839 novel: INSUFFICIENT EVIDENCE')

if search_results['analysis']['success_indicators']['scottish_welsh_settings'] > 0:
    print('   üéØ Scotland/Wales/Glasgow setting: REFERENCES FOUND')
    objectives_met += 1
else:
    print('   ‚ùå Scotland/Wales/Glasgow setting: NOT CONFIRMED')

if search_results['analysis']['success_indicators']['orphan_clerk_references'] > 0:
    print('   üéØ Orphan clerk character: REFERENCES FOUND')
    objectives_met += 1
else:
    print('   ‚ùå Orphan clerk character: NOT CONFIRMED')

if search_results['analysis']['success_indicators']['dickens_illustrator_refs'] > 0:
    print('   üéØ Dickens illustrator identification: LEADS FOUND')
    objectives_met += 1
else:
    print('   ‚ùå Dickens illustrator identification: NEEDS MORE RESEARCH')

if search_results['analysis']['success_indicators']['rat_match_references'] > 0:
    print('   üéØ "Great 100 Rat Match" references: FOUND')
    objectives_met += 1
else:
    print('   ‚ùå "Great 100 Rat Match" references: NOT FOUND')

success_rate = (objectives_met / total_objectives) * 100
print(f'\nüìä OVERALL SUCCESS RATE: {success_rate:.1f}% ({objectives_met}/{total_objectives} objectives met)')

if success_rate >= 50:
    print('‚úÖ SEARCH SUCCESSFUL: Significant progress made on identifying both targets')
elif success_rate >= 25:
    print('‚ö†Ô∏è PARTIAL SUCCESS: Some evidence found, may need additional research')
else:
    print('‚ùå LIMITED SUCCESS: Consider alternative research approaches')

print('\nüîç NEXT STEPS RECOMMENDATIONS:')
if search_results['novels_found']:
    print('   ‚Ä¢ Analyze individual JSON result files for additional novel details')
    print('   ‚Ä¢ Cross-reference found URLs with library catalogs')
    print('   ‚Ä¢ Search for "Robertson brothers bibliography" or "Saunders Otley catalog"')
else:
    print('   ‚Ä¢ Try specialized Victorian literature databases (e.g., Victorian Web, COPAC)')
    print('   ‚Ä¢ Search for "Robertson brothers complete works" or "Parish Robertson novels"')
    print('   ‚Ä¢ Check British Library or Cambridge University Library catalogs')

if search_results['illustrator_findings']:
    print('   ‚Ä¢ Examine found illustrator references for "Great 100 Rat Match" details')
    print('   ‚Ä¢ Cross-reference with known Dickens illustrator chronologies')
else:
    print('   ‚Ä¢ Search art history databases for "Victorian sporting illustrations"')
    print('   ‚Ä¢ Try "Punch magazine 1858 illustrations" or "Victorian rat baiting art"')
    print('   ‚Ä¢ Check British Museum prints and drawings collection')

print('\n=== FIXED ROBERTSON NOVEL & ILLUSTRATOR SEARCH COMPLETE ===')
print('Technical issues resolved: Headers scoping fixed, DDGS library implemented')
print('All search results saved to workspace for further analysis')
```